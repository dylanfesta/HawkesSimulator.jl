<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Compares a 2D Hawekes process to a 2D linear system · HawkesSimulator.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://dylanfesta.github.io/HawkesSimulator.jl/hawkes_vs_2D_linear/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">HawkesSimulator.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Compares a 2D Hawekes process to a 2D linear system</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Compares a 2D Hawekes process to a 2D linear system</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/dylanfesta/HawkesSimulator.jl/blob/master/examples/hawkes_vs_2D_linear.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Compares-a-2D-Hawekes-process-to-a-2D-linear-system"><a class="docs-heading-anchor" href="#Compares-a-2D-Hawekes-process-to-a-2D-linear-system">Compares a 2D Hawekes process to a 2D linear system</a><a id="Compares-a-2D-Hawekes-process-to-a-2D-linear-system-1"></a><a class="docs-heading-anchor-permalink" href="#Compares-a-2D-Hawekes-process-to-a-2D-linear-system" title="Permalink"></a></h1><p>In this example, I show that the mean rates in a 2D Hawes process perfectly match the mean rates of a 2D rate model.</p><p>I use exponential synaptic kernels (but it is valid for any kernel, since the kernel shape does not influence the mean rate)</p><h2 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h2><pre><code class="language-julia hljs">using LinearAlgebra,Statistics,StatsBase,Distributions
using Plots,NamedColors ; theme(:default)
using FFTW

using ProgressMeter
using Random
Random.seed!(0)

using HawkesSimulator; const global H = HawkesSimulator

function onedmat(x::Real)
  return cat(x;dims=2)
end;</code></pre><h2 id="Rate-Model"><a class="docs-heading-anchor" href="#Rate-Model">Rate Model</a><a id="Rate-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Rate-Model" title="Permalink"></a></h2><pre><code class="language-julia hljs">function iofunction(v::R,_v0::R,_α::R) where R&lt;:Real
  return max(_α*(v-_v0),zero(R))
end
function iofunction_inv(r::R,_v0::R,_α::R) where R&lt;:Real
  return max(zero(R),r/_α+_v0)
end

const v0 = -70.0 # -70
const α = 0.03 # 0.3
const taus = [20.0, 10.0].*1E-3
const weights = [1.25 -0.65 ; 1.2 -0.5]
const input = [20.0, 50.0]
const dt = 0.01E-3
const Ttot = 1.0
const taus_hawk = [3.0,3.0];</code></pre><p>Let&#39;s plot the activation function</p><pre><code class="language-julia hljs">theplot = let vs = range(-90,50.,length=150)
  rs = @. iofunction(vs,v0,α)
  plot(vs,rs;linewidth=2,leg=false,xlabel=&quot;voltage (mV)&quot;,ylabel=&quot;rate (Hz)&quot;,color=:black)
end;
plot(theplot)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip040">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip040)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip041">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip040)" d="M174.149 1423.18 L2352.76 1423.18 L2352.76 47.2441 L174.149 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip042">
    <rect x="174" y="47" width="2180" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="382.614,1423.18 382.614,47.2441 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="676.227,1423.18 676.227,47.2441 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="969.84,1423.18 969.84,47.2441 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1263.45,1423.18 1263.45,47.2441 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1557.07,1423.18 1557.07,47.2441 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1850.68,1423.18 1850.68,47.2441 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2144.29,1423.18 2144.29,47.2441 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="174.149,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="382.614,1423.18 382.614,1404.28 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="676.227,1423.18 676.227,1404.28 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="969.84,1423.18 969.84,1404.28 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1263.45,1423.18 1263.45,1404.28 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1557.07,1423.18 1557.07,1404.28 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1850.68,1423.18 1850.68,1404.28 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2144.29,1423.18 2144.29,1404.28 "/>
<path clip-path="url(#clip040)" d="M336.677 1468.75 L366.353 1468.75 L366.353 1472.69 L336.677 1472.69 L336.677 1468.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M386.445 1469.17 Q383.112 1469.17 381.19 1470.95 Q379.292 1472.73 379.292 1475.86 Q379.292 1478.98 381.19 1480.77 Q383.112 1482.55 386.445 1482.55 Q389.778 1482.55 391.7 1480.77 Q393.621 1478.96 393.621 1475.86 Q393.621 1472.73 391.7 1470.95 Q389.801 1469.17 386.445 1469.17 M381.769 1467.18 Q378.76 1466.44 377.07 1464.38 Q375.403 1462.32 375.403 1459.35 Q375.403 1455.21 378.343 1452.8 Q381.306 1450.39 386.445 1450.39 Q391.607 1450.39 394.547 1452.8 Q397.487 1455.21 397.487 1459.35 Q397.487 1462.32 395.797 1464.38 Q394.13 1466.44 391.144 1467.18 Q394.524 1467.96 396.399 1470.26 Q398.297 1472.55 398.297 1475.86 Q398.297 1480.88 395.218 1483.57 Q392.163 1486.25 386.445 1486.25 Q380.727 1486.25 377.649 1483.57 Q374.593 1480.88 374.593 1475.86 Q374.593 1472.55 376.491 1470.26 Q378.389 1467.96 381.769 1467.18 M380.056 1459.79 Q380.056 1462.48 381.723 1463.98 Q383.413 1465.49 386.445 1465.49 Q389.454 1465.49 391.144 1463.98 Q392.857 1462.48 392.857 1459.79 Q392.857 1457.11 391.144 1455.6 Q389.454 1454.1 386.445 1454.1 Q383.413 1454.1 381.723 1455.6 Q380.056 1457.11 380.056 1459.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M416.607 1454.1 Q412.996 1454.1 411.167 1457.66 Q409.362 1461.2 409.362 1468.33 Q409.362 1475.44 411.167 1479.01 Q412.996 1482.55 416.607 1482.55 Q420.241 1482.55 422.047 1479.01 Q423.875 1475.44 423.875 1468.33 Q423.875 1461.2 422.047 1457.66 Q420.241 1454.1 416.607 1454.1 M416.607 1450.39 Q422.417 1450.39 425.473 1455 Q428.551 1459.58 428.551 1468.33 Q428.551 1477.06 425.473 1481.67 Q422.417 1486.25 416.607 1486.25 Q410.797 1486.25 407.718 1481.67 Q404.663 1477.06 404.663 1468.33 Q404.663 1459.58 407.718 1455 Q410.797 1450.39 416.607 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M630.29 1468.75 L659.965 1468.75 L659.965 1472.69 L630.29 1472.69 L630.29 1468.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M680.637 1466.44 Q677.488 1466.44 675.637 1468.59 Q673.808 1470.74 673.808 1474.49 Q673.808 1478.22 675.637 1480.39 Q677.488 1482.55 680.637 1482.55 Q683.785 1482.55 685.613 1480.39 Q687.465 1478.22 687.465 1474.49 Q687.465 1470.74 685.613 1468.59 Q683.785 1466.44 680.637 1466.44 M689.919 1451.78 L689.919 1456.04 Q688.16 1455.21 686.354 1454.77 Q684.572 1454.33 682.812 1454.33 Q678.183 1454.33 675.729 1457.45 Q673.299 1460.58 672.951 1466.9 Q674.317 1464.89 676.377 1463.82 Q678.437 1462.73 680.914 1462.73 Q686.123 1462.73 689.132 1465.9 Q692.164 1469.05 692.164 1474.49 Q692.164 1479.82 689.016 1483.03 Q685.868 1486.25 680.637 1486.25 Q674.641 1486.25 671.47 1481.67 Q668.299 1477.06 668.299 1468.33 Q668.299 1460.14 672.187 1455.28 Q676.076 1450.39 682.627 1450.39 Q684.386 1450.39 686.169 1450.74 Q687.974 1451.09 689.919 1451.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M710.22 1454.1 Q706.609 1454.1 704.78 1457.66 Q702.974 1461.2 702.974 1468.33 Q702.974 1475.44 704.78 1479.01 Q706.609 1482.55 710.22 1482.55 Q713.854 1482.55 715.659 1479.01 Q717.488 1475.44 717.488 1468.33 Q717.488 1461.2 715.659 1457.66 Q713.854 1454.1 710.22 1454.1 M710.22 1450.39 Q716.03 1450.39 719.085 1455 Q722.164 1459.58 722.164 1468.33 Q722.164 1477.06 719.085 1481.67 Q716.03 1486.25 710.22 1486.25 Q704.41 1486.25 701.331 1481.67 Q698.275 1477.06 698.275 1468.33 Q698.275 1459.58 701.331 1455 Q704.41 1450.39 710.22 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M923.902 1468.75 L953.578 1468.75 L953.578 1472.69 L923.902 1472.69 L923.902 1468.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M976.518 1455.09 L964.712 1473.54 L976.518 1473.54 L976.518 1455.09 M975.291 1451.02 L981.171 1451.02 L981.171 1473.54 L986.101 1473.54 L986.101 1477.43 L981.171 1477.43 L981.171 1485.58 L976.518 1485.58 L976.518 1477.43 L960.916 1477.43 L960.916 1472.92 L975.291 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1003.83 1454.1 Q1000.22 1454.1 998.393 1457.66 Q996.587 1461.2 996.587 1468.33 Q996.587 1475.44 998.393 1479.01 Q1000.22 1482.55 1003.83 1482.55 Q1007.47 1482.55 1009.27 1479.01 Q1011.1 1475.44 1011.1 1468.33 Q1011.1 1461.2 1009.27 1457.66 Q1007.47 1454.1 1003.83 1454.1 M1003.83 1450.39 Q1009.64 1450.39 1012.7 1455 Q1015.78 1459.58 1015.78 1468.33 Q1015.78 1477.06 1012.7 1481.67 Q1009.64 1486.25 1003.83 1486.25 Q998.022 1486.25 994.944 1481.67 Q991.888 1477.06 991.888 1468.33 Q991.888 1459.58 994.944 1455 Q998.022 1450.39 1003.83 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1217.52 1468.75 L1247.19 1468.75 L1247.19 1472.69 L1217.52 1472.69 L1217.52 1468.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1261.31 1481.64 L1277.63 1481.64 L1277.63 1485.58 L1255.69 1485.58 L1255.69 1481.64 Q1258.35 1478.89 1262.93 1474.26 Q1267.54 1469.61 1268.72 1468.27 Q1270.96 1465.74 1271.84 1464.01 Q1272.75 1462.25 1272.75 1460.56 Q1272.75 1457.8 1270.8 1456.07 Q1268.88 1454.33 1265.78 1454.33 Q1263.58 1454.33 1261.13 1455.09 Q1258.7 1455.86 1255.92 1457.41 L1255.92 1452.69 Q1258.74 1451.55 1261.2 1450.97 Q1263.65 1450.39 1265.69 1450.39 Q1271.06 1450.39 1274.25 1453.08 Q1277.45 1455.77 1277.45 1460.26 Q1277.45 1462.39 1276.64 1464.31 Q1275.85 1466.2 1273.74 1468.8 Q1273.16 1469.47 1270.06 1472.69 Q1266.96 1475.88 1261.31 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1297.45 1454.1 Q1293.83 1454.1 1292.01 1457.66 Q1290.2 1461.2 1290.2 1468.33 Q1290.2 1475.44 1292.01 1479.01 Q1293.83 1482.55 1297.45 1482.55 Q1301.08 1482.55 1302.89 1479.01 Q1304.71 1475.44 1304.71 1468.33 Q1304.71 1461.2 1302.89 1457.66 Q1301.08 1454.1 1297.45 1454.1 M1297.45 1450.39 Q1303.26 1450.39 1306.31 1455 Q1309.39 1459.58 1309.39 1468.33 Q1309.39 1477.06 1306.31 1481.67 Q1303.26 1486.25 1297.45 1486.25 Q1291.64 1486.25 1288.56 1481.67 Q1285.5 1477.06 1285.5 1468.33 Q1285.5 1459.58 1288.56 1455 Q1291.64 1450.39 1297.45 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1557.07 1454.1 Q1553.45 1454.1 1551.63 1457.66 Q1549.82 1461.2 1549.82 1468.33 Q1549.82 1475.44 1551.63 1479.01 Q1553.45 1482.55 1557.07 1482.55 Q1560.7 1482.55 1562.5 1479.01 Q1564.33 1475.44 1564.33 1468.33 Q1564.33 1461.2 1562.5 1457.66 Q1560.7 1454.1 1557.07 1454.1 M1557.07 1450.39 Q1562.88 1450.39 1565.93 1455 Q1569.01 1459.58 1569.01 1468.33 Q1569.01 1477.06 1565.93 1481.67 Q1562.88 1486.25 1557.07 1486.25 Q1551.26 1486.25 1548.18 1481.67 Q1545.12 1477.06 1545.12 1468.33 Q1545.12 1459.58 1548.18 1455 Q1551.26 1450.39 1557.07 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1829.45 1481.64 L1845.77 1481.64 L1845.77 1485.58 L1823.83 1485.58 L1823.83 1481.64 Q1826.49 1478.89 1831.07 1474.26 Q1835.68 1469.61 1836.86 1468.27 Q1839.1 1465.74 1839.98 1464.01 Q1840.89 1462.25 1840.89 1460.56 Q1840.89 1457.8 1838.94 1456.07 Q1837.02 1454.33 1833.92 1454.33 Q1831.72 1454.33 1829.27 1455.09 Q1826.84 1455.86 1824.06 1457.41 L1824.06 1452.69 Q1826.88 1451.55 1829.34 1450.97 Q1831.79 1450.39 1833.83 1450.39 Q1839.2 1450.39 1842.39 1453.08 Q1845.59 1455.77 1845.59 1460.26 Q1845.59 1462.39 1844.78 1464.31 Q1843.99 1466.2 1841.88 1468.8 Q1841.3 1469.47 1838.2 1472.69 Q1835.1 1475.88 1829.45 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1865.59 1454.1 Q1861.97 1454.1 1860.15 1457.66 Q1858.34 1461.2 1858.34 1468.33 Q1858.34 1475.44 1860.15 1479.01 Q1861.97 1482.55 1865.59 1482.55 Q1869.22 1482.55 1871.03 1479.01 Q1872.85 1475.44 1872.85 1468.33 Q1872.85 1461.2 1871.03 1457.66 Q1869.22 1454.1 1865.59 1454.1 M1865.59 1450.39 Q1871.4 1450.39 1874.45 1455 Q1877.53 1459.58 1877.53 1468.33 Q1877.53 1477.06 1874.45 1481.67 Q1871.4 1486.25 1865.59 1486.25 Q1859.78 1486.25 1856.7 1481.67 Q1853.64 1477.06 1853.64 1468.33 Q1853.64 1459.58 1856.7 1455 Q1859.78 1450.39 1865.59 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M2132.46 1455.09 L2120.66 1473.54 L2132.46 1473.54 L2132.46 1455.09 M2131.24 1451.02 L2137.11 1451.02 L2137.11 1473.54 L2142.05 1473.54 L2142.05 1477.43 L2137.11 1477.43 L2137.11 1485.58 L2132.46 1485.58 L2132.46 1477.43 L2116.86 1477.43 L2116.86 1472.92 L2131.24 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M2159.78 1454.1 Q2156.17 1454.1 2154.34 1457.66 Q2152.53 1461.2 2152.53 1468.33 Q2152.53 1475.44 2154.34 1479.01 Q2156.17 1482.55 2159.78 1482.55 Q2163.41 1482.55 2165.22 1479.01 Q2167.05 1475.44 2167.05 1468.33 Q2167.05 1461.2 2165.22 1457.66 Q2163.41 1454.1 2159.78 1454.1 M2159.78 1450.39 Q2165.59 1450.39 2168.64 1455 Q2171.72 1459.58 2171.72 1468.33 Q2171.72 1477.06 2168.64 1481.67 Q2165.59 1486.25 2159.78 1486.25 Q2153.97 1486.25 2150.89 1481.67 Q2147.83 1477.06 2147.83 1468.33 Q2147.83 1459.58 2150.89 1455 Q2153.97 1450.39 2159.78 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1055.61 1532.4 L1061.82 1532.4 L1072.96 1562.31 L1084.1 1532.4 L1090.31 1532.4 L1076.94 1568.04 L1068.98 1568.04 L1055.61 1532.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1112.2 1536.5 Q1107.49 1536.5 1104.76 1540.19 Q1102.02 1543.85 1102.02 1550.25 Q1102.02 1556.65 1104.72 1560.34 Q1107.46 1564 1112.2 1564 Q1116.88 1564 1119.62 1560.31 Q1122.36 1556.62 1122.36 1550.25 Q1122.36 1543.92 1119.62 1540.23 Q1116.88 1536.5 1112.2 1536.5 M1112.2 1531.54 Q1119.84 1531.54 1124.2 1536.5 Q1128.56 1541.47 1128.56 1550.25 Q1128.56 1559 1124.2 1564 Q1119.84 1568.97 1112.2 1568.97 Q1104.53 1568.97 1100.17 1564 Q1095.84 1559 1095.84 1550.25 Q1095.84 1541.47 1100.17 1536.5 Q1104.53 1531.54 1112.2 1531.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1138.27 1518.52 L1144.13 1518.52 L1144.13 1568.04 L1138.27 1568.04 L1138.27 1518.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1162.17 1522.27 L1162.17 1532.4 L1174.24 1532.4 L1174.24 1536.95 L1162.17 1536.95 L1162.17 1556.3 Q1162.17 1560.66 1163.35 1561.9 Q1164.56 1563.14 1168.22 1563.14 L1174.24 1563.14 L1174.24 1568.04 L1168.22 1568.04 Q1161.44 1568.04 1158.86 1565.53 Q1156.29 1562.98 1156.29 1556.3 L1156.29 1536.95 L1151.99 1536.95 L1151.99 1532.4 L1156.29 1532.4 L1156.29 1522.27 L1162.17 1522.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1198.14 1550.12 Q1191.04 1550.12 1188.31 1551.75 Q1185.57 1553.37 1185.57 1557.29 Q1185.57 1560.4 1187.61 1562.25 Q1189.67 1564.07 1193.21 1564.07 Q1198.08 1564.07 1201 1560.63 Q1203.96 1557.16 1203.96 1551.43 L1203.96 1550.12 L1198.14 1550.12 M1209.82 1547.71 L1209.82 1568.04 L1203.96 1568.04 L1203.96 1562.63 Q1201.96 1565.88 1198.97 1567.44 Q1195.98 1568.97 1191.65 1568.97 Q1186.17 1568.97 1182.93 1565.91 Q1179.71 1562.82 1179.71 1557.67 Q1179.71 1551.65 1183.72 1548.6 Q1187.76 1545.54 1195.75 1545.54 L1203.96 1545.54 L1203.96 1544.97 Q1203.96 1540.93 1201.29 1538.73 Q1198.65 1536.5 1193.84 1536.5 Q1190.79 1536.5 1187.89 1537.23 Q1185 1537.97 1182.32 1539.43 L1182.32 1534.02 Q1185.54 1532.78 1188.56 1532.17 Q1191.58 1531.54 1194.45 1531.54 Q1202.18 1531.54 1206 1535.55 Q1209.82 1539.56 1209.82 1547.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1245.34 1549.81 Q1245.34 1543.44 1242.7 1539.94 Q1240.09 1536.44 1235.35 1536.44 Q1230.64 1536.44 1228 1539.94 Q1225.39 1543.44 1225.39 1549.81 Q1225.39 1556.14 1228 1559.64 Q1230.64 1563.14 1235.35 1563.14 Q1240.09 1563.14 1242.7 1559.64 Q1245.34 1556.14 1245.34 1549.81 M1251.2 1563.62 Q1251.2 1572.72 1247.16 1577.15 Q1243.11 1581.6 1234.77 1581.6 Q1231.69 1581.6 1228.95 1581.13 Q1226.21 1580.68 1223.63 1579.72 L1223.63 1574.03 Q1226.21 1575.43 1228.73 1576.1 Q1231.24 1576.76 1233.85 1576.76 Q1239.61 1576.76 1242.48 1573.74 Q1245.34 1570.75 1245.34 1564.67 L1245.34 1561.77 Q1243.53 1564.92 1240.7 1566.48 Q1237.86 1568.04 1233.92 1568.04 Q1227.36 1568.04 1223.35 1563.05 Q1219.34 1558.05 1219.34 1549.81 Q1219.34 1541.53 1223.35 1536.53 Q1227.36 1531.54 1233.92 1531.54 Q1237.86 1531.54 1240.7 1533.1 Q1243.53 1534.66 1245.34 1537.81 L1245.34 1532.4 L1251.2 1532.4 L1251.2 1563.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1293.75 1548.76 L1293.75 1551.62 L1266.83 1551.62 Q1267.21 1557.67 1270.45 1560.85 Q1273.73 1564 1279.56 1564 Q1282.93 1564 1286.08 1563.17 Q1289.27 1562.35 1292.38 1560.69 L1292.38 1566.23 Q1289.23 1567.57 1285.92 1568.27 Q1282.61 1568.97 1279.21 1568.97 Q1270.68 1568.97 1265.68 1564 Q1260.72 1559.04 1260.72 1550.57 Q1260.72 1541.82 1265.43 1536.69 Q1270.17 1531.54 1278.19 1531.54 Q1285.38 1531.54 1289.55 1536.18 Q1293.75 1540.8 1293.75 1548.76 M1287.9 1547.04 Q1287.83 1542.23 1285.19 1539.37 Q1282.58 1536.5 1278.25 1536.5 Q1273.35 1536.5 1270.39 1539.27 Q1267.46 1542.04 1267.02 1547.07 L1287.9 1547.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1338.15 1518.58 Q1333.89 1525.9 1331.82 1533.06 Q1329.75 1540.23 1329.75 1547.58 Q1329.75 1554.93 1331.82 1562.16 Q1333.92 1569.35 1338.15 1576.64 L1333.06 1576.64 Q1328.29 1569.16 1325.9 1561.93 Q1323.54 1554.71 1323.54 1547.58 Q1323.54 1540.48 1325.9 1533.29 Q1328.26 1526.09 1333.06 1518.58 L1338.15 1518.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1377.27 1539.24 Q1379.47 1535.29 1382.52 1533.41 Q1385.58 1531.54 1389.72 1531.54 Q1395.29 1531.54 1398.31 1535.45 Q1401.33 1539.33 1401.33 1546.53 L1401.33 1568.04 L1395.45 1568.04 L1395.45 1546.72 Q1395.45 1541.59 1393.63 1539.11 Q1391.82 1536.63 1388.09 1536.63 Q1383.54 1536.63 1380.9 1539.65 Q1378.26 1542.68 1378.26 1547.9 L1378.26 1568.04 L1372.37 1568.04 L1372.37 1546.72 Q1372.37 1541.56 1370.56 1539.11 Q1368.74 1536.63 1364.95 1536.63 Q1360.47 1536.63 1357.82 1539.68 Q1355.18 1542.71 1355.18 1547.9 L1355.18 1568.04 L1349.29 1568.04 L1349.29 1532.4 L1355.18 1532.4 L1355.18 1537.93 Q1357.19 1534.66 1359.99 1533.1 Q1362.79 1531.54 1366.64 1531.54 Q1370.52 1531.54 1373.23 1533.51 Q1375.97 1535.48 1377.27 1539.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1425.52 1568.04 L1407.38 1520.52 L1414.1 1520.52 L1429.15 1560.53 L1444.24 1520.52 L1450.92 1520.52 L1432.81 1568.04 L1425.52 1568.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M1456.68 1518.58 L1461.78 1518.58 Q1466.55 1526.09 1468.91 1533.29 Q1471.29 1540.48 1471.29 1547.58 Q1471.29 1554.71 1468.91 1561.93 Q1466.55 1569.16 1461.78 1576.64 L1456.68 1576.64 Q1460.92 1569.35 1462.99 1562.16 Q1465.09 1554.93 1465.09 1547.58 Q1465.09 1540.23 1462.99 1533.06 Q1460.92 1525.9 1456.68 1518.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="174.149,1384.24 2352.76,1384.24 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="174.149,1023.67 2352.76,1023.67 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="174.149,663.098 2352.76,663.098 "/>
<polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="174.149,302.528 2352.76,302.528 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="174.149,1423.18 174.149,47.2441 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="174.149,1384.24 193.047,1384.24 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="174.149,1023.67 193.047,1023.67 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="174.149,663.098 193.047,663.098 "/>
<polyline clip-path="url(#clip040)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="174.149,302.528 193.047,302.528 "/>
<path clip-path="url(#clip040)" d="M126.205 1370.04 Q122.593 1370.04 120.765 1373.6 Q118.959 1377.14 118.959 1384.27 Q118.959 1391.38 120.765 1394.94 Q122.593 1398.49 126.205 1398.49 Q129.839 1398.49 131.644 1394.94 Q133.473 1391.38 133.473 1384.27 Q133.473 1377.14 131.644 1373.6 Q129.839 1370.04 126.205 1370.04 M126.205 1366.33 Q132.015 1366.33 135.07 1370.94 Q138.149 1375.52 138.149 1384.27 Q138.149 1393 135.07 1397.61 Q132.015 1402.19 126.205 1402.19 Q120.394 1402.19 117.316 1397.61 Q114.26 1393 114.26 1384.27 Q114.26 1375.52 117.316 1370.94 Q120.394 1366.33 126.205 1366.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M118.242 1037.01 L125.88 1037.01 L125.88 1010.65 L117.57 1012.31 L117.57 1008.05 L125.834 1006.39 L130.51 1006.39 L130.51 1037.01 L138.149 1037.01 L138.149 1040.95 L118.242 1040.95 L118.242 1037.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M121.83 676.443 L138.149 676.443 L138.149 680.378 L116.205 680.378 L116.205 676.443 Q118.867 673.688 123.45 669.059 Q128.056 664.406 129.237 663.063 Q131.482 660.54 132.362 658.804 Q133.265 657.045 133.265 655.355 Q133.265 652.6 131.32 650.864 Q129.399 649.128 126.297 649.128 Q124.098 649.128 121.644 649.892 Q119.214 650.656 116.436 652.207 L116.436 647.485 Q119.26 646.35 121.714 645.772 Q124.168 645.193 126.205 645.193 Q131.575 645.193 134.769 647.878 Q137.964 650.563 137.964 655.054 Q137.964 657.184 137.154 659.105 Q136.367 661.003 134.26 663.596 Q133.681 664.267 130.58 667.484 Q127.478 670.679 121.83 676.443 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M131.019 301.174 Q134.376 301.891 136.251 304.16 Q138.149 306.428 138.149 309.762 Q138.149 314.877 134.63 317.678 Q131.112 320.479 124.63 320.479 Q122.455 320.479 120.14 320.039 Q117.848 319.623 115.394 318.766 L115.394 314.252 Q117.339 315.386 119.654 315.965 Q121.968 316.544 124.492 316.544 Q128.89 316.544 131.181 314.808 Q133.496 313.072 133.496 309.762 Q133.496 306.706 131.343 304.993 Q129.214 303.257 125.394 303.257 L121.367 303.257 L121.367 299.414 L125.58 299.414 Q129.029 299.414 130.857 298.049 Q132.686 296.66 132.686 294.067 Q132.686 291.405 130.788 289.993 Q128.913 288.558 125.394 288.558 Q123.473 288.558 121.274 288.975 Q119.075 289.391 116.436 290.271 L116.436 286.104 Q119.098 285.364 121.413 284.993 Q123.751 284.623 125.811 284.623 Q131.135 284.623 134.237 287.053 Q137.339 289.461 137.339 293.581 Q137.339 296.451 135.695 298.442 Q134.052 300.41 131.019 301.174 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M33.8307 852.182 Q33.2578 853.169 33.0032 854.346 Q32.7167 855.492 32.7167 856.892 Q32.7167 861.858 35.9632 864.531 Q39.1779 867.173 45.2253 867.173 L64.0042 867.173 L64.0042 873.061 L28.3562 873.061 L28.3562 867.173 L33.8944 867.173 Q30.6479 865.327 29.0883 862.367 Q27.4968 859.407 27.4968 855.174 Q27.4968 854.569 27.5923 853.837 Q27.656 853.105 27.8151 852.214 L33.8307 852.182 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M46.0847 829.838 Q46.0847 836.936 47.7079 839.673 Q49.3312 842.41 53.2461 842.41 Q56.3653 842.41 58.2114 840.373 Q60.0256 838.305 60.0256 834.772 Q60.0256 829.902 56.5881 826.974 Q53.1188 824.014 47.3897 824.014 L46.0847 824.014 L46.0847 829.838 M43.6657 818.157 L64.0042 818.157 L64.0042 824.014 L58.5933 824.014 Q61.8398 826.019 63.3994 829.011 Q64.9272 832.003 64.9272 836.331 Q64.9272 841.806 61.8716 845.052 Q58.7843 848.267 53.6281 848.267 Q47.6125 848.267 44.5569 844.257 Q41.5014 840.214 41.5014 832.225 L41.5014 824.014 L40.9285 824.014 Q36.8862 824.014 34.6901 826.687 Q32.4621 829.329 32.4621 834.135 Q32.4621 837.191 33.1941 840.087 Q33.9262 842.983 35.3903 845.657 L29.9795 845.657 Q28.7381 842.442 28.1334 839.419 Q27.4968 836.395 27.4968 833.53 Q27.4968 825.796 31.5072 821.977 Q35.5176 818.157 43.6657 818.157 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M18.2347 800.301 L28.3562 800.301 L28.3562 788.238 L32.9077 788.238 L32.9077 800.301 L52.2594 800.301 Q56.6199 800.301 57.8613 799.124 Q59.1026 797.914 59.1026 794.254 L59.1026 788.238 L64.0042 788.238 L64.0042 794.254 Q64.0042 801.033 61.4897 803.611 Q58.9434 806.19 52.2594 806.19 L32.9077 806.19 L32.9077 810.486 L28.3562 810.486 L28.3562 806.19 L18.2347 806.19 L18.2347 800.301 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M44.7161 750.044 L47.5806 750.044 L47.5806 776.971 Q53.6281 776.589 56.8109 773.343 Q59.9619 770.064 59.9619 764.24 Q59.9619 760.866 59.1344 757.715 Q58.3069 754.532 56.6518 751.413 L62.1899 751.413 Q63.5267 754.564 64.227 757.874 Q64.9272 761.184 64.9272 764.59 Q64.9272 773.12 59.9619 778.117 Q54.9967 783.082 46.5303 783.082 Q37.7774 783.082 32.6531 778.371 Q27.4968 773.629 27.4968 765.608 Q27.4968 758.415 32.1438 754.245 Q36.7589 750.044 44.7161 750.044 M42.9973 755.901 Q38.1912 755.964 35.3266 758.606 Q32.4621 761.216 32.4621 765.545 Q32.4621 770.446 35.2312 773.406 Q38.0002 776.334 43.0292 776.78 L42.9973 755.901 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M14.5426 705.643 Q21.8632 709.908 29.0246 711.977 Q36.186 714.046 43.5384 714.046 Q50.8908 714.046 58.1159 711.977 Q65.3091 709.876 72.5979 705.643 L72.5979 710.736 Q65.1182 715.51 57.8931 717.897 Q50.668 720.253 43.5384 720.253 Q36.4406 720.253 29.2474 717.897 Q22.0542 715.542 14.5426 710.736 L14.5426 705.643 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M16.4842 694.026 L16.4842 687.596 L35.9632 687.596 L35.9632 664.234 L16.4842 664.234 L16.4842 657.805 L64.0042 657.805 L64.0042 664.234 L41.3741 664.234 L41.3741 687.596 L64.0042 687.596 L64.0042 694.026 L16.4842 694.026 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M28.3562 647.811 L28.3562 619.993 L33.7034 619.993 L59.3254 642.018 L59.3254 619.993 L64.0042 619.993 L64.0042 648.607 L58.657 648.607 L33.035 626.581 L33.035 647.811 L28.3562 647.811 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip040)" d="M14.5426 611.972 L14.5426 606.879 Q22.0542 602.105 29.2474 599.75 Q36.4406 597.363 43.5384 597.363 Q50.668 597.363 57.8931 599.75 Q65.1182 602.105 72.5979 606.879 L72.5979 611.972 Q65.3091 607.739 58.1159 605.67 Q50.8908 603.569 43.5384 603.569 Q36.186 603.569 29.0246 605.67 Q21.8632 607.739 14.5426 611.972 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip042)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" points="235.808,1384.24 249.601,1384.24 263.395,1384.24 277.189,1384.24 290.983,1384.24 304.777,1384.24 318.571,1384.24 332.365,1384.24 346.159,1384.24 359.953,1384.24 373.747,1384.24 387.54,1384.24 401.334,1384.24 415.128,1384.24 428.922,1384.24 442.716,1384.24 456.51,1384.24 470.304,1384.24 484.098,1384.24 497.892,1384.24 511.685,1384.24 525.479,1384.24 539.273,1376.98 553.067,1366.81 566.861,1356.65 580.655,1346.49 594.449,1336.32 608.243,1326.16 622.037,1316 635.83,1305.83 649.624,1295.67 663.418,1285.5 677.212,1275.34 691.006,1265.18 704.8,1255.01 718.594,1244.85 732.388,1234.69 746.182,1224.52 759.975,1214.36 773.769,1204.2 787.563,1194.03 801.357,1183.87 815.151,1173.7 828.945,1163.54 842.739,1153.38 856.533,1143.21 870.327,1133.05 884.12,1122.89 897.914,1112.72 911.708,1102.56 925.502,1092.39 939.296,1082.23 953.09,1072.07 966.884,1061.9 980.678,1051.74 994.472,1041.58 1008.27,1031.41 1022.06,1021.25 1035.85,1011.08 1049.65,1000.92 1063.44,990.757 1077.23,980.593 1091.03,970.43 1104.82,960.266 1118.62,950.102 1132.41,939.938 1146.2,929.775 1160,919.611 1173.79,909.447 1187.59,899.283 1201.38,889.12 1215.17,878.956 1228.97,868.792 1242.76,858.629 1256.56,848.465 1270.35,838.301 1284.14,828.137 1297.94,817.974 1311.73,807.81 1325.52,797.646 1339.32,787.483 1353.11,777.319 1366.91,767.155 1380.7,756.991 1394.49,746.828 1408.29,736.664 1422.08,726.5 1435.88,716.336 1449.67,706.173 1463.46,696.009 1477.26,685.845 1491.05,675.682 1504.85,665.518 1518.64,655.354 1532.43,645.19 1546.23,635.027 1560.02,624.863 1573.81,614.699 1587.61,604.536 1601.4,594.372 1615.2,584.208 1628.99,574.044 1642.78,563.881 1656.58,553.717 1670.37,543.553 1684.17,533.389 1697.96,523.226 1711.75,513.062 1725.55,502.898 1739.34,492.735 1753.14,482.571 1766.93,472.407 1780.72,462.243 1794.52,452.08 1808.31,441.916 1822.1,431.752 1835.9,421.589 1849.69,411.425 1863.49,401.261 1877.28,391.097 1891.07,380.934 1904.87,370.77 1918.66,360.606 1932.46,350.442 1946.25,340.279 1960.04,330.115 1973.84,319.951 1987.63,309.788 2001.43,299.624 2015.22,289.46 2029.01,279.296 2042.81,269.133 2056.6,258.969 2070.39,248.805 2084.19,238.642 2097.98,228.478 2111.78,218.314 2125.57,208.15 2139.36,197.987 2153.16,187.823 2166.95,177.659 2180.75,167.495 2194.54,157.332 2208.33,147.168 2222.13,137.004 2235.92,126.841 2249.72,116.677 2263.51,106.513 2277.3,96.3494 2291.1,86.1857 "/>
</svg>
<p>I run the rate model by Euler integration, with timesteps of 0.01 ms (the variable <code>dt</code>)</p><pre><code class="language-julia hljs">function euler_dv(v::Vector{R},_weights::Matrix{R},_input::Vector{R},
    _taus::Vector{R},_v0::R,_α::R) where R&lt;:Real
  r = @. iofunction(v,_v0,_α)
  return (.-v .+ (_weights*r) .+ _input) ./ _taus
end

function run_2D_network()
  v_start_e,v_start_i = 0.0,0.0
  times = range(0.0,Ttot;step=dt)
  ntimes = length(times)
  rates = Matrix{Float64}(undef,2,ntimes)
  v = [v_start_e,v_start_i]
  for tt in eachindex(times)
    rates[:,tt] = iofunction.(v,v0,α)
    dv = euler_dv(v,weights,input,taus,v0,α)
    v += dv*dt
  end
  return times,rates
end;


runtimes,runrates = run_2D_network();</code></pre><p>rates and times have been stored in the variables above!</p><h2 id="Hawkes-process"><a class="docs-heading-anchor" href="#Hawkes-process">Hawkes process</a><a id="Hawkes-process-1"></a><a class="docs-heading-anchor-permalink" href="#Hawkes-process" title="Permalink"></a></h2><p>To define the Hawkes process, I need to find equivalent rates and currents that account for the input-output function that I used.</p><pre><code class="language-julia hljs">weights_equiv = @. abs(α^2*weights)
inputs_equiv =  α .* (input .- (α .* weights+I)*fill(v0,2))
ps_e,tr_e = H.population_state_exp_and_trace(1,taus_hawk[1])
ps_i,tr_i = H.population_state_exp_and_trace_inhibitory(1,taus_hawk[2])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(HawkesSimulator.PopulationStateExpKernelInhibitory(Symbol(&quot;5f7&quot;), 1, (HawkesSimulator.Trace{HawkesSimulator.ForDynamics, Float64}([0.0], 3.0, 0.0, HawkesSimulator.ForDynamics()),)), HawkesSimulator.Trace{HawkesSimulator.ForDynamics, Float64}([0.0], 3.0, 0.0, HawkesSimulator.ForDynamics()))</code></pre><p>define conenctions</p><pre><code class="language-julia hljs">conn_ee = H.ConnectionExpKernel(onedmat(weights_equiv[1,1]),tr_e)
conn_ie = H.ConnectionExpKernel(onedmat(weights_equiv[2,1]),tr_e)
conn_ei = H.ConnectionExpKernel(onedmat(weights_equiv[1,2]),tr_i)
conn_ii = H.ConnectionExpKernel(onedmat(weights_equiv[2,2]),tr_i);</code></pre><p>define populations</p><pre><code class="language-julia hljs">pop_e = H.PopulationExpKernel(ps_e,inputs_equiv[1:1],(conn_ee,ps_e),(conn_ei,ps_i) )
pop_i = H.PopulationExpKernel(ps_i,inputs_equiv[2:2],(conn_ie,ps_e),(conn_ii,ps_i) );</code></pre><p>define recorder: I record all spiketimes, although I only need the rate</p><pre><code class="language-julia hljs">nrec = 10_010
rec = H.RecFullTrain(nrec,2);</code></pre><p>define network:</p><pre><code class="language-julia hljs">netw = H.RecurrentNetworkExpKernel((pop_e,pop_i),(rec,));</code></pre><p>run network</p><pre><code class="language-julia hljs">function run_simulation!(network,num_spikes)
  t_now = 0.0
  H.reset!(network) # clear spike trains etc
  for _ in 1:num_spikes
    t_now = H.dynamics_step!(t_now,network)
  end
  return t_now
end

nspikes = nrec - 1
t_end=run_simulation!(netw,nspikes)

recc = H.get_content(rec)
rates_e = H.numerical_rates(recc,1,t_end;pop_idx=1)
rates_i = H.numerical_rates(recc,1,t_end;pop_idx=2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Float64}:
 3.59152682264113</code></pre><h2 id="Result:-compare-the-rate-in-the-two-sytems"><a class="docs-heading-anchor" href="#Result:-compare-the-rate-in-the-two-sytems">Result: compare the rate in the two sytems</a><a id="Result:-compare-the-rate-in-the-two-sytems-1"></a><a class="docs-heading-anchor-permalink" href="#Result:-compare-the-rate-in-the-two-sytems" title="Permalink"></a></h2><pre><code class="language-julia hljs">@info &quot;final rates are $(round.(runrates[:,end];digits=2))&quot;
@info &quot;Hawkes final rates are $(round.(first.((rates_e,rates_i));digits=2))&quot;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: final rates are [2.73, 3.64]
[ Info: Hawkes final rates are (2.71, 3.59)</code></pre><p><strong>THE END</strong></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 6 June 2023 17:42">Tuesday 6 June 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
