<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1D Hawkes process with delayed alpha kernel · HawkesSimulator.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://dylanfesta.github.io/HawkesSimulator.jl/alphadelay/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">HawkesSimulator.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>1D Hawkes process with delayed alpha kernel</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1D Hawkes process with delayed alpha kernel</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/dylanfesta/HawkesSimulator.jl/blob/master/examples/alphadelay.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="D-Hawkes-process-with-delayed-alpha-kernel"><a class="docs-heading-anchor" href="#D-Hawkes-process-with-delayed-alpha-kernel">1D Hawkes process with delayed alpha kernel</a><a id="D-Hawkes-process-with-delayed-alpha-kernel-1"></a><a class="docs-heading-anchor-permalink" href="#D-Hawkes-process-with-delayed-alpha-kernel" title="Permalink"></a></h1><p>In this example, I simulate either a 1D or a 2D Hawkes process, with a delayed-alpha interaction kernel</p><p class="math-container">\[g(t) = H(t-t_{\text{delay}}) \,  \frac{(t-t_{\text{delay}})}{\tau^2} \,
 \exp\left(- \frac{(t-t_{\text{delay}})}{\tau} \right)\]</p><p>where <span>$H(x)$</span> is the Heaviside function: <span>$H(x)=0$</span> for <span>$x&lt;0$</span>, <span>$H(x)=1$</span> for <span>$t\geq 0$</span>.</p><p>Kernels are always normalized so that their integral is 1.</p><h2 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h2><pre><code class="language-julia hljs">using LinearAlgebra,Statistics,StatsBase,Distributions
using Plots,NamedColors ; theme(:default) #; plotlyjs()
using FFTW

using ProgressMeter
using Random
Random.seed!(0)

using HawkesSimulator; const global H = HawkesSimulator

#</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">HawkesSimulator</code></pre><h2 id="Define-and-visualize-the-kernel"><a class="docs-heading-anchor" href="#Define-and-visualize-the-kernel">Define and visualize the kernel</a><a id="Define-and-visualize-the-kernel-1"></a><a class="docs-heading-anchor-permalink" href="#Define-and-visualize-the-kernel" title="Permalink"></a></h2><pre><code class="language-julia hljs">mytau = 0.5
mydelay = 2.0
myw = fill(0.85,(1,1)) # 1x1 matrix
myinput = [0.5,]       # 1-dim vector

ker = H.KernelAlphaDelay(mytau,mydelay)

plt = let ts = range(-0.5,8;length=150)
  y = [H.interaction_kernel(_t,ker) for _t in ts]
  plt=plot(ts,y ; linewidth=3,leg=false,xlabel=&quot;time (s)&quot;,
      ylabel=&quot;interaction kernel&quot;)
  ymax=ylims()[2]
  plot!(plt,[0,0],[0,ymax];linestyle=:dash,linecolor=:black)
end;
plot(plt)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip140">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip140)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip141">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip140)" d="
M219.866 1423.18 L2352.76 1423.18 L2352.76 47.2441 L219.866 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip142">
    <rect x="219" y="47" width="2134" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  398.593,1423.18 398.593,47.2441 
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  872.043,1423.18 872.043,47.2441 
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1345.49,1423.18 1345.49,47.2441 
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1818.94,1423.18 1818.94,47.2441 
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2292.39,1423.18 2292.39,47.2441 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  398.593,1423.18 398.593,1404.28 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  872.043,1423.18 872.043,1404.28 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1345.49,1423.18 1345.49,1404.28 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1818.94,1423.18 1818.94,1404.28 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2292.39,1423.18 2292.39,1404.28 
  "/>
<path clip-path="url(#clip140)" d="M398.593 1454.1 Q394.982 1454.1 393.154 1457.66 Q391.348 1461.2 391.348 1468.33 Q391.348 1475.44 393.154 1479.01 Q394.982 1482.55 398.593 1482.55 Q402.228 1482.55 404.033 1479.01 Q405.862 1475.44 405.862 1468.33 Q405.862 1461.2 404.033 1457.66 Q402.228 1454.1 398.593 1454.1 M398.593 1450.39 Q404.404 1450.39 407.459 1455 Q410.538 1459.58 410.538 1468.33 Q410.538 1477.06 407.459 1481.67 Q404.404 1486.25 398.593 1486.25 Q392.783 1486.25 389.705 1481.67 Q386.649 1477.06 386.649 1468.33 Q386.649 1459.58 389.705 1455 Q392.783 1450.39 398.593 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M866.696 1481.64 L883.015 1481.64 L883.015 1485.58 L861.071 1485.58 L861.071 1481.64 Q863.733 1478.89 868.316 1474.26 Q872.922 1469.61 874.103 1468.27 Q876.348 1465.74 877.228 1464.01 Q878.131 1462.25 878.131 1460.56 Q878.131 1457.8 876.186 1456.07 Q874.265 1454.33 871.163 1454.33 Q868.964 1454.33 866.51 1455.09 Q864.08 1455.86 861.302 1457.41 L861.302 1452.69 Q864.126 1451.55 866.58 1450.97 Q869.034 1450.39 871.071 1450.39 Q876.441 1450.39 879.635 1453.08 Q882.83 1455.77 882.83 1460.26 Q882.83 1462.39 882.02 1464.31 Q881.233 1466.2 879.126 1468.8 Q878.547 1469.47 875.446 1472.69 Q872.344 1475.88 866.696 1481.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1348.5 1455.09 L1336.7 1473.54 L1348.5 1473.54 L1348.5 1455.09 M1347.27 1451.02 L1353.15 1451.02 L1353.15 1473.54 L1358.08 1473.54 L1358.08 1477.43 L1353.15 1477.43 L1353.15 1485.58 L1348.5 1485.58 L1348.5 1477.43 L1332.9 1477.43 L1332.9 1472.92 L1347.27 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1819.35 1466.44 Q1816.2 1466.44 1814.35 1468.59 Q1812.52 1470.74 1812.52 1474.49 Q1812.52 1478.22 1814.35 1480.39 Q1816.2 1482.55 1819.35 1482.55 Q1822.49 1482.55 1824.32 1480.39 Q1826.18 1478.22 1826.18 1474.49 Q1826.18 1470.74 1824.32 1468.59 Q1822.49 1466.44 1819.35 1466.44 M1828.63 1451.78 L1828.63 1456.04 Q1826.87 1455.21 1825.06 1454.77 Q1823.28 1454.33 1821.52 1454.33 Q1816.89 1454.33 1814.44 1457.45 Q1812.01 1460.58 1811.66 1466.9 Q1813.03 1464.89 1815.09 1463.82 Q1817.15 1462.73 1819.62 1462.73 Q1824.83 1462.73 1827.84 1465.9 Q1830.87 1469.05 1830.87 1474.49 Q1830.87 1479.82 1827.73 1483.03 Q1824.58 1486.25 1819.35 1486.25 Q1813.35 1486.25 1810.18 1481.67 Q1807.01 1477.06 1807.01 1468.33 Q1807.01 1460.14 1810.9 1455.28 Q1814.79 1450.39 1821.34 1450.39 Q1823.1 1450.39 1824.88 1450.74 Q1826.68 1451.09 1828.63 1451.78 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M2292.39 1469.17 Q2289.06 1469.17 2287.14 1470.95 Q2285.24 1472.73 2285.24 1475.86 Q2285.24 1478.98 2287.14 1480.77 Q2289.06 1482.55 2292.39 1482.55 Q2295.72 1482.55 2297.65 1480.77 Q2299.57 1478.96 2299.57 1475.86 Q2299.57 1472.73 2297.65 1470.95 Q2295.75 1469.17 2292.39 1469.17 M2287.72 1467.18 Q2284.71 1466.44 2283.02 1464.38 Q2281.35 1462.32 2281.35 1459.35 Q2281.35 1455.21 2284.29 1452.8 Q2287.25 1450.39 2292.39 1450.39 Q2297.55 1450.39 2300.49 1452.8 Q2303.43 1455.21 2303.43 1459.35 Q2303.43 1462.32 2301.74 1464.38 Q2300.08 1466.44 2297.09 1467.18 Q2300.47 1467.96 2302.34 1470.26 Q2304.24 1472.55 2304.24 1475.86 Q2304.24 1480.88 2301.16 1483.57 Q2298.11 1486.25 2292.39 1486.25 Q2286.67 1486.25 2283.59 1483.57 Q2280.54 1480.88 2280.54 1475.86 Q2280.54 1472.55 2282.44 1470.26 Q2284.34 1467.96 2287.72 1467.18 M2286 1459.79 Q2286 1462.48 2287.67 1463.98 Q2289.36 1465.49 2292.39 1465.49 Q2295.4 1465.49 2297.09 1463.98 Q2298.8 1462.48 2298.8 1459.79 Q2298.8 1457.11 2297.09 1455.6 Q2295.4 1454.1 2292.39 1454.1 Q2289.36 1454.1 2287.67 1455.6 Q2286 1457.11 2286 1459.79 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1173.77 1522.27 L1173.77 1532.4 L1185.83 1532.4 L1185.83 1536.95 L1173.77 1536.95 L1173.77 1556.3 Q1173.77 1560.66 1174.94 1561.9 Q1176.15 1563.14 1179.81 1563.14 L1185.83 1563.14 L1185.83 1568.04 L1179.81 1568.04 Q1173.03 1568.04 1170.46 1565.53 Q1167.88 1562.98 1167.88 1556.3 L1167.88 1536.95 L1163.58 1536.95 L1163.58 1532.4 L1167.88 1532.4 L1167.88 1522.27 L1173.77 1522.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1193.53 1532.4 L1199.39 1532.4 L1199.39 1568.04 L1193.53 1568.04 L1193.53 1532.4 M1193.53 1518.52 L1199.39 1518.52 L1199.39 1525.93 L1193.53 1525.93 L1193.53 1518.52 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1239.4 1539.24 Q1241.59 1535.29 1244.65 1533.41 Q1247.7 1531.54 1251.84 1531.54 Q1257.41 1531.54 1260.43 1535.45 Q1263.46 1539.33 1263.46 1546.53 L1263.46 1568.04 L1257.57 1568.04 L1257.57 1546.72 Q1257.57 1541.59 1255.76 1539.11 Q1253.94 1536.63 1250.22 1536.63 Q1245.67 1536.63 1243.02 1539.65 Q1240.38 1542.68 1240.38 1547.9 L1240.38 1568.04 L1234.49 1568.04 L1234.49 1546.72 Q1234.49 1541.56 1232.68 1539.11 Q1230.87 1536.63 1227.08 1536.63 Q1222.59 1536.63 1219.95 1539.68 Q1217.31 1542.71 1217.31 1547.9 L1217.31 1568.04 L1211.42 1568.04 L1211.42 1532.4 L1217.31 1532.4 L1217.31 1537.93 Q1219.31 1534.66 1222.11 1533.1 Q1224.91 1531.54 1228.77 1531.54 Q1232.65 1531.54 1235.35 1533.51 Q1238.09 1535.48 1239.4 1539.24 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1305.63 1548.76 L1305.63 1551.62 L1278.7 1551.62 Q1279.09 1557.67 1282.33 1560.85 Q1285.61 1564 1291.44 1564 Q1294.81 1564 1297.96 1563.17 Q1301.14 1562.35 1304.26 1560.69 L1304.26 1566.23 Q1301.11 1567.57 1297.8 1568.27 Q1294.49 1568.97 1291.09 1568.97 Q1282.56 1568.97 1277.56 1564 Q1272.59 1559.04 1272.59 1550.57 Q1272.59 1541.82 1277.3 1536.69 Q1282.05 1531.54 1290.07 1531.54 Q1297.26 1531.54 1301.43 1536.18 Q1305.63 1540.8 1305.63 1548.76 M1299.77 1547.04 Q1299.71 1542.23 1297.07 1539.37 Q1294.46 1536.5 1290.13 1536.5 Q1285.23 1536.5 1282.27 1539.27 Q1279.34 1542.04 1278.9 1547.07 L1299.77 1547.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1350.03 1518.58 Q1345.77 1525.9 1343.7 1533.06 Q1341.63 1540.23 1341.63 1547.58 Q1341.63 1554.93 1343.7 1562.16 Q1345.8 1569.35 1350.03 1576.64 L1344.94 1576.64 Q1340.16 1569.16 1337.78 1561.93 Q1335.42 1554.71 1335.42 1547.58 Q1335.42 1540.48 1337.78 1533.29 Q1340.13 1526.09 1344.94 1518.58 L1350.03 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1384.12 1533.45 L1384.12 1538.98 Q1381.64 1537.71 1378.96 1537.07 Q1376.29 1536.44 1373.43 1536.44 Q1369.07 1536.44 1366.87 1537.77 Q1364.7 1539.11 1364.7 1541.79 Q1364.7 1543.82 1366.26 1545 Q1367.82 1546.15 1372.53 1547.2 L1374.54 1547.64 Q1380.78 1548.98 1383.39 1551.43 Q1386.03 1553.85 1386.03 1558.21 Q1386.03 1563.17 1382.08 1566.07 Q1378.17 1568.97 1371.29 1568.97 Q1368.43 1568.97 1365.31 1568.39 Q1362.22 1567.85 1358.78 1566.74 L1358.78 1560.69 Q1362.03 1562.38 1365.18 1563.24 Q1368.33 1564.07 1371.42 1564.07 Q1375.56 1564.07 1377.79 1562.66 Q1380.01 1561.23 1380.01 1558.65 Q1380.01 1556.27 1378.39 1554.99 Q1376.8 1553.72 1371.36 1552.54 L1369.32 1552.07 Q1363.88 1550.92 1361.46 1548.56 Q1359.04 1546.18 1359.04 1542.04 Q1359.04 1537.01 1362.6 1534.27 Q1366.17 1531.54 1372.73 1531.54 Q1375.97 1531.54 1378.84 1532.01 Q1381.7 1532.49 1384.12 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1394.43 1518.58 L1399.53 1518.58 Q1404.3 1526.09 1406.65 1533.29 Q1409.04 1540.48 1409.04 1547.58 Q1409.04 1554.71 1406.65 1561.93 Q1404.3 1569.16 1399.53 1576.64 L1394.43 1576.64 Q1398.67 1569.35 1400.73 1562.16 Q1402.84 1554.93 1402.84 1547.58 Q1402.84 1540.23 1400.73 1533.06 Q1398.67 1525.9 1394.43 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,1384.24 2352.76,1384.24 
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,1041.3 2352.76,1041.3 
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,698.364 2352.76,698.364 
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,355.427 2352.76,355.427 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1423.18 219.866,47.2441 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1384.24 238.764,1384.24 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1041.3 238.764,1041.3 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,698.364 238.764,698.364 
  "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,355.427 238.764,355.427 
  "/>
<path clip-path="url(#clip140)" d="M126.691 1370.04 Q123.08 1370.04 121.251 1373.6 Q119.445 1377.14 119.445 1384.27 Q119.445 1391.38 121.251 1394.94 Q123.08 1398.49 126.691 1398.49 Q130.325 1398.49 132.13 1394.94 Q133.959 1391.38 133.959 1384.27 Q133.959 1377.14 132.13 1373.6 Q130.325 1370.04 126.691 1370.04 M126.691 1366.33 Q132.501 1366.33 135.556 1370.94 Q138.635 1375.52 138.635 1384.27 Q138.635 1393 135.556 1397.61 Q132.501 1402.19 126.691 1402.19 Q120.88 1402.19 117.802 1397.61 Q114.746 1393 114.746 1384.27 Q114.746 1375.52 117.802 1370.94 Q120.88 1366.33 126.691 1366.33 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M146.853 1395.64 L151.737 1395.64 L151.737 1401.52 L146.853 1401.52 L146.853 1395.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M171.922 1370.04 Q168.311 1370.04 166.482 1373.6 Q164.677 1377.14 164.677 1384.27 Q164.677 1391.38 166.482 1394.94 Q168.311 1398.49 171.922 1398.49 Q175.556 1398.49 177.362 1394.94 Q179.19 1391.38 179.19 1384.27 Q179.19 1377.14 177.362 1373.6 Q175.556 1370.04 171.922 1370.04 M171.922 1366.33 Q177.732 1366.33 180.788 1370.94 Q183.866 1375.52 183.866 1384.27 Q183.866 1393 180.788 1397.61 Q177.732 1402.19 171.922 1402.19 Q166.112 1402.19 163.033 1397.61 Q159.978 1393 159.978 1384.27 Q159.978 1375.52 163.033 1370.94 Q166.112 1366.33 171.922 1366.33 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M128.288 1027.1 Q124.677 1027.1 122.848 1030.66 Q121.043 1034.21 121.043 1041.34 Q121.043 1048.44 122.848 1052.01 Q124.677 1055.55 128.288 1055.55 Q131.922 1055.55 133.728 1052.01 Q135.556 1048.44 135.556 1041.34 Q135.556 1034.21 133.728 1030.66 Q131.922 1027.1 128.288 1027.1 M128.288 1023.4 Q134.098 1023.4 137.154 1028 Q140.232 1032.59 140.232 1041.34 Q140.232 1050.06 137.154 1054.67 Q134.098 1059.25 128.288 1059.25 Q122.478 1059.25 119.399 1054.67 Q116.343 1050.06 116.343 1041.34 Q116.343 1032.59 119.399 1028 Q122.478 1023.4 128.288 1023.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M148.45 1052.7 L153.334 1052.7 L153.334 1058.58 L148.45 1058.58 L148.45 1052.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M167.547 1054.65 L183.866 1054.65 L183.866 1058.58 L161.922 1058.58 L161.922 1054.65 Q164.584 1051.89 169.167 1047.26 Q173.774 1042.61 174.954 1041.27 Q177.2 1038.74 178.079 1037.01 Q178.982 1035.25 178.982 1033.56 Q178.982 1030.8 177.038 1029.07 Q175.116 1027.33 172.014 1027.33 Q169.815 1027.33 167.362 1028.1 Q164.931 1028.86 162.153 1030.41 L162.153 1025.69 Q164.977 1024.55 167.431 1023.97 Q169.885 1023.4 171.922 1023.4 Q177.292 1023.4 180.487 1026.08 Q183.681 1028.77 183.681 1033.26 Q183.681 1035.39 182.871 1037.31 Q182.084 1039.21 179.977 1041.8 Q179.399 1042.47 176.297 1045.69 Q173.195 1048.88 167.547 1054.65 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M126.205 684.163 Q122.593 684.163 120.765 687.728 Q118.959 691.269 118.959 698.399 Q118.959 705.505 120.765 709.07 Q122.593 712.612 126.205 712.612 Q129.839 712.612 131.644 709.07 Q133.473 705.505 133.473 698.399 Q133.473 691.269 131.644 687.728 Q129.839 684.163 126.205 684.163 M126.205 680.459 Q132.015 680.459 135.07 685.066 Q138.149 689.649 138.149 698.399 Q138.149 707.126 135.07 711.732 Q132.015 716.316 126.205 716.316 Q120.394 716.316 117.316 711.732 Q114.26 707.126 114.26 698.399 Q114.26 689.649 117.316 685.066 Q120.394 680.459 126.205 680.459 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M146.366 709.765 L151.251 709.765 L151.251 715.644 L146.366 715.644 L146.366 709.765 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M174.283 685.158 L162.477 703.607 L174.283 703.607 L174.283 685.158 M173.056 681.084 L178.936 681.084 L178.936 703.607 L183.866 703.607 L183.866 707.496 L178.936 707.496 L178.936 715.644 L174.283 715.644 L174.283 707.496 L158.681 707.496 L158.681 702.982 L173.056 681.084 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M126.529 341.226 Q122.918 341.226 121.089 344.791 Q119.283 348.332 119.283 355.462 Q119.283 362.569 121.089 366.133 Q122.918 369.675 126.529 369.675 Q130.163 369.675 131.968 366.133 Q133.797 362.569 133.797 355.462 Q133.797 348.332 131.968 344.791 Q130.163 341.226 126.529 341.226 M126.529 337.522 Q132.339 337.522 135.394 342.129 Q138.473 346.712 138.473 355.462 Q138.473 364.189 135.394 368.795 Q132.339 373.379 126.529 373.379 Q120.718 373.379 117.64 368.795 Q114.584 364.189 114.584 355.462 Q114.584 346.712 117.64 342.129 Q120.718 337.522 126.529 337.522 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M146.691 366.828 L151.575 366.828 L151.575 372.707 L146.691 372.707 L146.691 366.828 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M172.339 353.564 Q169.19 353.564 167.339 355.717 Q165.51 357.869 165.51 361.619 Q165.51 365.346 167.339 367.522 Q169.19 369.675 172.339 369.675 Q175.487 369.675 177.315 367.522 Q179.167 365.346 179.167 361.619 Q179.167 357.869 177.315 355.717 Q175.487 353.564 172.339 353.564 M181.621 338.911 L181.621 343.17 Q179.862 342.337 178.056 341.897 Q176.274 341.458 174.514 341.458 Q169.885 341.458 167.431 344.582 Q165.001 347.707 164.653 354.027 Q166.019 352.013 168.079 350.948 Q170.139 349.86 172.616 349.86 Q177.825 349.86 180.834 353.032 Q183.866 356.18 183.866 361.619 Q183.866 366.943 180.718 370.161 Q177.57 373.379 172.339 373.379 Q166.343 373.379 163.172 368.795 Q160.001 364.189 160.001 355.462 Q160.001 347.268 163.89 342.407 Q167.778 337.522 174.329 337.522 Q176.089 337.522 177.871 337.87 Q179.676 338.217 181.621 338.911 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M28.3562 1016.07 L28.3562 1010.21 L64.0042 1010.21 L64.0042 1016.07 L28.3562 1016.07 M14.479 1016.07 L14.479 1010.21 L21.895 1010.21 L21.895 1016.07 L14.479 1016.07 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M42.4881 968.324 L64.0042 968.324 L64.0042 974.181 L42.679 974.181 Q37.6183 974.181 35.1038 976.154 Q32.5894 978.127 32.5894 982.074 Q32.5894 986.817 35.6131 989.554 Q38.6368 992.291 43.8567 992.291 L64.0042 992.291 L64.0042 998.179 L28.3562 998.179 L28.3562 992.291 L33.8944 992.291 Q30.6797 990.19 29.0883 987.358 Q27.4968 984.493 27.4968 980.769 Q27.4968 974.626 31.3163 971.475 Q35.1038 968.324 42.4881 968.324 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M18.2347 950.85 L28.3562 950.85 L28.3562 938.787 L32.9077 938.787 L32.9077 950.85 L52.2594 950.85 Q56.6199 950.85 57.8613 949.673 Q59.1026 948.463 59.1026 944.803 L59.1026 938.787 L64.0042 938.787 L64.0042 944.803 Q64.0042 951.582 61.4897 954.16 Q58.9434 956.739 52.2594 956.739 L32.9077 956.739 L32.9077 961.035 L28.3562 961.035 L28.3562 956.739 L18.2347 956.739 L18.2347 950.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M44.7161 900.593 L47.5806 900.593 L47.5806 927.52 Q53.6281 927.138 56.8109 923.892 Q59.9619 920.613 59.9619 914.789 Q59.9619 911.415 59.1344 908.264 Q58.3069 905.081 56.6518 901.962 L62.1899 901.962 Q63.5267 905.113 64.227 908.423 Q64.9272 911.733 64.9272 915.139 Q64.9272 923.669 59.9619 928.666 Q54.9967 933.631 46.5303 933.631 Q37.7774 933.631 32.6531 928.92 Q27.4968 924.178 27.4968 916.157 Q27.4968 908.964 32.1438 904.794 Q36.7589 900.593 44.7161 900.593 M42.9973 906.449 Q38.1912 906.513 35.3266 909.155 Q32.4621 911.765 32.4621 916.094 Q32.4621 920.995 35.2312 923.955 Q38.0002 926.883 43.0292 927.329 L42.9973 906.449 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M33.8307 870.324 Q33.2578 871.311 33.0032 872.488 Q32.7167 873.634 32.7167 875.035 Q32.7167 880 35.9632 882.674 Q39.1779 885.315 45.2253 885.315 L64.0042 885.315 L64.0042 891.204 L28.3562 891.204 L28.3562 885.315 L33.8944 885.315 Q30.6479 883.469 29.0883 880.509 Q27.4968 877.549 27.4968 873.316 Q27.4968 872.711 27.5923 871.979 Q27.656 871.247 27.8151 870.356 L33.8307 870.324 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M46.0847 847.98 Q46.0847 855.078 47.7079 857.815 Q49.3312 860.553 53.2461 860.553 Q56.3653 860.553 58.2114 858.516 Q60.0256 856.447 60.0256 852.914 Q60.0256 848.044 56.5881 845.116 Q53.1188 842.156 47.3897 842.156 L46.0847 842.156 L46.0847 847.98 M43.6657 836.299 L64.0042 836.299 L64.0042 842.156 L58.5933 842.156 Q61.8398 844.161 63.3994 847.153 Q64.9272 850.145 64.9272 854.473 Q64.9272 859.948 61.8716 863.195 Q58.7843 866.409 53.6281 866.409 Q47.6125 866.409 44.5569 862.399 Q41.5014 858.357 41.5014 850.368 L41.5014 842.156 L40.9285 842.156 Q36.8862 842.156 34.6901 844.829 Q32.4621 847.471 32.4621 852.277 Q32.4621 855.333 33.1941 858.229 Q33.9262 861.126 35.3903 863.799 L29.9795 863.799 Q28.7381 860.585 28.1334 857.561 Q27.4968 854.537 27.4968 851.673 Q27.4968 843.938 31.5072 840.119 Q35.5176 836.299 43.6657 836.299 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M29.7248 798.583 L35.1993 798.583 Q33.8307 801.065 33.1623 803.58 Q32.4621 806.062 32.4621 808.609 Q32.4621 814.306 36.0905 817.457 Q39.6872 820.608 46.212 820.608 Q52.7369 820.608 56.3653 817.457 Q59.9619 814.306 59.9619 808.609 Q59.9619 806.062 59.2935 803.58 Q58.5933 801.065 57.2247 798.583 L62.6355 798.583 Q63.7814 801.033 64.3543 803.675 Q64.9272 806.285 64.9272 809.245 Q64.9272 817.298 59.8664 822.04 Q54.8057 826.783 46.212 826.783 Q37.491 826.783 32.4939 822.008 Q27.4968 817.202 27.4968 808.863 Q27.4968 806.158 28.0697 803.58 Q28.6108 801.002 29.7248 798.583 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M18.2347 782.605 L28.3562 782.605 L28.3562 770.542 L32.9077 770.542 L32.9077 782.605 L52.2594 782.605 Q56.6199 782.605 57.8613 781.427 Q59.1026 780.218 59.1026 776.557 L59.1026 770.542 L64.0042 770.542 L64.0042 776.557 Q64.0042 783.337 61.4897 785.915 Q58.9434 788.493 52.2594 788.493 L32.9077 788.493 L32.9077 792.79 L28.3562 792.79 L28.3562 788.493 L18.2347 788.493 L18.2347 782.605 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M28.3562 762.839 L28.3562 756.983 L64.0042 756.983 L64.0042 762.839 L28.3562 762.839 M14.479 762.839 L14.479 756.983 L21.895 756.983 L21.895 762.839 L14.479 762.839 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M32.4621 730.915 Q32.4621 735.626 36.1542 738.363 Q39.8145 741.1 46.212 741.1 Q52.6095 741.1 56.3017 738.395 Q59.9619 735.658 59.9619 730.915 Q59.9619 726.236 56.2698 723.499 Q52.5777 720.762 46.212 720.762 Q39.8781 720.762 36.186 723.499 Q32.4621 726.236 32.4621 730.915 M27.4968 730.915 Q27.4968 723.276 32.4621 718.916 Q37.4273 714.555 46.212 714.555 Q54.9649 714.555 59.9619 718.916 Q64.9272 723.276 64.9272 730.915 Q64.9272 738.586 59.9619 742.946 Q54.9649 747.275 46.212 747.275 Q37.4273 747.275 32.4621 742.946 Q27.4968 738.586 27.4968 730.915 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M42.4881 675.215 L64.0042 675.215 L64.0042 681.072 L42.679 681.072 Q37.6183 681.072 35.1038 683.045 Q32.5894 685.018 32.5894 688.965 Q32.5894 693.708 35.6131 696.445 Q38.6368 699.182 43.8567 699.182 L64.0042 699.182 L64.0042 705.07 L28.3562 705.07 L28.3562 699.182 L33.8944 699.182 Q30.6797 697.081 29.0883 694.249 Q27.4968 691.384 27.4968 687.66 Q27.4968 681.517 31.3163 678.366 Q35.1038 675.215 42.4881 675.215 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M14.479 643.037 L14.479 637.148 L43.7294 637.148 L28.3562 619.674 L28.3562 612.195 L45.0344 631.101 L64.0042 611.399 L64.0042 619.038 L46.5939 637.148 L64.0042 637.148 L64.0042 643.037 L14.479 643.037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M44.7161 576.897 L47.5806 576.897 L47.5806 603.824 Q53.6281 603.442 56.8109 600.195 Q59.9619 596.917 59.9619 591.092 Q59.9619 587.719 59.1344 584.568 Q58.3069 581.385 56.6518 578.265 L62.1899 578.265 Q63.5267 581.416 64.227 584.727 Q64.9272 588.037 64.9272 591.442 Q64.9272 599.973 59.9619 604.97 Q54.9967 609.935 46.5303 609.935 Q37.7774 609.935 32.6531 605.224 Q27.4968 600.482 27.4968 592.461 Q27.4968 585.268 32.1438 581.098 Q36.7589 576.897 44.7161 576.897 M42.9973 582.753 Q38.1912 582.817 35.3266 585.459 Q32.4621 588.069 32.4621 592.397 Q32.4621 597.299 35.2312 600.259 Q38.0002 603.187 43.0292 603.633 L42.9973 582.753 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M33.8307 546.628 Q33.2578 547.615 33.0032 548.792 Q32.7167 549.938 32.7167 551.339 Q32.7167 556.304 35.9632 558.977 Q39.1779 561.619 45.2253 561.619 L64.0042 561.619 L64.0042 567.507 L28.3562 567.507 L28.3562 561.619 L33.8944 561.619 Q30.6479 559.773 29.0883 556.813 Q27.4968 553.853 27.4968 549.62 Q27.4968 549.015 27.5923 548.283 Q27.656 547.551 27.8151 546.66 L33.8307 546.628 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M42.4881 511.998 L64.0042 511.998 L64.0042 517.855 L42.679 517.855 Q37.6183 517.855 35.1038 519.828 Q32.5894 521.802 32.5894 525.748 Q32.5894 530.491 35.6131 533.228 Q38.6368 535.965 43.8567 535.965 L64.0042 535.965 L64.0042 541.854 L28.3562 541.854 L28.3562 535.965 L33.8944 535.965 Q30.6797 533.865 29.0883 531.032 Q27.4968 528.167 27.4968 524.443 Q27.4968 518.301 31.3163 515.149 Q35.1038 511.998 42.4881 511.998 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M44.7161 469.826 L47.5806 469.826 L47.5806 496.753 Q53.6281 496.371 56.8109 493.124 Q59.9619 489.846 59.9619 484.021 Q59.9619 480.647 59.1344 477.496 Q58.3069 474.313 56.6518 471.194 L62.1899 471.194 Q63.5267 474.345 64.227 477.655 Q64.9272 480.966 64.9272 484.371 Q64.9272 492.901 59.9619 497.898 Q54.9967 502.864 46.5303 502.864 Q37.7774 502.864 32.6531 498.153 Q27.4968 493.411 27.4968 485.39 Q27.4968 478.197 32.1438 474.027 Q36.7589 469.826 44.7161 469.826 M42.9973 475.682 Q38.1912 475.746 35.3266 478.388 Q32.4621 480.997 32.4621 485.326 Q32.4621 490.228 35.2312 493.188 Q38.0002 496.116 43.0292 496.562 L42.9973 475.682 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip140)" d="M14.479 460.213 L14.479 454.357 L64.0042 454.357 L64.0042 460.213 L14.479 460.213 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip142)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  280.231,1384.24 293.735,1384.24 307.24,1384.24 320.744,1384.24 334.249,1384.24 347.753,1384.24 361.258,1384.24 374.762,1384.24 388.267,1384.24 401.771,1384.24 
  415.275,1384.24 428.78,1384.24 442.284,1384.24 455.789,1384.24 469.293,1384.24 482.798,1384.24 496.302,1384.24 509.806,1384.24 523.311,1384.24 536.815,1384.24 
  550.32,1384.24 563.824,1384.24 577.329,1384.24 590.833,1384.24 604.337,1384.24 617.842,1384.24 631.346,1384.24 644.851,1384.24 658.355,1384.24 671.86,1384.24 
  685.364,1384.24 698.868,1384.24 712.373,1384.24 725.877,1384.24 739.382,1384.24 752.886,1384.24 766.391,1384.24 779.895,1384.24 793.399,1384.24 806.904,1384.24 
  820.408,1384.24 833.913,1384.24 847.417,1384.24 860.922,1384.24 874.426,1316.57 887.93,981.74 901.435,719.907 914.939,519.218 928.444,369.531 941.948,262.182 
  955.453,189.78 968.957,146.038 982.461,125.615 995.966,123.993 1009.47,137.354 1022.97,162.486 1036.48,196.694 1049.98,237.731 1063.49,283.724 1076.99,333.129 
  1090.5,384.674 1104,437.325 1117.51,490.242 1131.01,542.757 1144.51,594.341 1158.02,644.585 1171.52,693.176 1185.03,739.889 1198.53,784.562 1212.04,827.093 
  1225.54,867.425 1239.05,905.536 1252.55,941.437 1266.05,975.162 1279.56,1006.76 1293.06,1036.3 1306.57,1063.86 1320.07,1089.52 1333.58,1113.38 1347.08,1135.51 
  1360.59,1156.02 1374.09,1175 1387.59,1192.54 1401.1,1208.73 1414.6,1223.66 1428.11,1237.41 1441.61,1250.06 1455.12,1261.69 1468.62,1272.37 1482.13,1282.17 
  1495.63,1291.16 1509.13,1299.4 1522.64,1306.94 1536.14,1313.85 1549.65,1320.16 1563.15,1325.93 1576.66,1331.2 1590.16,1336.01 1603.67,1340.4 1617.17,1344.41 
  1630.67,1348.06 1644.18,1351.38 1657.68,1354.41 1671.19,1357.17 1684.69,1359.68 1698.2,1361.97 1711.7,1364.04 1725.21,1365.93 1738.71,1367.65 1752.21,1369.21 
  1765.72,1370.62 1779.22,1371.91 1792.73,1373.07 1806.23,1374.13 1819.74,1375.09 1833.24,1375.96 1846.74,1376.75 1860.25,1377.46 1873.75,1378.11 1887.26,1378.7 
  1900.76,1379.23 1914.27,1379.71 1927.77,1380.15 1941.28,1380.54 1954.78,1380.9 1968.28,1381.22 1981.79,1381.51 1995.29,1381.78 2008.8,1382.02 2022.3,1382.23 
  2035.81,1382.43 2049.31,1382.6 2062.82,1382.76 2076.32,1382.91 2089.82,1383.04 2103.33,1383.16 2116.83,1383.26 2130.34,1383.36 2143.84,1383.44 2157.35,1383.52 
  2170.85,1383.59 2184.36,1383.66 2197.86,1383.71 2211.36,1383.77 2224.87,1383.81 2238.37,1383.85 2251.88,1383.89 2265.38,1383.93 2278.89,1383.96 2292.39,1383.99 
  
  "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" stroke-dasharray="16, 10" points="
  398.593,1384.24 398.593,86.1857 
  "/>
</svg>
<p>Note that the kernel starts after zero, according to the delay indicated.</p><p>As a side note: in order to simulate Hawkes processes, one always needs to define a <em>non-increasing upper limit</em> to the kernel. This is what it looks like for this kernel.</p><pre><code class="language-julia hljs">plt = let  ts = range(-0.5,8;length=150)
  y = [H.interaction_kernel(_t,ker) for _t in ts]
  yu = [H.interaction_kernel_upper(_t,ker) for _t in ts]
  plt = plot(ts,y ; linewidth=3,xlabel=&quot;time (s)&quot;,
      ylabel=&quot;interaction kernel&quot;, label=&quot;true kernel&quot;)
  plot!(plt, ts,yu ; linewidth=2, label=&quot;upper limit&quot;, linestyle=:dash)
  ymax=ylims()[2]
  plot!(plt,[0,0],[0,ymax];linestyle=:dash,linecolor=:black,label=&quot;&quot;)
end;
plot(plt)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip200">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip200)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip201">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip200)" d="
M219.866 1423.18 L2352.76 1423.18 L2352.76 47.2441 L219.866 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip202">
    <rect x="219" y="47" width="2134" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  398.593,1423.18 398.593,47.2441 
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  872.043,1423.18 872.043,47.2441 
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1345.49,1423.18 1345.49,47.2441 
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1818.94,1423.18 1818.94,47.2441 
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2292.39,1423.18 2292.39,47.2441 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  398.593,1423.18 398.593,1404.28 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  872.043,1423.18 872.043,1404.28 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1345.49,1423.18 1345.49,1404.28 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1818.94,1423.18 1818.94,1404.28 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2292.39,1423.18 2292.39,1404.28 
  "/>
<path clip-path="url(#clip200)" d="M398.593 1454.1 Q394.982 1454.1 393.154 1457.66 Q391.348 1461.2 391.348 1468.33 Q391.348 1475.44 393.154 1479.01 Q394.982 1482.55 398.593 1482.55 Q402.228 1482.55 404.033 1479.01 Q405.862 1475.44 405.862 1468.33 Q405.862 1461.2 404.033 1457.66 Q402.228 1454.1 398.593 1454.1 M398.593 1450.39 Q404.404 1450.39 407.459 1455 Q410.538 1459.58 410.538 1468.33 Q410.538 1477.06 407.459 1481.67 Q404.404 1486.25 398.593 1486.25 Q392.783 1486.25 389.705 1481.67 Q386.649 1477.06 386.649 1468.33 Q386.649 1459.58 389.705 1455 Q392.783 1450.39 398.593 1450.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M866.696 1481.64 L883.015 1481.64 L883.015 1485.58 L861.071 1485.58 L861.071 1481.64 Q863.733 1478.89 868.316 1474.26 Q872.922 1469.61 874.103 1468.27 Q876.348 1465.74 877.228 1464.01 Q878.131 1462.25 878.131 1460.56 Q878.131 1457.8 876.186 1456.07 Q874.265 1454.33 871.163 1454.33 Q868.964 1454.33 866.51 1455.09 Q864.08 1455.86 861.302 1457.41 L861.302 1452.69 Q864.126 1451.55 866.58 1450.97 Q869.034 1450.39 871.071 1450.39 Q876.441 1450.39 879.635 1453.08 Q882.83 1455.77 882.83 1460.26 Q882.83 1462.39 882.02 1464.31 Q881.233 1466.2 879.126 1468.8 Q878.547 1469.47 875.446 1472.69 Q872.344 1475.88 866.696 1481.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1348.5 1455.09 L1336.7 1473.54 L1348.5 1473.54 L1348.5 1455.09 M1347.27 1451.02 L1353.15 1451.02 L1353.15 1473.54 L1358.08 1473.54 L1358.08 1477.43 L1353.15 1477.43 L1353.15 1485.58 L1348.5 1485.58 L1348.5 1477.43 L1332.9 1477.43 L1332.9 1472.92 L1347.27 1451.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1819.35 1466.44 Q1816.2 1466.44 1814.35 1468.59 Q1812.52 1470.74 1812.52 1474.49 Q1812.52 1478.22 1814.35 1480.39 Q1816.2 1482.55 1819.35 1482.55 Q1822.49 1482.55 1824.32 1480.39 Q1826.18 1478.22 1826.18 1474.49 Q1826.18 1470.74 1824.32 1468.59 Q1822.49 1466.44 1819.35 1466.44 M1828.63 1451.78 L1828.63 1456.04 Q1826.87 1455.21 1825.06 1454.77 Q1823.28 1454.33 1821.52 1454.33 Q1816.89 1454.33 1814.44 1457.45 Q1812.01 1460.58 1811.66 1466.9 Q1813.03 1464.89 1815.09 1463.82 Q1817.15 1462.73 1819.62 1462.73 Q1824.83 1462.73 1827.84 1465.9 Q1830.87 1469.05 1830.87 1474.49 Q1830.87 1479.82 1827.73 1483.03 Q1824.58 1486.25 1819.35 1486.25 Q1813.35 1486.25 1810.18 1481.67 Q1807.01 1477.06 1807.01 1468.33 Q1807.01 1460.14 1810.9 1455.28 Q1814.79 1450.39 1821.34 1450.39 Q1823.1 1450.39 1824.88 1450.74 Q1826.68 1451.09 1828.63 1451.78 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2292.39 1469.17 Q2289.06 1469.17 2287.14 1470.95 Q2285.24 1472.73 2285.24 1475.86 Q2285.24 1478.98 2287.14 1480.77 Q2289.06 1482.55 2292.39 1482.55 Q2295.72 1482.55 2297.65 1480.77 Q2299.57 1478.96 2299.57 1475.86 Q2299.57 1472.73 2297.65 1470.95 Q2295.75 1469.17 2292.39 1469.17 M2287.72 1467.18 Q2284.71 1466.44 2283.02 1464.38 Q2281.35 1462.32 2281.35 1459.35 Q2281.35 1455.21 2284.29 1452.8 Q2287.25 1450.39 2292.39 1450.39 Q2297.55 1450.39 2300.49 1452.8 Q2303.43 1455.21 2303.43 1459.35 Q2303.43 1462.32 2301.74 1464.38 Q2300.08 1466.44 2297.09 1467.18 Q2300.47 1467.96 2302.34 1470.26 Q2304.24 1472.55 2304.24 1475.86 Q2304.24 1480.88 2301.16 1483.57 Q2298.11 1486.25 2292.39 1486.25 Q2286.67 1486.25 2283.59 1483.57 Q2280.54 1480.88 2280.54 1475.86 Q2280.54 1472.55 2282.44 1470.26 Q2284.34 1467.96 2287.72 1467.18 M2286 1459.79 Q2286 1462.48 2287.67 1463.98 Q2289.36 1465.49 2292.39 1465.49 Q2295.4 1465.49 2297.09 1463.98 Q2298.8 1462.48 2298.8 1459.79 Q2298.8 1457.11 2297.09 1455.6 Q2295.4 1454.1 2292.39 1454.1 Q2289.36 1454.1 2287.67 1455.6 Q2286 1457.11 2286 1459.79 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1173.77 1522.27 L1173.77 1532.4 L1185.83 1532.4 L1185.83 1536.95 L1173.77 1536.95 L1173.77 1556.3 Q1173.77 1560.66 1174.94 1561.9 Q1176.15 1563.14 1179.81 1563.14 L1185.83 1563.14 L1185.83 1568.04 L1179.81 1568.04 Q1173.03 1568.04 1170.46 1565.53 Q1167.88 1562.98 1167.88 1556.3 L1167.88 1536.95 L1163.58 1536.95 L1163.58 1532.4 L1167.88 1532.4 L1167.88 1522.27 L1173.77 1522.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1193.53 1532.4 L1199.39 1532.4 L1199.39 1568.04 L1193.53 1568.04 L1193.53 1532.4 M1193.53 1518.52 L1199.39 1518.52 L1199.39 1525.93 L1193.53 1525.93 L1193.53 1518.52 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1239.4 1539.24 Q1241.59 1535.29 1244.65 1533.41 Q1247.7 1531.54 1251.84 1531.54 Q1257.41 1531.54 1260.43 1535.45 Q1263.46 1539.33 1263.46 1546.53 L1263.46 1568.04 L1257.57 1568.04 L1257.57 1546.72 Q1257.57 1541.59 1255.76 1539.11 Q1253.94 1536.63 1250.22 1536.63 Q1245.67 1536.63 1243.02 1539.65 Q1240.38 1542.68 1240.38 1547.9 L1240.38 1568.04 L1234.49 1568.04 L1234.49 1546.72 Q1234.49 1541.56 1232.68 1539.11 Q1230.87 1536.63 1227.08 1536.63 Q1222.59 1536.63 1219.95 1539.68 Q1217.31 1542.71 1217.31 1547.9 L1217.31 1568.04 L1211.42 1568.04 L1211.42 1532.4 L1217.31 1532.4 L1217.31 1537.93 Q1219.31 1534.66 1222.11 1533.1 Q1224.91 1531.54 1228.77 1531.54 Q1232.65 1531.54 1235.35 1533.51 Q1238.09 1535.48 1239.4 1539.24 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1305.63 1548.76 L1305.63 1551.62 L1278.7 1551.62 Q1279.09 1557.67 1282.33 1560.85 Q1285.61 1564 1291.44 1564 Q1294.81 1564 1297.96 1563.17 Q1301.14 1562.35 1304.26 1560.69 L1304.26 1566.23 Q1301.11 1567.57 1297.8 1568.27 Q1294.49 1568.97 1291.09 1568.97 Q1282.56 1568.97 1277.56 1564 Q1272.59 1559.04 1272.59 1550.57 Q1272.59 1541.82 1277.3 1536.69 Q1282.05 1531.54 1290.07 1531.54 Q1297.26 1531.54 1301.43 1536.18 Q1305.63 1540.8 1305.63 1548.76 M1299.77 1547.04 Q1299.71 1542.23 1297.07 1539.37 Q1294.46 1536.5 1290.13 1536.5 Q1285.23 1536.5 1282.27 1539.27 Q1279.34 1542.04 1278.9 1547.07 L1299.77 1547.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1350.03 1518.58 Q1345.77 1525.9 1343.7 1533.06 Q1341.63 1540.23 1341.63 1547.58 Q1341.63 1554.93 1343.7 1562.16 Q1345.8 1569.35 1350.03 1576.64 L1344.94 1576.64 Q1340.16 1569.16 1337.78 1561.93 Q1335.42 1554.71 1335.42 1547.58 Q1335.42 1540.48 1337.78 1533.29 Q1340.13 1526.09 1344.94 1518.58 L1350.03 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1384.12 1533.45 L1384.12 1538.98 Q1381.64 1537.71 1378.96 1537.07 Q1376.29 1536.44 1373.43 1536.44 Q1369.07 1536.44 1366.87 1537.77 Q1364.7 1539.11 1364.7 1541.79 Q1364.7 1543.82 1366.26 1545 Q1367.82 1546.15 1372.53 1547.2 L1374.54 1547.64 Q1380.78 1548.98 1383.39 1551.43 Q1386.03 1553.85 1386.03 1558.21 Q1386.03 1563.17 1382.08 1566.07 Q1378.17 1568.97 1371.29 1568.97 Q1368.43 1568.97 1365.31 1568.39 Q1362.22 1567.85 1358.78 1566.74 L1358.78 1560.69 Q1362.03 1562.38 1365.18 1563.24 Q1368.33 1564.07 1371.42 1564.07 Q1375.56 1564.07 1377.79 1562.66 Q1380.01 1561.23 1380.01 1558.65 Q1380.01 1556.27 1378.39 1554.99 Q1376.8 1553.72 1371.36 1552.54 L1369.32 1552.07 Q1363.88 1550.92 1361.46 1548.56 Q1359.04 1546.18 1359.04 1542.04 Q1359.04 1537.01 1362.6 1534.27 Q1366.17 1531.54 1372.73 1531.54 Q1375.97 1531.54 1378.84 1532.01 Q1381.7 1532.49 1384.12 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1394.43 1518.58 L1399.53 1518.58 Q1404.3 1526.09 1406.65 1533.29 Q1409.04 1540.48 1409.04 1547.58 Q1409.04 1554.71 1406.65 1561.93 Q1404.3 1569.16 1399.53 1576.64 L1394.43 1576.64 Q1398.67 1569.35 1400.73 1562.16 Q1402.84 1554.93 1402.84 1547.58 Q1402.84 1540.23 1400.73 1533.06 Q1398.67 1525.9 1394.43 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,1384.24 2352.76,1384.24 
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,1041.67 2352.76,1041.67 
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,699.098 2352.76,699.098 
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.866,356.528 2352.76,356.528 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1423.18 219.866,47.2441 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1384.24 238.764,1384.24 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,1041.67 238.764,1041.67 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,699.098 238.764,699.098 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.866,356.528 238.764,356.528 
  "/>
<path clip-path="url(#clip200)" d="M126.691 1370.04 Q123.08 1370.04 121.251 1373.6 Q119.445 1377.14 119.445 1384.27 Q119.445 1391.38 121.251 1394.94 Q123.08 1398.49 126.691 1398.49 Q130.325 1398.49 132.13 1394.94 Q133.959 1391.38 133.959 1384.27 Q133.959 1377.14 132.13 1373.6 Q130.325 1370.04 126.691 1370.04 M126.691 1366.33 Q132.501 1366.33 135.556 1370.94 Q138.635 1375.52 138.635 1384.27 Q138.635 1393 135.556 1397.61 Q132.501 1402.19 126.691 1402.19 Q120.88 1402.19 117.802 1397.61 Q114.746 1393 114.746 1384.27 Q114.746 1375.52 117.802 1370.94 Q120.88 1366.33 126.691 1366.33 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M146.853 1395.64 L151.737 1395.64 L151.737 1401.52 L146.853 1401.52 L146.853 1395.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M171.922 1370.04 Q168.311 1370.04 166.482 1373.6 Q164.677 1377.14 164.677 1384.27 Q164.677 1391.38 166.482 1394.94 Q168.311 1398.49 171.922 1398.49 Q175.556 1398.49 177.362 1394.94 Q179.19 1391.38 179.19 1384.27 Q179.19 1377.14 177.362 1373.6 Q175.556 1370.04 171.922 1370.04 M171.922 1366.33 Q177.732 1366.33 180.788 1370.94 Q183.866 1375.52 183.866 1384.27 Q183.866 1393 180.788 1397.61 Q177.732 1402.19 171.922 1402.19 Q166.112 1402.19 163.033 1397.61 Q159.978 1393 159.978 1384.27 Q159.978 1375.52 163.033 1370.94 Q166.112 1366.33 171.922 1366.33 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M128.288 1027.47 Q124.677 1027.47 122.848 1031.03 Q121.043 1034.57 121.043 1041.7 Q121.043 1048.81 122.848 1052.37 Q124.677 1055.92 128.288 1055.92 Q131.922 1055.92 133.728 1052.37 Q135.556 1048.81 135.556 1041.7 Q135.556 1034.57 133.728 1031.03 Q131.922 1027.47 128.288 1027.47 M128.288 1023.76 Q134.098 1023.76 137.154 1028.37 Q140.232 1032.95 140.232 1041.7 Q140.232 1050.43 137.154 1055.04 Q134.098 1059.62 128.288 1059.62 Q122.478 1059.62 119.399 1055.04 Q116.343 1050.43 116.343 1041.7 Q116.343 1032.95 119.399 1028.37 Q122.478 1023.76 128.288 1023.76 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M148.45 1053.07 L153.334 1053.07 L153.334 1058.95 L148.45 1058.95 L148.45 1053.07 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M167.547 1055.01 L183.866 1055.01 L183.866 1058.95 L161.922 1058.95 L161.922 1055.01 Q164.584 1052.26 169.167 1047.63 Q173.774 1042.98 174.954 1041.63 Q177.2 1039.11 178.079 1037.37 Q178.982 1035.61 178.982 1033.93 Q178.982 1031.17 177.038 1029.43 Q175.116 1027.7 172.014 1027.7 Q169.815 1027.7 167.362 1028.46 Q164.931 1029.23 162.153 1030.78 L162.153 1026.05 Q164.977 1024.92 167.431 1024.34 Q169.885 1023.76 171.922 1023.76 Q177.292 1023.76 180.487 1026.45 Q183.681 1029.13 183.681 1033.62 Q183.681 1035.75 182.871 1037.68 Q182.084 1039.57 179.977 1042.17 Q179.399 1042.84 176.297 1046.05 Q173.195 1049.25 167.547 1055.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M126.205 684.897 Q122.593 684.897 120.765 688.461 Q118.959 692.003 118.959 699.133 Q118.959 706.239 120.765 709.804 Q122.593 713.346 126.205 713.346 Q129.839 713.346 131.644 709.804 Q133.473 706.239 133.473 699.133 Q133.473 692.003 131.644 688.461 Q129.839 684.897 126.205 684.897 M126.205 681.193 Q132.015 681.193 135.07 685.799 Q138.149 690.383 138.149 699.133 Q138.149 707.859 135.07 712.466 Q132.015 717.049 126.205 717.049 Q120.394 717.049 117.316 712.466 Q114.26 707.859 114.26 699.133 Q114.26 690.383 117.316 685.799 Q120.394 681.193 126.205 681.193 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M146.366 710.498 L151.251 710.498 L151.251 716.378 L146.366 716.378 L146.366 710.498 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M174.283 685.892 L162.477 704.341 L174.283 704.341 L174.283 685.892 M173.056 681.818 L178.936 681.818 L178.936 704.341 L183.866 704.341 L183.866 708.23 L178.936 708.23 L178.936 716.378 L174.283 716.378 L174.283 708.23 L158.681 708.23 L158.681 703.716 L173.056 681.818 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M126.529 342.326 Q122.918 342.326 121.089 345.891 Q119.283 349.433 119.283 356.562 Q119.283 363.669 121.089 367.234 Q122.918 370.775 126.529 370.775 Q130.163 370.775 131.968 367.234 Q133.797 363.669 133.797 356.562 Q133.797 349.433 131.968 345.891 Q130.163 342.326 126.529 342.326 M126.529 338.623 Q132.339 338.623 135.394 343.229 Q138.473 347.813 138.473 356.562 Q138.473 365.289 135.394 369.896 Q132.339 374.479 126.529 374.479 Q120.718 374.479 117.64 369.896 Q114.584 365.289 114.584 356.562 Q114.584 347.813 117.64 343.229 Q120.718 338.623 126.529 338.623 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M146.691 367.928 L151.575 367.928 L151.575 373.808 L146.691 373.808 L146.691 367.928 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M172.339 354.664 Q169.19 354.664 167.339 356.817 Q165.51 358.97 165.51 362.72 Q165.51 366.447 167.339 368.623 Q169.19 370.775 172.339 370.775 Q175.487 370.775 177.315 368.623 Q179.167 366.447 179.167 362.72 Q179.167 358.97 177.315 356.817 Q175.487 354.664 172.339 354.664 M181.621 340.012 L181.621 344.271 Q179.862 343.438 178.056 342.998 Q176.274 342.558 174.514 342.558 Q169.885 342.558 167.431 345.683 Q165.001 348.808 164.653 355.127 Q166.019 353.113 168.079 352.049 Q170.139 350.961 172.616 350.961 Q177.825 350.961 180.834 354.132 Q183.866 357.28 183.866 362.72 Q183.866 368.044 180.718 371.261 Q177.57 374.479 172.339 374.479 Q166.343 374.479 163.172 369.896 Q160.001 365.289 160.001 356.562 Q160.001 348.368 163.89 343.507 Q167.778 338.623 174.329 338.623 Q176.089 338.623 177.871 338.97 Q179.676 339.317 181.621 340.012 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M28.3562 1016.07 L28.3562 1010.21 L64.0042 1010.21 L64.0042 1016.07 L28.3562 1016.07 M14.479 1016.07 L14.479 1010.21 L21.895 1010.21 L21.895 1016.07 L14.479 1016.07 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M42.4881 968.324 L64.0042 968.324 L64.0042 974.181 L42.679 974.181 Q37.6183 974.181 35.1038 976.154 Q32.5894 978.127 32.5894 982.074 Q32.5894 986.817 35.6131 989.554 Q38.6368 992.291 43.8567 992.291 L64.0042 992.291 L64.0042 998.179 L28.3562 998.179 L28.3562 992.291 L33.8944 992.291 Q30.6797 990.19 29.0883 987.358 Q27.4968 984.493 27.4968 980.769 Q27.4968 974.626 31.3163 971.475 Q35.1038 968.324 42.4881 968.324 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M18.2347 950.85 L28.3562 950.85 L28.3562 938.787 L32.9077 938.787 L32.9077 950.85 L52.2594 950.85 Q56.6199 950.85 57.8613 949.673 Q59.1026 948.463 59.1026 944.803 L59.1026 938.787 L64.0042 938.787 L64.0042 944.803 Q64.0042 951.582 61.4897 954.16 Q58.9434 956.739 52.2594 956.739 L32.9077 956.739 L32.9077 961.035 L28.3562 961.035 L28.3562 956.739 L18.2347 956.739 L18.2347 950.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M44.7161 900.593 L47.5806 900.593 L47.5806 927.52 Q53.6281 927.138 56.8109 923.892 Q59.9619 920.613 59.9619 914.789 Q59.9619 911.415 59.1344 908.264 Q58.3069 905.081 56.6518 901.962 L62.1899 901.962 Q63.5267 905.113 64.227 908.423 Q64.9272 911.733 64.9272 915.139 Q64.9272 923.669 59.9619 928.666 Q54.9967 933.631 46.5303 933.631 Q37.7774 933.631 32.6531 928.92 Q27.4968 924.178 27.4968 916.157 Q27.4968 908.964 32.1438 904.794 Q36.7589 900.593 44.7161 900.593 M42.9973 906.449 Q38.1912 906.513 35.3266 909.155 Q32.4621 911.765 32.4621 916.094 Q32.4621 920.995 35.2312 923.955 Q38.0002 926.883 43.0292 927.329 L42.9973 906.449 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M33.8307 870.324 Q33.2578 871.311 33.0032 872.488 Q32.7167 873.634 32.7167 875.035 Q32.7167 880 35.9632 882.674 Q39.1779 885.315 45.2253 885.315 L64.0042 885.315 L64.0042 891.204 L28.3562 891.204 L28.3562 885.315 L33.8944 885.315 Q30.6479 883.469 29.0883 880.509 Q27.4968 877.549 27.4968 873.316 Q27.4968 872.711 27.5923 871.979 Q27.656 871.247 27.8151 870.356 L33.8307 870.324 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M46.0847 847.98 Q46.0847 855.078 47.7079 857.815 Q49.3312 860.553 53.2461 860.553 Q56.3653 860.553 58.2114 858.516 Q60.0256 856.447 60.0256 852.914 Q60.0256 848.044 56.5881 845.116 Q53.1188 842.156 47.3897 842.156 L46.0847 842.156 L46.0847 847.98 M43.6657 836.299 L64.0042 836.299 L64.0042 842.156 L58.5933 842.156 Q61.8398 844.161 63.3994 847.153 Q64.9272 850.145 64.9272 854.473 Q64.9272 859.948 61.8716 863.195 Q58.7843 866.409 53.6281 866.409 Q47.6125 866.409 44.5569 862.399 Q41.5014 858.357 41.5014 850.368 L41.5014 842.156 L40.9285 842.156 Q36.8862 842.156 34.6901 844.829 Q32.4621 847.471 32.4621 852.277 Q32.4621 855.333 33.1941 858.229 Q33.9262 861.126 35.3903 863.799 L29.9795 863.799 Q28.7381 860.585 28.1334 857.561 Q27.4968 854.537 27.4968 851.673 Q27.4968 843.938 31.5072 840.119 Q35.5176 836.299 43.6657 836.299 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M29.7248 798.583 L35.1993 798.583 Q33.8307 801.065 33.1623 803.58 Q32.4621 806.062 32.4621 808.609 Q32.4621 814.306 36.0905 817.457 Q39.6872 820.608 46.212 820.608 Q52.7369 820.608 56.3653 817.457 Q59.9619 814.306 59.9619 808.609 Q59.9619 806.062 59.2935 803.58 Q58.5933 801.065 57.2247 798.583 L62.6355 798.583 Q63.7814 801.033 64.3543 803.675 Q64.9272 806.285 64.9272 809.245 Q64.9272 817.298 59.8664 822.04 Q54.8057 826.783 46.212 826.783 Q37.491 826.783 32.4939 822.008 Q27.4968 817.202 27.4968 808.863 Q27.4968 806.158 28.0697 803.58 Q28.6108 801.002 29.7248 798.583 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M18.2347 782.605 L28.3562 782.605 L28.3562 770.542 L32.9077 770.542 L32.9077 782.605 L52.2594 782.605 Q56.6199 782.605 57.8613 781.427 Q59.1026 780.218 59.1026 776.557 L59.1026 770.542 L64.0042 770.542 L64.0042 776.557 Q64.0042 783.337 61.4897 785.915 Q58.9434 788.493 52.2594 788.493 L32.9077 788.493 L32.9077 792.79 L28.3562 792.79 L28.3562 788.493 L18.2347 788.493 L18.2347 782.605 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M28.3562 762.839 L28.3562 756.983 L64.0042 756.983 L64.0042 762.839 L28.3562 762.839 M14.479 762.839 L14.479 756.983 L21.895 756.983 L21.895 762.839 L14.479 762.839 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M32.4621 730.915 Q32.4621 735.626 36.1542 738.363 Q39.8145 741.1 46.212 741.1 Q52.6095 741.1 56.3017 738.395 Q59.9619 735.658 59.9619 730.915 Q59.9619 726.236 56.2698 723.499 Q52.5777 720.762 46.212 720.762 Q39.8781 720.762 36.186 723.499 Q32.4621 726.236 32.4621 730.915 M27.4968 730.915 Q27.4968 723.276 32.4621 718.916 Q37.4273 714.555 46.212 714.555 Q54.9649 714.555 59.9619 718.916 Q64.9272 723.276 64.9272 730.915 Q64.9272 738.586 59.9619 742.946 Q54.9649 747.275 46.212 747.275 Q37.4273 747.275 32.4621 742.946 Q27.4968 738.586 27.4968 730.915 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M42.4881 675.215 L64.0042 675.215 L64.0042 681.072 L42.679 681.072 Q37.6183 681.072 35.1038 683.045 Q32.5894 685.018 32.5894 688.965 Q32.5894 693.708 35.6131 696.445 Q38.6368 699.182 43.8567 699.182 L64.0042 699.182 L64.0042 705.07 L28.3562 705.07 L28.3562 699.182 L33.8944 699.182 Q30.6797 697.081 29.0883 694.249 Q27.4968 691.384 27.4968 687.66 Q27.4968 681.517 31.3163 678.366 Q35.1038 675.215 42.4881 675.215 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M14.479 643.037 L14.479 637.148 L43.7294 637.148 L28.3562 619.674 L28.3562 612.195 L45.0344 631.101 L64.0042 611.399 L64.0042 619.038 L46.5939 637.148 L64.0042 637.148 L64.0042 643.037 L14.479 643.037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M44.7161 576.897 L47.5806 576.897 L47.5806 603.824 Q53.6281 603.442 56.8109 600.195 Q59.9619 596.917 59.9619 591.092 Q59.9619 587.719 59.1344 584.568 Q58.3069 581.385 56.6518 578.265 L62.1899 578.265 Q63.5267 581.416 64.227 584.727 Q64.9272 588.037 64.9272 591.442 Q64.9272 599.973 59.9619 604.97 Q54.9967 609.935 46.5303 609.935 Q37.7774 609.935 32.6531 605.224 Q27.4968 600.482 27.4968 592.461 Q27.4968 585.268 32.1438 581.098 Q36.7589 576.897 44.7161 576.897 M42.9973 582.753 Q38.1912 582.817 35.3266 585.459 Q32.4621 588.069 32.4621 592.397 Q32.4621 597.299 35.2312 600.259 Q38.0002 603.187 43.0292 603.633 L42.9973 582.753 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M33.8307 546.628 Q33.2578 547.615 33.0032 548.792 Q32.7167 549.938 32.7167 551.339 Q32.7167 556.304 35.9632 558.977 Q39.1779 561.619 45.2253 561.619 L64.0042 561.619 L64.0042 567.507 L28.3562 567.507 L28.3562 561.619 L33.8944 561.619 Q30.6479 559.773 29.0883 556.813 Q27.4968 553.853 27.4968 549.62 Q27.4968 549.015 27.5923 548.283 Q27.656 547.551 27.8151 546.66 L33.8307 546.628 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M42.4881 511.998 L64.0042 511.998 L64.0042 517.855 L42.679 517.855 Q37.6183 517.855 35.1038 519.828 Q32.5894 521.802 32.5894 525.748 Q32.5894 530.491 35.6131 533.228 Q38.6368 535.965 43.8567 535.965 L64.0042 535.965 L64.0042 541.854 L28.3562 541.854 L28.3562 535.965 L33.8944 535.965 Q30.6797 533.865 29.0883 531.032 Q27.4968 528.167 27.4968 524.443 Q27.4968 518.301 31.3163 515.149 Q35.1038 511.998 42.4881 511.998 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M44.7161 469.826 L47.5806 469.826 L47.5806 496.753 Q53.6281 496.371 56.8109 493.124 Q59.9619 489.846 59.9619 484.021 Q59.9619 480.647 59.1344 477.496 Q58.3069 474.313 56.6518 471.194 L62.1899 471.194 Q63.5267 474.345 64.227 477.655 Q64.9272 480.966 64.9272 484.371 Q64.9272 492.901 59.9619 497.898 Q54.9967 502.864 46.5303 502.864 Q37.7774 502.864 32.6531 498.153 Q27.4968 493.411 27.4968 485.39 Q27.4968 478.197 32.1438 474.027 Q36.7589 469.826 44.7161 469.826 M42.9973 475.682 Q38.1912 475.746 35.3266 478.388 Q32.4621 480.997 32.4621 485.326 Q32.4621 490.228 35.2312 493.188 Q38.0002 496.116 43.0292 496.562 L42.9973 475.682 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M14.479 460.213 L14.479 454.357 L64.0042 454.357 L64.0042 460.213 L14.479 460.213 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip202)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  280.231,1384.24 293.735,1384.24 307.24,1384.24 320.744,1384.24 334.249,1384.24 347.753,1384.24 361.258,1384.24 374.762,1384.24 388.267,1384.24 401.771,1384.24 
  415.275,1384.24 428.78,1384.24 442.284,1384.24 455.789,1384.24 469.293,1384.24 482.798,1384.24 496.302,1384.24 509.806,1384.24 523.311,1384.24 536.815,1384.24 
  550.32,1384.24 563.824,1384.24 577.329,1384.24 590.833,1384.24 604.337,1384.24 617.842,1384.24 631.346,1384.24 644.851,1384.24 658.355,1384.24 671.86,1384.24 
  685.364,1384.24 698.868,1384.24 712.373,1384.24 725.877,1384.24 739.382,1384.24 752.886,1384.24 766.391,1384.24 779.895,1384.24 793.399,1384.24 806.904,1384.24 
  820.408,1384.24 833.913,1384.24 847.417,1384.24 860.922,1384.24 874.426,1316.64 887.93,982.171 901.435,720.617 914.939,520.143 928.444,370.616 941.948,263.382 
  955.453,191.058 968.957,147.362 982.461,126.962 995.966,125.341 1009.47,138.688 1022.97,163.792 1036.48,197.965 1049.98,238.957 1063.49,284.901 1076.99,334.253 
  1090.5,385.744 1104,438.338 1117.51,491.199 1131.01,543.657 1144.51,595.186 1158.02,645.376 1171.52,693.916 1185.03,740.578 1198.53,785.204 1212.04,827.689 
  1225.54,867.977 1239.05,906.048 1252.55,941.911 1266.05,975.599 1279.56,1007.17 1293.06,1036.68 1306.57,1064.21 1320.07,1089.84 1333.58,1113.67 1347.08,1135.78 
  1360.59,1156.27 1374.09,1175.23 1387.59,1192.75 1401.1,1208.92 1414.6,1223.83 1428.11,1237.56 1441.61,1250.2 1455.12,1261.82 1468.62,1272.49 1482.13,1282.28 
  1495.63,1291.26 1509.13,1299.49 1522.64,1307.03 1536.14,1313.92 1549.65,1320.23 1563.15,1325.99 1576.66,1331.26 1590.16,1336.06 1603.67,1340.45 1617.17,1344.45 
  1630.67,1348.1 1644.18,1351.42 1657.68,1354.45 1671.19,1357.2 1684.69,1359.71 1698.2,1361.99 1711.7,1364.07 1725.21,1365.95 1738.71,1367.66 1752.21,1369.22 
  1765.72,1370.63 1779.22,1371.92 1792.73,1373.08 1806.23,1374.14 1819.74,1375.1 1833.24,1375.97 1846.74,1376.76 1860.25,1377.47 1873.75,1378.12 1887.26,1378.7 
  1900.76,1379.23 1914.27,1379.72 1927.77,1380.15 1941.28,1380.55 1954.78,1380.9 1968.28,1381.22 1981.79,1381.52 1995.29,1381.78 2008.8,1382.02 2022.3,1382.23 
  2035.81,1382.43 2049.31,1382.61 2062.82,1382.77 2076.32,1382.91 2089.82,1383.04 2103.33,1383.16 2116.83,1383.26 2130.34,1383.36 2143.84,1383.44 2157.35,1383.52 
  2170.85,1383.59 2184.36,1383.66 2197.86,1383.71 2211.36,1383.77 2224.87,1383.81 2238.37,1383.85 2251.88,1383.89 2265.38,1383.93 2278.89,1383.96 2292.39,1383.99 
  
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none" stroke-dasharray="32, 20" points="
  280.231,123.993 293.735,123.993 307.24,123.993 320.744,123.993 334.249,123.993 347.753,123.993 361.258,123.993 374.762,123.993 388.267,123.993 401.771,123.993 
  415.275,123.993 428.78,123.993 442.284,123.993 455.789,123.993 469.293,123.993 482.798,123.993 496.302,123.993 509.806,123.993 523.311,123.993 536.815,123.993 
  550.32,123.993 563.824,123.993 577.329,123.993 590.833,123.993 604.337,123.993 617.842,123.993 631.346,123.993 644.851,123.993 658.355,123.993 671.86,123.993 
  685.364,123.993 698.868,123.993 712.373,123.993 725.877,123.993 739.382,123.993 752.886,123.993 766.391,123.993 779.895,123.993 793.399,123.993 806.904,123.993 
  820.408,123.993 833.913,123.993 847.417,123.993 860.922,123.993 874.426,123.993 887.93,123.993 901.435,123.993 914.939,123.993 928.444,123.993 941.948,123.993 
  955.453,123.993 968.957,123.993 982.461,123.993 995.966,125.341 1009.47,138.688 1022.97,163.792 1036.48,197.965 1049.98,238.957 1063.49,284.901 1076.99,334.253 
  1090.5,385.744 1104,438.338 1117.51,491.199 1131.01,543.657 1144.51,595.186 1158.02,645.376 1171.52,693.916 1185.03,740.578 1198.53,785.204 1212.04,827.689 
  1225.54,867.977 1239.05,906.048 1252.55,941.911 1266.05,975.599 1279.56,1007.17 1293.06,1036.68 1306.57,1064.21 1320.07,1089.84 1333.58,1113.67 1347.08,1135.78 
  1360.59,1156.27 1374.09,1175.23 1387.59,1192.75 1401.1,1208.92 1414.6,1223.83 1428.11,1237.56 1441.61,1250.2 1455.12,1261.82 1468.62,1272.49 1482.13,1282.28 
  1495.63,1291.26 1509.13,1299.49 1522.64,1307.03 1536.14,1313.92 1549.65,1320.23 1563.15,1325.99 1576.66,1331.26 1590.16,1336.06 1603.67,1340.45 1617.17,1344.45 
  1630.67,1348.1 1644.18,1351.42 1657.68,1354.45 1671.19,1357.2 1684.69,1359.71 1698.2,1361.99 1711.7,1364.07 1725.21,1365.95 1738.71,1367.66 1752.21,1369.22 
  1765.72,1370.63 1779.22,1371.92 1792.73,1373.08 1806.23,1374.14 1819.74,1375.1 1833.24,1375.97 1846.74,1376.76 1860.25,1377.47 1873.75,1378.12 1887.26,1378.7 
  1900.76,1379.23 1914.27,1379.72 1927.77,1380.15 1941.28,1380.55 1954.78,1380.9 1968.28,1381.22 1981.79,1381.52 1995.29,1381.78 2008.8,1382.02 2022.3,1382.23 
  2035.81,1382.43 2049.31,1382.61 2062.82,1382.77 2076.32,1382.91 2089.82,1383.04 2103.33,1383.16 2116.83,1383.26 2130.34,1383.36 2143.84,1383.44 2157.35,1383.52 
  2170.85,1383.59 2184.36,1383.66 2197.86,1383.71 2211.36,1383.77 2224.87,1383.81 2238.37,1383.85 2251.88,1383.89 2265.38,1383.93 2278.89,1383.96 2292.39,1383.99 
  
  "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" stroke-dasharray="16, 10" points="
  398.593,1384.24 398.593,86.1857 
  "/>
<path clip-path="url(#clip200)" d="
M1791.59 248.629 L2281.66 248.629 L2281.66 93.1086 L1791.59 93.1086  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1791.59,248.629 2281.66,248.629 2281.66,93.1086 1791.59,93.1086 1791.59,248.629 
  "/>
<polyline clip-path="url(#clip200)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1815.29,144.949 1957.49,144.949 
  "/>
<path clip-path="url(#clip200)" d="M1988.59 128.942 L1988.59 136.303 L1997.37 136.303 L1997.37 139.613 L1988.59 139.613 L1988.59 153.687 Q1988.59 156.858 1989.45 157.761 Q1990.33 158.664 1992.99 158.664 L1997.37 158.664 L1997.37 162.229 L1992.99 162.229 Q1988.06 162.229 1986.18 160.4 Q1984.31 158.548 1984.31 153.687 L1984.31 139.613 L1981.18 139.613 L1981.18 136.303 L1984.31 136.303 L1984.31 128.942 L1988.59 128.942 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2017.99 140.284 Q2017.27 139.868 2016.42 139.682 Q2015.58 139.474 2014.56 139.474 Q2010.95 139.474 2009.01 141.835 Q2007.09 144.173 2007.09 148.571 L2007.09 162.229 L2002.8 162.229 L2002.8 136.303 L2007.09 136.303 L2007.09 140.331 Q2008.43 137.969 2010.58 136.835 Q2012.74 135.678 2015.81 135.678 Q2016.25 135.678 2016.79 135.747 Q2017.32 135.794 2017.97 135.909 L2017.99 140.284 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2022.02 151.997 L2022.02 136.303 L2026.28 136.303 L2026.28 151.835 Q2026.28 155.516 2027.71 157.368 Q2029.15 159.196 2032.02 159.196 Q2035.47 159.196 2037.46 156.997 Q2039.47 154.798 2039.47 151.002 L2039.47 136.303 L2043.73 136.303 L2043.73 162.229 L2039.47 162.229 L2039.47 158.247 Q2037.92 160.608 2035.86 161.766 Q2033.82 162.9 2031.11 162.9 Q2026.65 162.9 2024.33 160.122 Q2022.02 157.344 2022.02 151.997 M2032.74 135.678 L2032.74 135.678 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2074.68 148.201 L2074.68 150.284 L2055.1 150.284 Q2055.37 154.682 2057.74 156.997 Q2060.12 159.289 2064.36 159.289 Q2066.81 159.289 2069.1 158.687 Q2071.42 158.085 2073.68 156.881 L2073.68 160.909 Q2071.39 161.881 2068.99 162.391 Q2066.58 162.9 2064.1 162.9 Q2057.9 162.9 2054.26 159.289 Q2050.65 155.678 2050.65 149.52 Q2050.65 143.155 2054.08 139.428 Q2057.53 135.678 2063.36 135.678 Q2068.59 135.678 2071.62 139.057 Q2074.68 142.414 2074.68 148.201 M2070.42 146.951 Q2070.37 143.456 2068.45 141.372 Q2066.55 139.289 2063.41 139.289 Q2059.84 139.289 2057.69 141.303 Q2055.56 143.317 2055.24 146.974 L2070.42 146.951 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2096.58 126.21 L2100.86 126.21 L2100.86 147.483 L2113.57 136.303 L2119.01 136.303 L2105.26 148.432 L2119.59 162.229 L2114.03 162.229 L2100.86 149.567 L2100.86 162.229 L2096.58 162.229 L2096.58 126.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2144.68 148.201 L2144.68 150.284 L2125.1 150.284 Q2125.37 154.682 2127.73 156.997 Q2130.12 159.289 2134.36 159.289 Q2136.81 159.289 2139.1 158.687 Q2141.42 158.085 2143.68 156.881 L2143.68 160.909 Q2141.39 161.881 2138.98 162.391 Q2136.58 162.9 2134.1 162.9 Q2127.9 162.9 2124.26 159.289 Q2120.65 155.678 2120.65 149.52 Q2120.65 143.155 2124.08 139.428 Q2127.53 135.678 2133.36 135.678 Q2138.59 135.678 2141.62 139.057 Q2144.68 142.414 2144.68 148.201 M2140.42 146.951 Q2140.37 143.456 2138.45 141.372 Q2136.55 139.289 2133.41 139.289 Q2129.84 139.289 2127.69 141.303 Q2125.56 143.317 2125.23 146.974 L2140.42 146.951 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2166.69 140.284 Q2165.98 139.868 2165.12 139.682 Q2164.29 139.474 2163.27 139.474 Q2159.66 139.474 2157.71 141.835 Q2155.79 144.173 2155.79 148.571 L2155.79 162.229 L2151.51 162.229 L2151.51 136.303 L2155.79 136.303 L2155.79 140.331 Q2157.13 137.969 2159.29 136.835 Q2161.44 135.678 2164.52 135.678 Q2164.96 135.678 2165.49 135.747 Q2166.02 135.794 2166.67 135.909 L2166.69 140.284 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2191.88 146.581 L2191.88 162.229 L2187.62 162.229 L2187.62 146.719 Q2187.62 143.039 2186.18 141.21 Q2184.75 139.382 2181.88 139.382 Q2178.43 139.382 2176.44 141.581 Q2174.45 143.78 2174.45 147.576 L2174.45 162.229 L2170.17 162.229 L2170.17 136.303 L2174.45 136.303 L2174.45 140.331 Q2175.98 137.993 2178.04 136.835 Q2180.12 135.678 2182.83 135.678 Q2187.29 135.678 2189.59 138.456 Q2191.88 141.21 2191.88 146.581 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2222.55 148.201 L2222.55 150.284 L2202.97 150.284 Q2203.24 154.682 2205.6 156.997 Q2207.99 159.289 2212.23 159.289 Q2214.68 159.289 2216.97 158.687 Q2219.29 158.085 2221.55 156.881 L2221.55 160.909 Q2219.26 161.881 2216.85 162.391 Q2214.45 162.9 2211.97 162.9 Q2205.77 162.9 2202.13 159.289 Q2198.52 155.678 2198.52 149.52 Q2198.52 143.155 2201.95 139.428 Q2205.4 135.678 2211.23 135.678 Q2216.46 135.678 2219.49 139.057 Q2222.55 142.414 2222.55 148.201 M2218.29 146.951 Q2218.24 143.456 2216.32 141.372 Q2214.42 139.289 2211.28 139.289 Q2207.71 139.289 2205.56 141.303 Q2203.43 143.317 2203.1 146.974 L2218.29 146.951 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2229.54 126.21 L2233.8 126.21 L2233.8 162.229 L2229.54 162.229 L2229.54 126.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip200)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" stroke-dasharray="16, 10" points="
  1815.29,196.789 1957.49,196.789 
  "/>
<path clip-path="url(#clip200)" d="M1981.18 203.837 L1981.18 188.143 L1985.44 188.143 L1985.44 203.675 Q1985.44 207.356 1986.88 209.208 Q1988.31 211.036 1991.18 211.036 Q1994.63 211.036 1996.62 208.837 Q1998.64 206.638 1998.64 202.842 L1998.64 188.143 L2002.9 188.143 L2002.9 214.069 L1998.64 214.069 L1998.64 210.087 Q1997.09 212.448 1995.03 213.606 Q1992.99 214.74 1990.28 214.74 Q1985.81 214.74 1983.5 211.962 Q1981.18 209.184 1981.18 203.837 M1991.9 187.518 L1991.9 187.518 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2015.79 210.18 L2015.79 223.93 L2011.51 223.93 L2011.51 188.143 L2015.79 188.143 L2015.79 192.078 Q2017.13 189.763 2019.17 188.652 Q2021.23 187.518 2024.08 187.518 Q2028.8 187.518 2031.74 191.268 Q2034.7 195.018 2034.7 201.129 Q2034.7 207.24 2031.74 210.99 Q2028.8 214.74 2024.08 214.74 Q2021.23 214.74 2019.17 213.629 Q2017.13 212.495 2015.79 210.18 M2030.28 201.129 Q2030.28 196.43 2028.34 193.768 Q2026.42 191.083 2023.04 191.083 Q2019.66 191.083 2017.71 193.768 Q2015.79 196.43 2015.79 201.129 Q2015.79 205.828 2017.71 208.513 Q2019.66 211.175 2023.04 211.175 Q2026.42 211.175 2028.34 208.513 Q2030.28 205.828 2030.28 201.129 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2045.88 210.18 L2045.88 223.93 L2041.6 223.93 L2041.6 188.143 L2045.88 188.143 L2045.88 192.078 Q2047.23 189.763 2049.26 188.652 Q2051.32 187.518 2054.17 187.518 Q2058.89 187.518 2061.83 191.268 Q2064.8 195.018 2064.8 201.129 Q2064.8 207.24 2061.83 210.99 Q2058.89 214.74 2054.17 214.74 Q2051.32 214.74 2049.26 213.629 Q2047.23 212.495 2045.88 210.18 M2060.37 201.129 Q2060.37 196.43 2058.43 193.768 Q2056.51 191.083 2053.13 191.083 Q2049.75 191.083 2047.8 193.768 Q2045.88 196.43 2045.88 201.129 Q2045.88 205.828 2047.8 208.513 Q2049.75 211.175 2053.13 211.175 Q2056.51 211.175 2058.43 208.513 Q2060.37 205.828 2060.37 201.129 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2094.03 200.041 L2094.03 202.124 L2074.45 202.124 Q2074.73 206.522 2077.09 208.837 Q2079.47 211.129 2083.71 211.129 Q2086.16 211.129 2088.45 210.527 Q2090.77 209.925 2093.04 208.721 L2093.04 212.749 Q2090.74 213.721 2088.34 214.231 Q2085.93 214.74 2083.45 214.74 Q2077.25 214.74 2073.61 211.129 Q2070 207.518 2070 201.36 Q2070 194.995 2073.43 191.268 Q2076.88 187.518 2082.71 187.518 Q2087.94 187.518 2090.98 190.897 Q2094.03 194.254 2094.03 200.041 M2089.77 198.791 Q2089.73 195.296 2087.8 193.212 Q2085.91 191.129 2082.76 191.129 Q2079.19 191.129 2077.04 193.143 Q2074.91 195.157 2074.59 198.814 L2089.77 198.791 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2116.05 192.124 Q2115.33 191.708 2114.47 191.522 Q2113.64 191.314 2112.62 191.314 Q2109.01 191.314 2107.06 193.675 Q2105.14 196.013 2105.14 200.411 L2105.14 214.069 L2100.86 214.069 L2100.86 188.143 L2105.14 188.143 L2105.14 192.171 Q2106.48 189.809 2108.64 188.675 Q2110.79 187.518 2113.87 187.518 Q2114.31 187.518 2114.84 187.587 Q2115.37 187.634 2116.02 187.749 L2116.05 192.124 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2135.58 178.05 L2139.84 178.05 L2139.84 214.069 L2135.58 214.069 L2135.58 178.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2148.75 188.143 L2153.01 188.143 L2153.01 214.069 L2148.75 214.069 L2148.75 188.143 M2148.75 178.05 L2153.01 178.05 L2153.01 183.444 L2148.75 183.444 L2148.75 178.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2182.11 193.12 Q2183.71 190.249 2185.93 188.884 Q2188.15 187.518 2191.16 187.518 Q2195.21 187.518 2197.41 190.365 Q2199.61 193.189 2199.61 198.421 L2199.61 214.069 L2195.33 214.069 L2195.33 198.559 Q2195.33 194.833 2194.01 193.027 Q2192.69 191.222 2189.98 191.222 Q2186.67 191.222 2184.75 193.421 Q2182.83 195.62 2182.83 199.416 L2182.83 214.069 L2178.54 214.069 L2178.54 198.559 Q2178.54 194.809 2177.23 193.027 Q2175.91 191.222 2173.15 191.222 Q2169.89 191.222 2167.97 193.444 Q2166.04 195.643 2166.04 199.416 L2166.04 214.069 L2161.76 214.069 L2161.76 188.143 L2166.04 188.143 L2166.04 192.171 Q2167.5 189.786 2169.54 188.652 Q2171.58 187.518 2174.38 187.518 Q2177.2 187.518 2179.17 188.953 Q2181.16 190.388 2182.11 193.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2208.1 188.143 L2212.36 188.143 L2212.36 214.069 L2208.1 214.069 L2208.1 188.143 M2208.1 178.05 L2212.36 178.05 L2212.36 183.444 L2208.1 183.444 L2208.1 178.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2225.49 180.782 L2225.49 188.143 L2234.26 188.143 L2234.26 191.453 L2225.49 191.453 L2225.49 205.527 Q2225.49 208.698 2226.35 209.601 Q2227.23 210.504 2229.89 210.504 L2234.26 210.504 L2234.26 214.069 L2229.89 214.069 Q2224.96 214.069 2223.08 212.24 Q2221.21 210.388 2221.21 205.527 L2221.21 191.453 L2218.08 191.453 L2218.08 188.143 L2221.21 188.143 L2221.21 180.782 L2225.49 180.782 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>the closer the upper limit is to the true kernel, the more efficient the simulation.</p><h2 id="Build-the-network-and-run-it"><a class="docs-heading-anchor" href="#Build-the-network-and-run-it">Build the network and run it</a><a id="Build-the-network-and-run-it-1"></a><a class="docs-heading-anchor-permalink" href="#Build-the-network-and-run-it" title="Permalink"></a></h2><p>I compare the final rate with what I expect from the analytic solution (see first example file)</p><pre><code class="language-julia hljs">pops = H.PopulationState(ker,1)
ntw = H.RecurrentNetwork(pops,myw,myinput)

function run_simulation!(network,num_spikes,
    t_flush_trigger=300.0,t_flush=100.0)
  t_now = 0.0
  H.reset!(network) # clear spike trains etc
  @showprogress &quot;Running Hawkes process...&quot; for _ in 1:num_spikes
    t_now = H.dynamics_step!(t_now,network)
    H.flush_trains!(network,t_flush_trigger;Tflush=t_flush)
  end
  H.flush_trains!(network) # flush everything into history
  return t_now
end

n_spikes = 80_000
Tmax = run_simulation!(ntw,n_spikes);

ratenum = H.numerical_rates(pops)[1]
rate_analytic = (I-myw)\myinput

@info &quot;Mean rate -  numerical $(round(ratenum;digits=2)), analytic  $(round(ratefou;digits=2))&quot;

#</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Running Hawkes process...  6%|█▌                        |  ETA: 0:00:02Running Hawkes process...100%|██████████████████████████| Time: 0:00:02
┌ Error: Exception while generating log record in module Main at alphadelay.md:103
│   exception =
│    UndefVarError: ratefou not defined
│    Stacktrace:
│      [1] top-level scope
│        @ logging.jl:340
│      [2] eval
│        @ ./boot.jl:360 [inlined]
│      [3] #16
│        @ ~/.julia/packages/Documenter/qdbx6/src/Expanders.jl:583 [inlined]
│      [4] cd(f::Documenter.Expanders.var&quot;#16#18&quot;{Module, Expr}, dir::String)
│        @ Base.Filesystem ./file.jl:106
│      [5] (::Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr})()
│        @ Documenter.Expanders ~/.julia/packages/Documenter/qdbx6/src/Expanders.jl:582
│      [6] (::IOCapture.var&quot;#3#5&quot;{DataType, Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr}, Task, IOContext{Base.PipeEndpoint}, IOContext{Base.PipeEndpoint}, Base.PipeEndpoint, Base.PipeEndpoint})()
│        @ IOCapture ~/.julia/packages/IOCapture/sXY71/src/IOCapture.jl:118
│      [7] with_logstate(f::Function, logstate::Any)
│        @ Base.CoreLogging ./logging.jl:491
│      [8] with_logger
│        @ ./logging.jl:603 [inlined]
│      [9] capture(f::Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr}; rethrow::Type, color::Bool)
│        @ IOCapture ~/.julia/packages/IOCapture/sXY71/src/IOCapture.jl:116
│     [10] runner(#unused#::Type{Documenter.Expanders.ExampleBlocks}, x::Markdown.Code, page::Documenter.Documents.Page, doc::Documenter.Documents.Document)
│        @ Documenter.Expanders ~/.julia/packages/Documenter/qdbx6/src/Expanders.jl:581
│     [11] dispatch(::Type{Documenter.Expanders.ExpanderPipeline}, ::Markdown.Code, ::Vararg{Any, N} where N)
│        @ Documenter.Utilities.Selectors ~/.julia/packages/Documenter/qdbx6/src/Utilities/Selectors.jl:170
│     [12] expand(doc::Documenter.Documents.Document)
│        @ Documenter.Expanders ~/.julia/packages/Documenter/qdbx6/src/Expanders.jl:42
│     [13] runner(#unused#::Type{Documenter.Builder.ExpandTemplates}, doc::Documenter.Documents.Document)
│        @ Documenter.Builder ~/.julia/packages/Documenter/qdbx6/src/Builder.jl:226
│     [14] dispatch(#unused#::Type{Documenter.Builder.DocumentPipeline}, x::Documenter.Documents.Document)
│        @ Documenter.Utilities.Selectors ~/.julia/packages/Documenter/qdbx6/src/Utilities/Selectors.jl:170
│     [15] #2
│        @ ~/.julia/packages/Documenter/qdbx6/src/Documenter.jl:266 [inlined]
│     [16] cd(f::Documenter.var&quot;#2#3&quot;{Documenter.Documents.Document}, dir::String)
│        @ Base.Filesystem ./file.jl:106
│     [17] #makedocs#1
│        @ ~/.julia/packages/Documenter/qdbx6/src/Documenter.jl:265 [inlined]
│     [18] top-level scope
│        @ ~/work/HawkesSimulator.jl/HawkesSimulator.jl/docs/make.jl:9
│     [19] include(mod::Module, _path::String)
│        @ Base ./Base.jl:386
│     [20] exec_options(opts::Base.JLOptions)
│        @ Base ./client.jl:285
│     [21] _start()
│        @ Base ./client.jl:485
└ @ Main alphadelay.md:103</code></pre><h2 id="Covariance-density"><a class="docs-heading-anchor" href="#Covariance-density">Covariance density</a><a id="Covariance-density-1"></a><a class="docs-heading-anchor-permalink" href="#Covariance-density" title="Permalink"></a></h2><p>First, compute covariance density numerically for a reasonable time step</p><pre><code class="language-julia hljs">mytrain = pops.trains_history[1]
mydt = 0.1
myτmax = 60.0
mytaus = H.get_times(mydt,myτmax)
ntaus = length(mytaus)
cov_num = H.covariance_self_numerical(mytrain,mydt,myτmax);</code></pre><p>now compute covariance density  analytically (as in Hawkes models), at higher resolution, and compare analytic and numeric</p><p>Note that the high resolution is not just for a better plot, but also to ensure the result is more precise when we move from frequency domain (Fourier transforms) to time domain.</p><pre><code class="language- hljs">function four_high_res(dt::Real,Tmax::Real) # higher time resolution, longer time
  k1,k2 = 2 , 0.01
  myτmax = Tmax * k1
  dt *= k2
  mytaus = H.get_times(dt,myτmax)
  nkeep = div(length(mytaus),k1)
  myfreq = H.get_frequencies_centerzero(dt,myτmax)
  gfou = myw[1,1] .* H.interaction_kernel_fourier.(myfreq,Ref(ker)) |&gt; ifftshift
  ffou = let r=ratefou
    covf(g) = r/((1-g)*(1-g&#39;))
    map(covf,gfou)
  end
  retf = real.(ifft(ffou))
  retf[2:end] ./= dt # first element is rate
  return mytaus[1:nkeep],retf[1:nkeep]
end

taush,covfou=four_high_res(mydt,myτmax)

plt= let plt = plot(xlabel=&quot;time delay (s)&quot;,ylabel=&quot;Covariance density&quot;)
  plot!(plt,mytaus[2:end], cov_num[2:end] ; linewidth=3, label=&quot;numerical&quot; )
  plot!(plt,taush[2:end],covfou[2:end]; label=&quot;analytic&quot;,linewidth=3,linestyle=:dash)
end;

plot(plt)</code></pre><p>Analytics and numerics match quite well.</p><p><strong>THE END</strong></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 18 November 2021 16:57">Thursday 18 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
