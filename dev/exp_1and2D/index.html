<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1D and 2D Hawkes processes with exponential kernel · HawkesSimulator.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://dylanfesta.github.io/HawkesSimulator.jl/exp_1and2D/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">HawkesSimulator.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>1D and 2D Hawkes processes with exponential kernel</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1D and 2D Hawkes processes with exponential kernel</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/dylanfesta/HawkesSimulator.jl/blob/master/examples/exp_1and2D.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="D-and-2D-Hawkes-processes-with-exponential-kernel"><a class="docs-heading-anchor" href="#D-and-2D-Hawkes-processes-with-exponential-kernel">1D and 2D Hawkes processes with exponential kernel</a><a id="D-and-2D-Hawkes-processes-with-exponential-kernel-1"></a><a class="docs-heading-anchor-permalink" href="#D-and-2D-Hawkes-processes-with-exponential-kernel" title="Permalink"></a></h1><p>In this example, I simulate first a 1D self-exciting Hawkes process and then a 2D one. The interaction kernel is an exponentially decaying function, defined as:</p><p class="math-container">\[g(t) = H(t) \,  \frac{1}{\tau} \, \exp\left(- \frac{t}{\tau} \right)\]</p><p>where <span>$H(t)$</span> is the Heaviside function: zero for <span>$t&lt;0$</span>, one for <span>$t\geq 0$</span>.</p><p>Note that Kernels are always normalized so that their integral between <span>$-\infty$</span> and <span>$+\infty$</span> is 1.</p><h2 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h2><pre><code class="language-julia hljs">using LinearAlgebra,Statistics,StatsBase,Distributions
using Plots,NamedColors ; theme(:default) ; gr()
using FFTW

using ProgressMeter
using Random
Random.seed!(0)

using HawkesSimulator; const global H = HawkesSimulator

&quot;&quot;&quot;
    onedmat(x::R) where R
Generates a 1-by-1 Matrix{R} that contains `x` as only element
&quot;&quot;&quot;
function onedmat(x::R) where R
  ret=Matrix{R}(undef,1,1)
  ret[1,1] = x
  return ret
end;

#</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Main.onedmat</code></pre><p>First I define the kernel, and the self-interaction weight. The kernel is defined through a &quot;Population&quot;: all neurons in the same population have the same kernel.</p><p><code>myw</code> is a scaling factor (the weight of the autaptic connection). The baseline rate is given by <code>myinput</code></p><pre><code class="language-julia hljs">mytau = 0.5  # kernel time constant
myw = onedmat(0.85) # weight: this needs to be a matrix
myinput = [0.7,] # this needs to be a vector
pop = H.PopulationExp(mytau);</code></pre><p>This is the plot of the (self) interaction kernel (before  the scaling by <code>myw</code>)</p><pre><code class="language-julia hljs">function doplot() # Julia likes functions
  ts = range(-1.0,5;length=150)
  y = map(t-&gt;H.interaction_kernel(t,pop) , ts )
  plot(ts , y ; linewidth=3,leg=false,xlabel=&quot;time (s)&quot;,
      ylabel=&quot;interaction kernel&quot;)
end

doplot()</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip820">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip821">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="
M219.38 1423.18 L2352.76 1423.18 L2352.76 47.2441 L219.38 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip822">
    <rect x="219" y="47" width="2134" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  279.759,1423.18 279.759,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  615.195,1423.18 615.195,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  950.632,1423.18 950.632,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1286.07,1423.18 1286.07,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1621.5,1423.18 1621.5,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1956.94,1423.18 1956.94,47.2441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2292.38,1423.18 2292.38,47.2441 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.38,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  279.759,1423.18 279.759,1404.28 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  615.195,1423.18 615.195,1404.28 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  950.632,1423.18 950.632,1404.28 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1286.07,1423.18 1286.07,1404.28 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1621.5,1423.18 1621.5,1404.28 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1956.94,1423.18 1956.94,1404.28 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2292.38,1423.18 2292.38,1404.28 
  "/>
<path clip-path="url(#clip820)" d="M249.516 1467.02 L279.192 1467.02 L279.192 1470.96 L249.516 1470.96 L249.516 1467.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M290.094 1479.92 L297.733 1479.92 L297.733 1453.55 L289.423 1455.22 L289.423 1450.96 L297.687 1449.29 L302.363 1449.29 L302.363 1479.92 L310.002 1479.92 L310.002 1483.85 L290.094 1483.85 L290.094 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M615.195 1452.37 Q611.584 1452.37 609.755 1455.94 Q607.95 1459.48 607.95 1466.61 Q607.95 1473.71 609.755 1477.28 Q611.584 1480.82 615.195 1480.82 Q618.829 1480.82 620.635 1477.28 Q622.464 1473.71 622.464 1466.61 Q622.464 1459.48 620.635 1455.94 Q618.829 1452.37 615.195 1452.37 M615.195 1448.67 Q621.005 1448.67 624.061 1453.27 Q627.14 1457.86 627.14 1466.61 Q627.14 1475.33 624.061 1479.94 Q621.005 1484.52 615.195 1484.52 Q609.385 1484.52 606.306 1479.94 Q603.251 1475.33 603.251 1466.61 Q603.251 1457.86 606.306 1453.27 Q609.385 1448.67 615.195 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M941.014 1479.92 L948.652 1479.92 L948.652 1453.55 L940.342 1455.22 L940.342 1450.96 L948.606 1449.29 L953.282 1449.29 L953.282 1479.92 L960.921 1479.92 L960.921 1483.85 L941.014 1483.85 L941.014 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1280.72 1479.92 L1297.04 1479.92 L1297.04 1483.85 L1275.1 1483.85 L1275.1 1479.92 Q1277.76 1477.16 1282.34 1472.53 Q1286.95 1467.88 1288.13 1466.54 Q1290.37 1464.01 1291.25 1462.28 Q1292.16 1460.52 1292.16 1458.83 Q1292.16 1456.07 1290.21 1454.34 Q1288.29 1452.6 1285.19 1452.6 Q1282.99 1452.6 1280.54 1453.37 Q1278.11 1454.13 1275.33 1455.68 L1275.33 1450.96 Q1278.15 1449.82 1280.61 1449.25 Q1283.06 1448.67 1285.1 1448.67 Q1290.47 1448.67 1293.66 1451.35 Q1296.86 1454.04 1296.86 1458.53 Q1296.86 1460.66 1296.04 1462.58 Q1295.26 1464.48 1293.15 1467.07 Q1292.57 1467.74 1289.47 1470.96 Q1286.37 1474.15 1280.72 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1625.75 1465.22 Q1629.11 1465.94 1630.98 1468.2 Q1632.88 1470.47 1632.88 1473.81 Q1632.88 1478.92 1629.36 1481.72 Q1625.84 1484.52 1619.36 1484.52 Q1617.19 1484.52 1614.87 1484.08 Q1612.58 1483.67 1610.13 1482.81 L1610.13 1478.3 Q1612.07 1479.43 1614.39 1480.01 Q1616.7 1480.59 1619.22 1480.59 Q1623.62 1480.59 1625.91 1478.85 Q1628.23 1477.12 1628.23 1473.81 Q1628.23 1470.75 1626.08 1469.04 Q1623.95 1467.3 1620.13 1467.3 L1616.1 1467.3 L1616.1 1463.46 L1620.31 1463.46 Q1623.76 1463.46 1625.59 1462.09 Q1627.42 1460.7 1627.42 1458.11 Q1627.42 1455.45 1625.52 1454.04 Q1623.65 1452.6 1620.13 1452.6 Q1618.21 1452.6 1616.01 1453.02 Q1613.81 1453.44 1611.17 1454.31 L1611.17 1450.15 Q1613.83 1449.41 1616.15 1449.04 Q1618.48 1448.67 1620.54 1448.67 Q1625.87 1448.67 1628.97 1451.1 Q1632.07 1453.5 1632.07 1457.63 Q1632.07 1460.5 1630.43 1462.49 Q1628.78 1464.45 1625.75 1465.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1959.95 1453.37 L1948.14 1471.81 L1959.95 1471.81 L1959.95 1453.37 M1958.72 1449.29 L1964.6 1449.29 L1964.6 1471.81 L1969.53 1471.81 L1969.53 1475.7 L1964.6 1475.7 L1964.6 1483.85 L1959.95 1483.85 L1959.95 1475.7 L1944.35 1475.7 L1944.35 1471.19 L1958.72 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M2282.66 1449.29 L2301.01 1449.29 L2301.01 1453.23 L2286.94 1453.23 L2286.94 1461.7 Q2287.96 1461.35 2288.97 1461.19 Q2289.99 1461 2291.01 1461 Q2296.8 1461 2300.18 1464.18 Q2303.56 1467.35 2303.56 1472.76 Q2303.56 1478.34 2300.09 1481.44 Q2296.61 1484.52 2290.29 1484.52 Q2288.12 1484.52 2285.85 1484.15 Q2283.6 1483.78 2281.2 1483.04 L2281.2 1478.34 Q2283.28 1479.48 2285.5 1480.03 Q2287.72 1480.59 2290.2 1480.59 Q2294.21 1480.59 2296.54 1478.48 Q2298.88 1476.38 2298.88 1472.76 Q2298.88 1469.15 2296.54 1467.05 Q2294.21 1464.94 2290.2 1464.94 Q2288.33 1464.94 2286.45 1465.36 Q2284.6 1465.77 2282.66 1466.65 L2282.66 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1173.52 1522.27 L1173.52 1532.4 L1185.59 1532.4 L1185.59 1536.95 L1173.52 1536.95 L1173.52 1556.3 Q1173.52 1560.66 1174.7 1561.9 Q1175.91 1563.14 1179.57 1563.14 L1185.59 1563.14 L1185.59 1568.04 L1179.57 1568.04 Q1172.79 1568.04 1170.21 1565.53 Q1167.63 1562.98 1167.63 1556.3 L1167.63 1536.95 L1163.34 1536.95 L1163.34 1532.4 L1167.63 1532.4 L1167.63 1522.27 L1173.52 1522.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1193.29 1532.4 L1199.14 1532.4 L1199.14 1568.04 L1193.29 1568.04 L1193.29 1532.4 M1193.29 1518.52 L1199.14 1518.52 L1199.14 1525.93 L1193.29 1525.93 L1193.29 1518.52 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1239.15 1539.24 Q1241.35 1535.29 1244.4 1533.41 Q1247.46 1531.54 1251.6 1531.54 Q1257.17 1531.54 1260.19 1535.45 Q1263.22 1539.33 1263.22 1546.53 L1263.22 1568.04 L1257.33 1568.04 L1257.33 1546.72 Q1257.33 1541.59 1255.51 1539.11 Q1253.7 1536.63 1249.97 1536.63 Q1245.42 1536.63 1242.78 1539.65 Q1240.14 1542.68 1240.14 1547.9 L1240.14 1568.04 L1234.25 1568.04 L1234.25 1546.72 Q1234.25 1541.56 1232.44 1539.11 Q1230.62 1536.63 1226.84 1536.63 Q1222.35 1536.63 1219.71 1539.68 Q1217.06 1542.71 1217.06 1547.9 L1217.06 1568.04 L1211.18 1568.04 L1211.18 1532.4 L1217.06 1532.4 L1217.06 1537.93 Q1219.07 1534.66 1221.87 1533.1 Q1224.67 1531.54 1228.52 1531.54 Q1232.41 1531.54 1235.11 1533.51 Q1237.85 1535.48 1239.15 1539.24 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1305.39 1548.76 L1305.39 1551.62 L1278.46 1551.62 Q1278.84 1557.67 1282.09 1560.85 Q1285.37 1564 1291.19 1564 Q1294.57 1564 1297.72 1563.17 Q1300.9 1562.35 1304.02 1560.69 L1304.02 1566.23 Q1300.87 1567.57 1297.56 1568.27 Q1294.25 1568.97 1290.84 1568.97 Q1282.31 1568.97 1277.32 1564 Q1272.35 1559.04 1272.35 1550.57 Q1272.35 1541.82 1277.06 1536.69 Q1281.8 1531.54 1289.82 1531.54 Q1297.02 1531.54 1301.19 1536.18 Q1305.39 1540.8 1305.39 1548.76 M1299.53 1547.04 Q1299.47 1542.23 1296.83 1539.37 Q1294.22 1536.5 1289.89 1536.5 Q1284.99 1536.5 1282.03 1539.27 Q1279.1 1542.04 1278.65 1547.07 L1299.53 1547.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1349.79 1518.58 Q1345.52 1525.9 1343.45 1533.06 Q1341.39 1540.23 1341.39 1547.58 Q1341.39 1554.93 1343.45 1562.16 Q1345.56 1569.35 1349.79 1576.64 L1344.7 1576.64 Q1339.92 1569.16 1337.53 1561.93 Q1335.18 1554.71 1335.18 1547.58 Q1335.18 1540.48 1337.53 1533.29 Q1339.89 1526.09 1344.7 1518.58 L1349.79 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1383.88 1533.45 L1383.88 1538.98 Q1381.39 1537.71 1378.72 1537.07 Q1376.05 1536.44 1373.18 1536.44 Q1368.82 1536.44 1366.63 1537.77 Q1364.46 1539.11 1364.46 1541.79 Q1364.46 1543.82 1366.02 1545 Q1367.58 1546.15 1372.29 1547.2 L1374.3 1547.64 Q1380.54 1548.98 1383.15 1551.43 Q1385.79 1553.85 1385.79 1558.21 Q1385.79 1563.17 1381.84 1566.07 Q1377.93 1568.97 1371.05 1568.97 Q1368.19 1568.97 1365.07 1568.39 Q1361.98 1567.85 1358.54 1566.74 L1358.54 1560.69 Q1361.79 1562.38 1364.94 1563.24 Q1368.09 1564.07 1371.18 1564.07 Q1375.32 1564.07 1377.54 1562.66 Q1379.77 1561.23 1379.77 1558.65 Q1379.77 1556.27 1378.15 1554.99 Q1376.56 1553.72 1371.11 1552.54 L1369.08 1552.07 Q1363.63 1550.92 1361.22 1548.56 Q1358.8 1546.18 1358.8 1542.04 Q1358.8 1537.01 1362.36 1534.27 Q1365.93 1531.54 1372.48 1531.54 Q1375.73 1531.54 1378.59 1532.01 Q1381.46 1532.49 1383.88 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1394.19 1518.58 L1399.28 1518.58 Q1404.06 1526.09 1406.41 1533.29 Q1408.8 1540.48 1408.8 1547.58 Q1408.8 1554.71 1406.41 1561.93 Q1404.06 1569.16 1399.28 1576.64 L1394.19 1576.64 Q1398.42 1569.35 1400.49 1562.16 Q1402.59 1554.93 1402.59 1547.58 Q1402.59 1540.23 1400.49 1533.06 Q1398.42 1525.9 1394.19 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.38,1384.24 2352.76,1384.24 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.38,1055.34 2352.76,1055.34 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.38,726.441 2352.76,726.441 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.38,397.543 2352.76,397.543 
  "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  219.38,68.6447 2352.76,68.6447 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.38,1423.18 219.38,47.2441 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.38,1384.24 238.278,1384.24 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.38,1055.34 238.278,1055.34 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.38,726.441 238.278,726.441 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.38,397.543 238.278,397.543 
  "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  219.38,68.6447 238.278,68.6447 
  "/>
<path clip-path="url(#clip820)" d="M126.205 1370.04 Q122.593 1370.04 120.765 1373.6 Q118.959 1377.14 118.959 1384.27 Q118.959 1391.38 120.765 1394.94 Q122.593 1398.49 126.205 1398.49 Q129.839 1398.49 131.644 1394.94 Q133.473 1391.38 133.473 1384.27 Q133.473 1377.14 131.644 1373.6 Q129.839 1370.04 126.205 1370.04 M126.205 1366.33 Q132.015 1366.33 135.07 1370.94 Q138.149 1375.52 138.149 1384.27 Q138.149 1393 135.07 1397.61 Q132.015 1402.19 126.205 1402.19 Q120.394 1402.19 117.316 1397.61 Q114.26 1393 114.26 1384.27 Q114.26 1375.52 117.316 1370.94 Q120.394 1366.33 126.205 1366.33 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M146.366 1395.64 L151.251 1395.64 L151.251 1401.52 L146.366 1401.52 L146.366 1395.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M171.436 1370.04 Q167.825 1370.04 165.996 1373.6 Q164.19 1377.14 164.19 1384.27 Q164.19 1391.38 165.996 1394.94 Q167.825 1398.49 171.436 1398.49 Q175.07 1398.49 176.876 1394.94 Q178.704 1391.38 178.704 1384.27 Q178.704 1377.14 176.876 1373.6 Q175.07 1370.04 171.436 1370.04 M171.436 1366.33 Q177.246 1366.33 180.301 1370.94 Q183.38 1375.52 183.38 1384.27 Q183.38 1393 180.301 1397.61 Q177.246 1402.19 171.436 1402.19 Q165.626 1402.19 162.547 1397.61 Q159.491 1393 159.491 1384.27 Q159.491 1375.52 162.547 1370.94 Q165.626 1366.33 171.436 1366.33 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M127.2 1041.14 Q123.589 1041.14 121.76 1044.7 Q119.955 1048.25 119.955 1055.37 Q119.955 1062.48 121.76 1066.05 Q123.589 1069.59 127.2 1069.59 Q130.834 1069.59 132.64 1066.05 Q134.468 1062.48 134.468 1055.37 Q134.468 1048.25 132.64 1044.7 Q130.834 1041.14 127.2 1041.14 M127.2 1037.43 Q133.01 1037.43 136.066 1042.04 Q139.144 1046.62 139.144 1055.37 Q139.144 1064.1 136.066 1068.71 Q133.01 1073.29 127.2 1073.29 Q121.39 1073.29 118.311 1068.71 Q115.256 1064.1 115.256 1055.37 Q115.256 1046.62 118.311 1042.04 Q121.39 1037.43 127.2 1037.43 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M147.362 1066.74 L152.246 1066.74 L152.246 1072.62 L147.362 1072.62 L147.362 1066.74 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M162.477 1038.06 L180.834 1038.06 L180.834 1042 L166.76 1042 L166.76 1050.47 Q167.778 1050.12 168.797 1049.96 Q169.815 1049.77 170.834 1049.77 Q176.621 1049.77 180.001 1052.94 Q183.38 1056.12 183.38 1061.53 Q183.38 1067.11 179.908 1070.21 Q176.436 1073.29 170.116 1073.29 Q167.94 1073.29 165.672 1072.92 Q163.427 1072.55 161.019 1071.81 L161.019 1067.11 Q163.102 1068.24 165.325 1068.8 Q167.547 1069.36 170.024 1069.36 Q174.028 1069.36 176.366 1067.25 Q178.704 1065.14 178.704 1061.53 Q178.704 1057.92 176.366 1055.81 Q174.028 1053.71 170.024 1053.71 Q168.149 1053.71 166.274 1054.12 Q164.422 1054.54 162.477 1055.42 L162.477 1038.06 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M117.015 739.786 L124.654 739.786 L124.654 713.421 L116.343 715.087 L116.343 710.828 L124.607 709.161 L129.283 709.161 L129.283 739.786 L136.922 739.786 L136.922 743.721 L117.015 743.721 L117.015 739.786 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M146.366 737.842 L151.251 737.842 L151.251 743.721 L146.366 743.721 L146.366 737.842 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M171.436 712.24 Q167.825 712.24 165.996 715.805 Q164.19 719.347 164.19 726.476 Q164.19 733.583 165.996 737.147 Q167.825 740.689 171.436 740.689 Q175.07 740.689 176.876 737.147 Q178.704 733.583 178.704 726.476 Q178.704 719.347 176.876 715.805 Q175.07 712.24 171.436 712.24 M171.436 708.536 Q177.246 708.536 180.301 713.143 Q183.38 717.726 183.38 726.476 Q183.38 735.203 180.301 739.809 Q177.246 744.393 171.436 744.393 Q165.626 744.393 162.547 739.809 Q159.491 735.203 159.491 726.476 Q159.491 717.726 162.547 713.143 Q165.626 708.536 171.436 708.536 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M118.01 410.888 L125.649 410.888 L125.649 384.522 L117.339 386.189 L117.339 381.93 L125.603 380.263 L130.279 380.263 L130.279 410.888 L137.917 410.888 L137.917 414.823 L118.01 414.823 L118.01 410.888 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M147.362 408.943 L152.246 408.943 L152.246 414.823 L147.362 414.823 L147.362 408.943 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M162.477 380.263 L180.834 380.263 L180.834 384.198 L166.76 384.198 L166.76 392.67 Q167.778 392.323 168.797 392.161 Q169.815 391.976 170.834 391.976 Q176.621 391.976 180.001 395.147 Q183.38 398.319 183.38 403.735 Q183.38 409.314 179.908 412.416 Q176.436 415.494 170.116 415.494 Q167.94 415.494 165.672 415.124 Q163.427 414.754 161.019 414.013 L161.019 409.314 Q163.102 410.448 165.325 411.004 Q167.547 411.559 170.024 411.559 Q174.028 411.559 176.366 409.453 Q178.704 407.346 178.704 403.735 Q178.704 400.124 176.366 398.018 Q174.028 395.911 170.024 395.911 Q168.149 395.911 166.274 396.328 Q164.422 396.744 162.477 397.624 L162.477 380.263 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M120.232 81.9895 L136.552 81.9895 L136.552 85.9247 L114.607 85.9247 L114.607 81.9895 Q117.269 79.2349 121.853 74.6053 Q126.459 69.9525 127.64 68.61 Q129.885 66.0868 130.765 64.3507 Q131.667 62.5915 131.667 60.9017 Q131.667 58.1471 129.723 56.411 Q127.802 54.6749 124.7 54.6749 Q122.501 54.6749 120.047 55.4387 Q117.617 56.2026 114.839 57.7535 L114.839 53.0313 Q117.663 51.8971 120.117 51.3184 Q122.57 50.7397 124.607 50.7397 Q129.978 50.7397 133.172 53.4249 Q136.367 56.11 136.367 60.6007 Q136.367 62.7304 135.556 64.6517 Q134.769 66.5498 132.663 69.1424 Q132.084 69.8137 128.982 73.0312 Q125.88 76.2257 120.232 81.9895 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M146.366 80.0451 L151.251 80.0451 L151.251 85.9247 L146.366 85.9247 L146.366 80.0451 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M171.436 54.4434 Q167.825 54.4434 165.996 58.0082 Q164.19 61.5498 164.19 68.6794 Q164.19 75.7859 165.996 79.3506 Q167.825 82.8923 171.436 82.8923 Q175.07 82.8923 176.876 79.3506 Q178.704 75.7859 178.704 68.6794 Q178.704 61.5498 176.876 58.0082 Q175.07 54.4434 171.436 54.4434 M171.436 50.7397 Q177.246 50.7397 180.301 55.3461 Q183.38 59.9295 183.38 68.6794 Q183.38 77.4062 180.301 82.0127 Q177.246 86.596 171.436 86.596 Q165.626 86.596 162.547 82.0127 Q159.491 77.4062 159.491 68.6794 Q159.491 59.9295 162.547 55.3461 Q165.626 50.7397 171.436 50.7397 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M28.3562 1016.07 L28.3562 1010.21 L64.0042 1010.21 L64.0042 1016.07 L28.3562 1016.07 M14.479 1016.07 L14.479 1010.21 L21.895 1010.21 L21.895 1016.07 L14.479 1016.07 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M42.4881 968.324 L64.0042 968.324 L64.0042 974.181 L42.679 974.181 Q37.6183 974.181 35.1038 976.154 Q32.5894 978.127 32.5894 982.074 Q32.5894 986.817 35.6131 989.554 Q38.6368 992.291 43.8567 992.291 L64.0042 992.291 L64.0042 998.179 L28.3562 998.179 L28.3562 992.291 L33.8944 992.291 Q30.6797 990.19 29.0883 987.358 Q27.4968 984.493 27.4968 980.769 Q27.4968 974.626 31.3163 971.475 Q35.1038 968.324 42.4881 968.324 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M18.2347 950.85 L28.3562 950.85 L28.3562 938.787 L32.9077 938.787 L32.9077 950.85 L52.2594 950.85 Q56.6199 950.85 57.8613 949.673 Q59.1026 948.463 59.1026 944.803 L59.1026 938.787 L64.0042 938.787 L64.0042 944.803 Q64.0042 951.582 61.4897 954.16 Q58.9434 956.739 52.2594 956.739 L32.9077 956.739 L32.9077 961.035 L28.3562 961.035 L28.3562 956.739 L18.2347 956.739 L18.2347 950.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M44.7161 900.593 L47.5806 900.593 L47.5806 927.52 Q53.6281 927.138 56.8109 923.892 Q59.9619 920.613 59.9619 914.789 Q59.9619 911.415 59.1344 908.264 Q58.3069 905.081 56.6518 901.962 L62.1899 901.962 Q63.5267 905.113 64.227 908.423 Q64.9272 911.733 64.9272 915.139 Q64.9272 923.669 59.9619 928.666 Q54.9967 933.631 46.5303 933.631 Q37.7774 933.631 32.6531 928.92 Q27.4968 924.178 27.4968 916.157 Q27.4968 908.964 32.1438 904.794 Q36.7589 900.593 44.7161 900.593 M42.9973 906.449 Q38.1912 906.513 35.3266 909.155 Q32.4621 911.765 32.4621 916.094 Q32.4621 920.995 35.2312 923.955 Q38.0002 926.883 43.0292 927.329 L42.9973 906.449 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M33.8307 870.324 Q33.2578 871.311 33.0032 872.488 Q32.7167 873.634 32.7167 875.035 Q32.7167 880 35.9632 882.674 Q39.1779 885.315 45.2253 885.315 L64.0042 885.315 L64.0042 891.204 L28.3562 891.204 L28.3562 885.315 L33.8944 885.315 Q30.6479 883.469 29.0883 880.509 Q27.4968 877.549 27.4968 873.316 Q27.4968 872.711 27.5923 871.979 Q27.656 871.247 27.8151 870.356 L33.8307 870.324 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M46.0847 847.98 Q46.0847 855.078 47.7079 857.815 Q49.3312 860.553 53.2461 860.553 Q56.3653 860.553 58.2114 858.516 Q60.0256 856.447 60.0256 852.914 Q60.0256 848.044 56.5881 845.116 Q53.1188 842.156 47.3897 842.156 L46.0847 842.156 L46.0847 847.98 M43.6657 836.299 L64.0042 836.299 L64.0042 842.156 L58.5933 842.156 Q61.8398 844.161 63.3994 847.153 Q64.9272 850.145 64.9272 854.473 Q64.9272 859.948 61.8716 863.195 Q58.7843 866.409 53.6281 866.409 Q47.6125 866.409 44.5569 862.399 Q41.5014 858.357 41.5014 850.368 L41.5014 842.156 L40.9285 842.156 Q36.8862 842.156 34.6901 844.829 Q32.4621 847.471 32.4621 852.277 Q32.4621 855.333 33.1941 858.229 Q33.9262 861.126 35.3903 863.799 L29.9795 863.799 Q28.7381 860.585 28.1334 857.561 Q27.4968 854.537 27.4968 851.673 Q27.4968 843.938 31.5072 840.119 Q35.5176 836.299 43.6657 836.299 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M29.7248 798.583 L35.1993 798.583 Q33.8307 801.065 33.1623 803.58 Q32.4621 806.062 32.4621 808.609 Q32.4621 814.306 36.0905 817.457 Q39.6872 820.608 46.212 820.608 Q52.7369 820.608 56.3653 817.457 Q59.9619 814.306 59.9619 808.609 Q59.9619 806.062 59.2935 803.58 Q58.5933 801.065 57.2247 798.583 L62.6355 798.583 Q63.7814 801.033 64.3543 803.675 Q64.9272 806.285 64.9272 809.245 Q64.9272 817.298 59.8664 822.04 Q54.8057 826.783 46.212 826.783 Q37.491 826.783 32.4939 822.008 Q27.4968 817.202 27.4968 808.863 Q27.4968 806.158 28.0697 803.58 Q28.6108 801.002 29.7248 798.583 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M18.2347 782.605 L28.3562 782.605 L28.3562 770.542 L32.9077 770.542 L32.9077 782.605 L52.2594 782.605 Q56.6199 782.605 57.8613 781.427 Q59.1026 780.218 59.1026 776.557 L59.1026 770.542 L64.0042 770.542 L64.0042 776.557 Q64.0042 783.337 61.4897 785.915 Q58.9434 788.493 52.2594 788.493 L32.9077 788.493 L32.9077 792.79 L28.3562 792.79 L28.3562 788.493 L18.2347 788.493 L18.2347 782.605 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M28.3562 762.839 L28.3562 756.983 L64.0042 756.983 L64.0042 762.839 L28.3562 762.839 M14.479 762.839 L14.479 756.983 L21.895 756.983 L21.895 762.839 L14.479 762.839 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M32.4621 730.915 Q32.4621 735.626 36.1542 738.363 Q39.8145 741.1 46.212 741.1 Q52.6095 741.1 56.3017 738.395 Q59.9619 735.658 59.9619 730.915 Q59.9619 726.236 56.2698 723.499 Q52.5777 720.762 46.212 720.762 Q39.8781 720.762 36.186 723.499 Q32.4621 726.236 32.4621 730.915 M27.4968 730.915 Q27.4968 723.276 32.4621 718.916 Q37.4273 714.555 46.212 714.555 Q54.9649 714.555 59.9619 718.916 Q64.9272 723.276 64.9272 730.915 Q64.9272 738.586 59.9619 742.946 Q54.9649 747.275 46.212 747.275 Q37.4273 747.275 32.4621 742.946 Q27.4968 738.586 27.4968 730.915 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M42.4881 675.215 L64.0042 675.215 L64.0042 681.072 L42.679 681.072 Q37.6183 681.072 35.1038 683.045 Q32.5894 685.018 32.5894 688.965 Q32.5894 693.708 35.6131 696.445 Q38.6368 699.182 43.8567 699.182 L64.0042 699.182 L64.0042 705.07 L28.3562 705.07 L28.3562 699.182 L33.8944 699.182 Q30.6797 697.081 29.0883 694.249 Q27.4968 691.384 27.4968 687.66 Q27.4968 681.517 31.3163 678.366 Q35.1038 675.215 42.4881 675.215 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M14.479 643.037 L14.479 637.148 L43.7294 637.148 L28.3562 619.674 L28.3562 612.195 L45.0344 631.101 L64.0042 611.399 L64.0042 619.038 L46.5939 637.148 L64.0042 637.148 L64.0042 643.037 L14.479 643.037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M44.7161 576.897 L47.5806 576.897 L47.5806 603.824 Q53.6281 603.442 56.8109 600.195 Q59.9619 596.917 59.9619 591.092 Q59.9619 587.719 59.1344 584.568 Q58.3069 581.385 56.6518 578.265 L62.1899 578.265 Q63.5267 581.416 64.227 584.727 Q64.9272 588.037 64.9272 591.442 Q64.9272 599.973 59.9619 604.97 Q54.9967 609.935 46.5303 609.935 Q37.7774 609.935 32.6531 605.224 Q27.4968 600.482 27.4968 592.461 Q27.4968 585.268 32.1438 581.098 Q36.7589 576.897 44.7161 576.897 M42.9973 582.753 Q38.1912 582.817 35.3266 585.459 Q32.4621 588.069 32.4621 592.397 Q32.4621 597.299 35.2312 600.259 Q38.0002 603.187 43.0292 603.633 L42.9973 582.753 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M33.8307 546.628 Q33.2578 547.615 33.0032 548.792 Q32.7167 549.938 32.7167 551.339 Q32.7167 556.304 35.9632 558.977 Q39.1779 561.619 45.2253 561.619 L64.0042 561.619 L64.0042 567.507 L28.3562 567.507 L28.3562 561.619 L33.8944 561.619 Q30.6479 559.773 29.0883 556.813 Q27.4968 553.853 27.4968 549.62 Q27.4968 549.015 27.5923 548.283 Q27.656 547.551 27.8151 546.66 L33.8307 546.628 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M42.4881 511.998 L64.0042 511.998 L64.0042 517.855 L42.679 517.855 Q37.6183 517.855 35.1038 519.828 Q32.5894 521.802 32.5894 525.748 Q32.5894 530.491 35.6131 533.228 Q38.6368 535.965 43.8567 535.965 L64.0042 535.965 L64.0042 541.854 L28.3562 541.854 L28.3562 535.965 L33.8944 535.965 Q30.6797 533.865 29.0883 531.032 Q27.4968 528.167 27.4968 524.443 Q27.4968 518.301 31.3163 515.149 Q35.1038 511.998 42.4881 511.998 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M44.7161 469.826 L47.5806 469.826 L47.5806 496.753 Q53.6281 496.371 56.8109 493.124 Q59.9619 489.846 59.9619 484.021 Q59.9619 480.647 59.1344 477.496 Q58.3069 474.313 56.6518 471.194 L62.1899 471.194 Q63.5267 474.345 64.227 477.655 Q64.9272 480.966 64.9272 484.371 Q64.9272 492.901 59.9619 497.898 Q54.9967 502.864 46.5303 502.864 Q37.7774 502.864 32.6531 498.153 Q27.4968 493.411 27.4968 485.39 Q27.4968 478.197 32.1438 474.027 Q36.7589 469.826 44.7161 469.826 M42.9973 475.682 Q38.1912 475.746 35.3266 478.388 Q32.4621 480.997 32.4621 485.326 Q32.4621 490.228 35.2312 493.188 Q38.0002 496.116 43.0292 496.562 L42.9973 475.682 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip820)" d="M14.479 460.213 L14.479 454.357 L64.0042 454.357 L64.0042 460.213 L14.479 460.213 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip822)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  279.759,1384.24 293.266,1384.24 306.774,1384.24 320.281,1384.24 333.789,1384.24 347.296,1384.24 360.804,1384.24 374.311,1384.24 387.819,1384.24 401.326,1384.24 
  414.834,1384.24 428.341,1384.24 441.849,1384.24 455.356,1384.24 468.864,1384.24 482.371,1384.24 495.879,1384.24 509.386,1384.24 522.894,1384.24 536.401,1384.24 
  549.909,1384.24 563.416,1384.24 576.924,1384.24 590.431,1384.24 603.939,1384.24 617.446,86.1857 630.954,186.628 644.461,279.298 657.969,364.797 671.476,443.681 
  684.984,516.46 698.491,583.608 711.999,645.56 725.506,702.719 739.014,755.454 752.521,804.109 766.029,848.999 779.536,890.415 793.044,928.627 806.552,963.882 
  820.059,996.408 833.567,1026.42 847.074,1054.11 860.582,1079.65 874.089,1103.22 887.597,1124.97 901.104,1145.03 914.612,1163.54 928.119,1180.62 941.627,1196.37 
  955.134,1210.91 968.642,1224.32 982.149,1236.69 995.657,1248.11 1009.16,1258.64 1022.67,1268.36 1036.18,1277.33 1049.69,1285.6 1063.19,1293.23 1076.7,1300.28 
  1090.21,1306.77 1103.72,1312.77 1117.22,1318.3 1130.73,1323.4 1144.24,1328.11 1157.75,1332.45 1171.25,1336.46 1184.76,1340.16 1198.27,1343.57 1211.78,1346.71 
  1225.28,1349.62 1238.79,1352.3 1252.3,1354.77 1265.81,1357.05 1279.31,1359.15 1292.82,1361.09 1306.33,1362.88 1319.84,1364.54 1333.34,1366.06 1346.85,1367.47 
  1360.36,1368.77 1373.87,1369.96 1387.37,1371.07 1400.88,1372.09 1414.39,1373.03 1427.9,1373.89 1441.4,1374.69 1454.91,1375.43 1468.42,1376.11 1481.93,1376.74 
  1495.43,1377.32 1508.94,1377.86 1522.45,1378.35 1535.96,1378.81 1549.46,1379.23 1562.97,1379.62 1576.48,1379.97 1589.99,1380.3 1603.49,1380.61 1617,1380.89 
  1630.51,1381.15 1644.02,1381.39 1657.52,1381.61 1671.03,1381.81 1684.54,1382 1698.05,1382.17 1711.55,1382.33 1725.06,1382.48 1738.57,1382.62 1752.08,1382.74 
  1765.58,1382.86 1779.09,1382.96 1792.6,1383.06 1806.11,1383.15 1819.61,1383.24 1833.12,1383.31 1846.63,1383.39 1860.14,1383.45 1873.64,1383.51 1887.15,1383.57 
  1900.66,1383.62 1914.17,1383.67 1927.67,1383.71 1941.18,1383.75 1954.69,1383.79 1968.2,1383.83 1981.7,1383.86 1995.21,1383.89 2008.72,1383.91 2022.23,1383.94 
  2035.73,1383.96 2049.24,1383.98 2062.75,1384 2076.26,1384.02 2089.76,1384.04 2103.27,1384.05 2116.78,1384.07 2130.29,1384.08 2143.79,1384.09 2157.3,1384.1 
  2170.81,1384.11 2184.32,1384.12 2197.82,1384.13 2211.33,1384.14 2224.84,1384.15 2238.35,1384.16 2251.85,1384.16 2265.36,1384.17 2278.87,1384.17 2292.38,1384.18 
  
  "/>
</svg>
<p>Now I build the network</p><pre><code class="language-julia hljs">pops = H.PopulationState(pop,myinput)
ntw = H.InputNetwork(pops,[pops,],[myw,]);</code></pre><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><p>The length of the simulation is measured by the total number of spikes here called <code>n_spikes</code>. The function <code>clear_trains!(...)</code> is used to store older spikes as history and let them be ignored by the kernels.</p><pre><code class="language- hljs">function run_simulation!(netw,nspikes)
  t_now = 0.0
  H.reset!(netw) # clear spike trains etc
  @showprogress 1.0 &quot;Running Hawkes process...&quot; for k in 1:nspikes
    t_now = H.dynamics_step!(t_now,[netw,])
    if k%1_000 == 0
      H.clear_trains!(netw.postpops)
    end
  end
  H.clear_trains!(netw.postpops,-1.0);
  return t_now
end

n_spikes = 80_000
Tmax = run_simulation!(ntw,n_spikes)
avg_rate = n_spikes/Tmax;

#</code></pre><h2 id="Visualize-raster-plot-of-the-events"><a class="docs-heading-anchor" href="#Visualize-raster-plot-of-the-events">Visualize raster plot of the events</a><a id="Visualize-raster-plot-of-the-events-1"></a><a class="docs-heading-anchor-permalink" href="#Visualize-raster-plot-of-the-events" title="Permalink"></a></h2><p>the raster plot shows some correlation between the neural activities neuron one (lower row) excites neuron two (upper row)</p><pre><code class="language-julia hljs">function rasterplot(tlims = (2000.,2020.) )
  _train = pops.trains_history[1]
  plt=plot()
  train = filter(t-&gt; tlims[1]&lt; t &lt; tlims[2],_train)
  nspk = length(train)
  scatter!(plt,train,fill(0.1,nspk),markersize=30,
      markercolor=:black,markershape=:vline,leg=false)
  return plot!(plt,ylims=(0.0,0.2),xlabel=&quot;time (s)&quot;)
end

rasterplot()</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip880">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip880)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip881">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip880)" d="
M186.274 1423.18 L2352.76 1423.18 L2352.76 47.2441 L186.274 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip882">
    <rect x="186" y="47" width="2167" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  247.59,1423.18 247.59,47.2441 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  758.552,1423.18 758.552,47.2441 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1269.51,1423.18 1269.51,47.2441 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1780.48,1423.18 1780.48,47.2441 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2291.44,1423.18 2291.44,47.2441 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  186.274,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  247.59,1423.18 247.59,1404.28 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  758.552,1423.18 758.552,1404.28 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1269.51,1423.18 1269.51,1404.28 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1780.48,1423.18 1780.48,1404.28 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2291.44,1423.18 2291.44,1404.28 
  "/>
<path clip-path="url(#clip880)" d="M209.893 1452.37 Q206.282 1452.37 204.453 1455.94 Q202.648 1459.48 202.648 1466.61 Q202.648 1473.71 204.453 1477.28 Q206.282 1480.82 209.893 1480.82 Q213.527 1480.82 215.333 1477.28 Q217.161 1473.71 217.161 1466.61 Q217.161 1459.48 215.333 1455.94 Q213.527 1452.37 209.893 1452.37 M209.893 1448.67 Q215.703 1448.67 218.759 1453.27 Q221.837 1457.86 221.837 1466.61 Q221.837 1475.33 218.759 1479.94 Q215.703 1484.52 209.893 1484.52 Q204.083 1484.52 201.004 1479.94 Q197.949 1475.33 197.949 1466.61 Q197.949 1457.86 201.004 1453.27 Q204.083 1448.67 209.893 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M230.055 1477.97 L234.939 1477.97 L234.939 1483.85 L230.055 1483.85 L230.055 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M255.124 1452.37 Q251.513 1452.37 249.684 1455.94 Q247.879 1459.48 247.879 1466.61 Q247.879 1473.71 249.684 1477.28 Q251.513 1480.82 255.124 1480.82 Q258.758 1480.82 260.564 1477.28 Q262.393 1473.71 262.393 1466.61 Q262.393 1459.48 260.564 1455.94 Q258.758 1452.37 255.124 1452.37 M255.124 1448.67 Q260.934 1448.67 263.99 1453.27 Q267.069 1457.86 267.069 1466.61 Q267.069 1475.33 263.99 1479.94 Q260.934 1484.52 255.124 1484.52 Q249.314 1484.52 246.235 1479.94 Q243.18 1475.33 243.18 1466.61 Q243.18 1457.86 246.235 1453.27 Q249.314 1448.67 255.124 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M285.286 1452.37 Q281.675 1452.37 279.846 1455.94 Q278.041 1459.48 278.041 1466.61 Q278.041 1473.71 279.846 1477.28 Q281.675 1480.82 285.286 1480.82 Q288.92 1480.82 290.726 1477.28 Q292.555 1473.71 292.555 1466.61 Q292.555 1459.48 290.726 1455.94 Q288.92 1452.37 285.286 1452.37 M285.286 1448.67 Q291.096 1448.67 294.152 1453.27 Q297.23 1457.86 297.23 1466.61 Q297.23 1475.33 294.152 1479.94 Q291.096 1484.52 285.286 1484.52 Q279.476 1484.52 276.397 1479.94 Q273.342 1475.33 273.342 1466.61 Q273.342 1457.86 276.397 1453.27 Q279.476 1448.67 285.286 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M721.353 1452.37 Q717.742 1452.37 715.914 1455.94 Q714.108 1459.48 714.108 1466.61 Q714.108 1473.71 715.914 1477.28 Q717.742 1480.82 721.353 1480.82 Q724.988 1480.82 726.793 1477.28 Q728.622 1473.71 728.622 1466.61 Q728.622 1459.48 726.793 1455.94 Q724.988 1452.37 721.353 1452.37 M721.353 1448.67 Q727.164 1448.67 730.219 1453.27 Q733.298 1457.86 733.298 1466.61 Q733.298 1475.33 730.219 1479.94 Q727.164 1484.52 721.353 1484.52 Q715.543 1484.52 712.465 1479.94 Q709.409 1475.33 709.409 1466.61 Q709.409 1457.86 712.465 1453.27 Q715.543 1448.67 721.353 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M741.515 1477.97 L746.4 1477.97 L746.4 1483.85 L741.515 1483.85 L741.515 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M760.612 1479.92 L776.932 1479.92 L776.932 1483.85 L754.987 1483.85 L754.987 1479.92 Q757.649 1477.16 762.233 1472.53 Q766.839 1467.88 768.02 1466.54 Q770.265 1464.01 771.145 1462.28 Q772.048 1460.52 772.048 1458.83 Q772.048 1456.07 770.103 1454.34 Q768.182 1452.6 765.08 1452.6 Q762.881 1452.6 760.427 1453.37 Q757.997 1454.13 755.219 1455.68 L755.219 1450.96 Q758.043 1449.82 760.497 1449.25 Q762.95 1448.67 764.987 1448.67 Q770.358 1448.67 773.552 1451.35 Q776.747 1454.04 776.747 1458.53 Q776.747 1460.66 775.936 1462.58 Q775.149 1464.48 773.043 1467.07 Q772.464 1467.74 769.362 1470.96 Q766.261 1474.15 760.612 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M786.793 1449.29 L805.149 1449.29 L805.149 1453.23 L791.075 1453.23 L791.075 1461.7 Q792.094 1461.35 793.112 1461.19 Q794.131 1461 795.149 1461 Q800.936 1461 804.316 1464.18 Q807.695 1467.35 807.695 1472.76 Q807.695 1478.34 804.223 1481.44 Q800.751 1484.52 794.432 1484.52 Q792.256 1484.52 789.987 1484.15 Q787.742 1483.78 785.335 1483.04 L785.335 1478.34 Q787.418 1479.48 789.64 1480.03 Q791.862 1480.59 794.339 1480.59 Q798.344 1480.59 800.682 1478.48 Q803.02 1476.38 803.02 1472.76 Q803.02 1469.15 800.682 1467.05 Q798.344 1464.94 794.339 1464.94 Q792.464 1464.94 790.589 1465.36 Q788.737 1465.77 786.793 1466.65 L786.793 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1231.82 1452.37 Q1228.21 1452.37 1226.38 1455.94 Q1224.57 1459.48 1224.57 1466.61 Q1224.57 1473.71 1226.38 1477.28 Q1228.21 1480.82 1231.82 1480.82 Q1235.45 1480.82 1237.26 1477.28 Q1239.09 1473.71 1239.09 1466.61 Q1239.09 1459.48 1237.26 1455.94 Q1235.45 1452.37 1231.82 1452.37 M1231.82 1448.67 Q1237.63 1448.67 1240.68 1453.27 Q1243.76 1457.86 1243.76 1466.61 Q1243.76 1475.33 1240.68 1479.94 Q1237.63 1484.52 1231.82 1484.52 Q1226.01 1484.52 1222.93 1479.94 Q1219.87 1475.33 1219.87 1466.61 Q1219.87 1457.86 1222.93 1453.27 Q1226.01 1448.67 1231.82 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1251.98 1477.97 L1256.86 1477.97 L1256.86 1483.85 L1251.98 1483.85 L1251.98 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1267.1 1449.29 L1285.45 1449.29 L1285.45 1453.23 L1271.38 1453.23 L1271.38 1461.7 Q1272.4 1461.35 1273.42 1461.19 Q1274.43 1461 1275.45 1461 Q1281.24 1461 1284.62 1464.18 Q1288 1467.35 1288 1472.76 Q1288 1478.34 1284.53 1481.44 Q1281.05 1484.52 1274.73 1484.52 Q1272.56 1484.52 1270.29 1484.15 Q1268.05 1483.78 1265.64 1483.04 L1265.64 1478.34 Q1267.72 1479.48 1269.94 1480.03 Q1272.17 1480.59 1274.64 1480.59 Q1278.65 1480.59 1280.98 1478.48 Q1283.32 1476.38 1283.32 1472.76 Q1283.32 1469.15 1280.98 1467.05 Q1278.65 1464.94 1274.64 1464.94 Q1272.77 1464.94 1270.89 1465.36 Q1269.04 1465.77 1267.1 1466.65 L1267.1 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1307.21 1452.37 Q1303.6 1452.37 1301.77 1455.94 Q1299.97 1459.48 1299.97 1466.61 Q1299.97 1473.71 1301.77 1477.28 Q1303.6 1480.82 1307.21 1480.82 Q1310.85 1480.82 1312.65 1477.28 Q1314.48 1473.71 1314.48 1466.61 Q1314.48 1459.48 1312.65 1455.94 Q1310.85 1452.37 1307.21 1452.37 M1307.21 1448.67 Q1313.02 1448.67 1316.08 1453.27 Q1319.16 1457.86 1319.16 1466.61 Q1319.16 1475.33 1316.08 1479.94 Q1313.02 1484.52 1307.21 1484.52 Q1301.4 1484.52 1298.32 1479.94 Q1295.27 1475.33 1295.27 1466.61 Q1295.27 1457.86 1298.32 1453.27 Q1301.4 1448.67 1307.21 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1743.28 1452.37 Q1739.67 1452.37 1737.84 1455.94 Q1736.03 1459.48 1736.03 1466.61 Q1736.03 1473.71 1737.84 1477.28 Q1739.67 1480.82 1743.28 1480.82 Q1746.91 1480.82 1748.72 1477.28 Q1750.55 1473.71 1750.55 1466.61 Q1750.55 1459.48 1748.72 1455.94 Q1746.91 1452.37 1743.28 1452.37 M1743.28 1448.67 Q1749.09 1448.67 1752.14 1453.27 Q1755.22 1457.86 1755.22 1466.61 Q1755.22 1475.33 1752.14 1479.94 Q1749.09 1484.52 1743.28 1484.52 Q1737.47 1484.52 1734.39 1479.94 Q1731.33 1475.33 1731.33 1466.61 Q1731.33 1457.86 1734.39 1453.27 Q1737.47 1448.67 1743.28 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1763.44 1477.97 L1768.32 1477.97 L1768.32 1483.85 L1763.44 1483.85 L1763.44 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1777.33 1449.29 L1799.55 1449.29 L1799.55 1451.28 L1787.01 1483.85 L1782.12 1483.85 L1793.93 1453.23 L1777.33 1453.23 L1777.33 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1808.72 1449.29 L1827.07 1449.29 L1827.07 1453.23 L1813 1453.23 L1813 1461.7 Q1814.02 1461.35 1815.04 1461.19 Q1816.06 1461 1817.07 1461 Q1822.86 1461 1826.24 1464.18 Q1829.62 1467.35 1829.62 1472.76 Q1829.62 1478.34 1826.15 1481.44 Q1822.68 1484.52 1816.36 1484.52 Q1814.18 1484.52 1811.91 1484.15 Q1809.67 1483.78 1807.26 1483.04 L1807.26 1478.34 Q1809.34 1479.48 1811.57 1480.03 Q1813.79 1480.59 1816.26 1480.59 Q1820.27 1480.59 1822.61 1478.48 Q1824.95 1476.38 1824.95 1472.76 Q1824.95 1469.15 1822.61 1467.05 Q1820.27 1464.94 1816.26 1464.94 Q1814.39 1464.94 1812.51 1465.36 Q1810.66 1465.77 1808.72 1466.65 L1808.72 1449.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2243.51 1479.92 L2251.15 1479.92 L2251.15 1453.55 L2242.84 1455.22 L2242.84 1450.96 L2251.1 1449.29 L2255.78 1449.29 L2255.78 1479.92 L2263.42 1479.92 L2263.42 1483.85 L2243.51 1483.85 L2243.51 1479.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2272.86 1477.97 L2277.75 1477.97 L2277.75 1483.85 L2272.86 1483.85 L2272.86 1477.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2297.93 1452.37 Q2294.32 1452.37 2292.49 1455.94 Q2290.69 1459.48 2290.69 1466.61 Q2290.69 1473.71 2292.49 1477.28 Q2294.32 1480.82 2297.93 1480.82 Q2301.57 1480.82 2303.37 1477.28 Q2305.2 1473.71 2305.2 1466.61 Q2305.2 1459.48 2303.37 1455.94 Q2301.57 1452.37 2297.93 1452.37 M2297.93 1448.67 Q2303.74 1448.67 2306.8 1453.27 Q2309.88 1457.86 2309.88 1466.61 Q2309.88 1475.33 2306.8 1479.94 Q2303.74 1484.52 2297.93 1484.52 Q2292.12 1484.52 2289.04 1479.94 Q2285.99 1475.33 2285.99 1466.61 Q2285.99 1457.86 2289.04 1453.27 Q2292.12 1448.67 2297.93 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2328.1 1452.37 Q2324.48 1452.37 2322.66 1455.94 Q2320.85 1459.48 2320.85 1466.61 Q2320.85 1473.71 2322.66 1477.28 Q2324.48 1480.82 2328.1 1480.82 Q2331.73 1480.82 2333.54 1477.28 Q2335.36 1473.71 2335.36 1466.61 Q2335.36 1459.48 2333.54 1455.94 Q2331.73 1452.37 2328.1 1452.37 M2328.1 1448.67 Q2333.91 1448.67 2336.96 1453.27 Q2340.04 1457.86 2340.04 1466.61 Q2340.04 1475.33 2336.96 1479.94 Q2333.91 1484.52 2328.1 1484.52 Q2322.29 1484.52 2319.21 1479.94 Q2316.15 1475.33 2316.15 1466.61 Q2316.15 1457.86 2319.21 1453.27 Q2322.29 1448.67 2328.1 1448.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1156.97 1522.27 L1156.97 1532.4 L1169.03 1532.4 L1169.03 1536.95 L1156.97 1536.95 L1156.97 1556.3 Q1156.97 1560.66 1158.15 1561.9 Q1159.36 1563.14 1163.02 1563.14 L1169.03 1563.14 L1169.03 1568.04 L1163.02 1568.04 Q1156.24 1568.04 1153.66 1565.53 Q1151.08 1562.98 1151.08 1556.3 L1151.08 1536.95 L1146.78 1536.95 L1146.78 1532.4 L1151.08 1532.4 L1151.08 1522.27 L1156.97 1522.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1176.73 1532.4 L1182.59 1532.4 L1182.59 1568.04 L1176.73 1568.04 L1176.73 1532.4 M1176.73 1518.52 L1182.59 1518.52 L1182.59 1525.93 L1176.73 1525.93 L1176.73 1518.52 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1222.6 1539.24 Q1224.8 1535.29 1227.85 1533.41 Q1230.91 1531.54 1235.04 1531.54 Q1240.61 1531.54 1243.64 1535.45 Q1246.66 1539.33 1246.66 1546.53 L1246.66 1568.04 L1240.77 1568.04 L1240.77 1546.72 Q1240.77 1541.59 1238.96 1539.11 Q1237.15 1536.63 1233.42 1536.63 Q1228.87 1536.63 1226.23 1539.65 Q1223.59 1542.68 1223.59 1547.9 L1223.59 1568.04 L1217.7 1568.04 L1217.7 1546.72 Q1217.7 1541.56 1215.88 1539.11 Q1214.07 1536.63 1210.28 1536.63 Q1205.79 1536.63 1203.15 1539.68 Q1200.51 1542.71 1200.51 1547.9 L1200.51 1568.04 L1194.62 1568.04 L1194.62 1532.4 L1200.51 1532.4 L1200.51 1537.93 Q1202.52 1534.66 1205.32 1533.1 Q1208.12 1531.54 1211.97 1531.54 Q1215.85 1531.54 1218.56 1533.51 Q1221.29 1535.48 1222.6 1539.24 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1288.83 1548.76 L1288.83 1551.62 L1261.91 1551.62 Q1262.29 1557.67 1265.54 1560.85 Q1268.81 1564 1274.64 1564 Q1278.01 1564 1281.16 1563.17 Q1284.35 1562.35 1287.47 1560.69 L1287.47 1566.23 Q1284.32 1567.57 1281.01 1568.27 Q1277.69 1568.97 1274.29 1568.97 Q1265.76 1568.97 1260.76 1564 Q1255.8 1559.04 1255.8 1550.57 Q1255.8 1541.82 1260.51 1536.69 Q1265.25 1531.54 1273.27 1531.54 Q1280.46 1531.54 1284.63 1536.18 Q1288.83 1540.8 1288.83 1548.76 M1282.98 1547.04 Q1282.91 1542.23 1280.27 1539.37 Q1277.66 1536.5 1273.33 1536.5 Q1268.43 1536.5 1265.47 1539.27 Q1262.54 1542.04 1262.1 1547.07 L1282.98 1547.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1333.24 1518.58 Q1328.97 1525.9 1326.9 1533.06 Q1324.83 1540.23 1324.83 1547.58 Q1324.83 1554.93 1326.9 1562.16 Q1329 1569.35 1333.24 1576.64 L1328.14 1576.64 Q1323.37 1569.16 1320.98 1561.93 Q1318.63 1554.71 1318.63 1547.58 Q1318.63 1540.48 1320.98 1533.29 Q1323.34 1526.09 1328.14 1518.58 L1333.24 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1367.32 1533.45 L1367.32 1538.98 Q1364.84 1537.71 1362.17 1537.07 Q1359.49 1536.44 1356.63 1536.44 Q1352.27 1536.44 1350.07 1537.77 Q1347.91 1539.11 1347.91 1541.79 Q1347.91 1543.82 1349.47 1545 Q1351.03 1546.15 1355.74 1547.2 L1357.74 1547.64 Q1363.98 1548.98 1366.59 1551.43 Q1369.23 1553.85 1369.23 1558.21 Q1369.23 1563.17 1365.29 1566.07 Q1361.37 1568.97 1354.5 1568.97 Q1351.63 1568.97 1348.51 1568.39 Q1345.43 1567.85 1341.99 1566.74 L1341.99 1560.69 Q1345.24 1562.38 1348.39 1563.24 Q1351.54 1564.07 1354.62 1564.07 Q1358.76 1564.07 1360.99 1562.66 Q1363.22 1561.23 1363.22 1558.65 Q1363.22 1556.27 1361.59 1554.99 Q1360 1553.72 1354.56 1552.54 L1352.52 1552.07 Q1347.08 1550.92 1344.66 1548.56 Q1342.24 1546.18 1342.24 1542.04 Q1342.24 1537.01 1345.81 1534.27 Q1349.37 1531.54 1355.93 1531.54 Q1359.18 1531.54 1362.04 1532.01 Q1364.91 1532.49 1367.32 1533.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1377.64 1518.58 L1382.73 1518.58 Q1387.5 1526.09 1389.86 1533.29 Q1392.25 1540.48 1392.25 1547.58 Q1392.25 1554.71 1389.86 1561.93 Q1387.5 1569.16 1382.73 1576.64 L1377.64 1576.64 Q1381.87 1569.35 1383.94 1562.16 Q1386.04 1554.93 1386.04 1547.58 Q1386.04 1540.23 1383.94 1533.06 Q1381.87 1525.9 1377.64 1518.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  186.274,1423.18 2352.76,1423.18 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  186.274,1079.2 2352.76,1079.2 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  186.274,735.212 2352.76,735.212 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  186.274,391.228 2352.76,391.228 
  "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  186.274,47.2441 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  186.274,1423.18 186.274,47.2441 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  186.274,1423.18 205.172,1423.18 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  186.274,1079.2 205.172,1079.2 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  186.274,735.212 205.172,735.212 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  186.274,391.228 205.172,391.228 
  "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  186.274,47.2441 205.172,47.2441 
  "/>
<path clip-path="url(#clip880)" d="M62.9365 1408.98 Q59.3254 1408.98 57.4967 1412.54 Q55.6912 1416.08 55.6912 1423.21 Q55.6912 1430.32 57.4967 1433.89 Q59.3254 1437.43 62.9365 1437.43 Q66.5707 1437.43 68.3763 1433.89 Q70.205 1430.32 70.205 1423.21 Q70.205 1416.08 68.3763 1412.54 Q66.5707 1408.98 62.9365 1408.98 M62.9365 1405.27 Q68.7467 1405.27 71.8022 1409.88 Q74.8809 1414.46 74.8809 1423.21 Q74.8809 1431.94 71.8022 1436.55 Q68.7467 1441.13 62.9365 1441.13 Q57.1264 1441.13 54.0477 1436.55 Q50.9921 1431.94 50.9921 1423.21 Q50.9921 1414.46 54.0477 1409.88 Q57.1264 1405.27 62.9365 1405.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M83.0984 1434.58 L87.9827 1434.58 L87.9827 1440.46 L83.0984 1440.46 L83.0984 1434.58 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M108.168 1408.98 Q104.557 1408.98 102.728 1412.54 Q100.922 1416.08 100.922 1423.21 Q100.922 1430.32 102.728 1433.89 Q104.557 1437.43 108.168 1437.43 Q111.802 1437.43 113.608 1433.89 Q115.436 1430.32 115.436 1423.21 Q115.436 1416.08 113.608 1412.54 Q111.802 1408.98 108.168 1408.98 M108.168 1405.27 Q113.978 1405.27 117.033 1409.88 Q120.112 1414.46 120.112 1423.21 Q120.112 1431.94 117.033 1436.55 Q113.978 1441.13 108.168 1441.13 Q102.358 1441.13 99.2789 1436.55 Q96.2234 1431.94 96.2234 1423.21 Q96.2234 1414.46 99.2789 1409.88 Q102.358 1405.27 108.168 1405.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M138.33 1408.98 Q134.719 1408.98 132.89 1412.54 Q131.084 1416.08 131.084 1423.21 Q131.084 1430.32 132.89 1433.89 Q134.719 1437.43 138.33 1437.43 Q141.964 1437.43 143.769 1433.89 Q145.598 1430.32 145.598 1423.21 Q145.598 1416.08 143.769 1412.54 Q141.964 1408.98 138.33 1408.98 M138.33 1405.27 Q144.14 1405.27 147.195 1409.88 Q150.274 1414.46 150.274 1423.21 Q150.274 1431.94 147.195 1436.55 Q144.14 1441.13 138.33 1441.13 Q132.519 1441.13 129.441 1436.55 Q126.385 1431.94 126.385 1423.21 Q126.385 1414.46 129.441 1409.88 Q132.519 1405.27 138.33 1405.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M63.9319 1064.99 Q60.3208 1064.99 58.4921 1068.56 Q56.6865 1072.1 56.6865 1079.23 Q56.6865 1086.34 58.4921 1089.9 Q60.3208 1093.44 63.9319 1093.44 Q67.5661 1093.44 69.3717 1089.9 Q71.2004 1086.34 71.2004 1079.23 Q71.2004 1072.1 69.3717 1068.56 Q67.5661 1064.99 63.9319 1064.99 M63.9319 1061.29 Q69.742 1061.29 72.7976 1065.9 Q75.8763 1070.48 75.8763 1079.23 Q75.8763 1087.96 72.7976 1092.56 Q69.742 1097.15 63.9319 1097.15 Q58.1217 1097.15 55.043 1092.56 Q51.9875 1087.96 51.9875 1079.23 Q51.9875 1070.48 55.043 1065.9 Q58.1217 1061.29 63.9319 1061.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M84.0938 1090.6 L88.978 1090.6 L88.978 1096.48 L84.0938 1096.48 L84.0938 1090.6 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M109.163 1064.99 Q105.552 1064.99 103.723 1068.56 Q101.918 1072.1 101.918 1079.23 Q101.918 1086.34 103.723 1089.9 Q105.552 1093.44 109.163 1093.44 Q112.797 1093.44 114.603 1089.9 Q116.432 1086.34 116.432 1079.23 Q116.432 1072.1 114.603 1068.56 Q112.797 1064.99 109.163 1064.99 M109.163 1061.29 Q114.973 1061.29 118.029 1065.9 Q121.107 1070.48 121.107 1079.23 Q121.107 1087.96 118.029 1092.56 Q114.973 1097.15 109.163 1097.15 Q103.353 1097.15 100.274 1092.56 Q97.2187 1087.96 97.2187 1079.23 Q97.2187 1070.48 100.274 1065.9 Q103.353 1061.29 109.163 1061.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M129.371 1061.92 L147.728 1061.92 L147.728 1065.85 L133.654 1065.85 L133.654 1074.32 Q134.672 1073.98 135.691 1073.81 Q136.709 1073.63 137.728 1073.63 Q143.515 1073.63 146.894 1076.8 Q150.274 1079.97 150.274 1085.39 Q150.274 1090.97 146.802 1094.07 Q143.33 1097.15 137.01 1097.15 Q134.834 1097.15 132.566 1096.78 Q130.32 1096.41 127.913 1095.67 L127.913 1090.97 Q129.996 1092.1 132.219 1092.66 Q134.441 1093.21 136.918 1093.21 Q140.922 1093.21 143.26 1091.11 Q145.598 1089 145.598 1085.39 Q145.598 1081.78 143.26 1079.67 Q140.922 1077.56 136.918 1077.56 Q135.043 1077.56 133.168 1077.98 Q131.316 1078.4 129.371 1079.28 L129.371 1061.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M62.9365 721.011 Q59.3254 721.011 57.4967 724.575 Q55.6912 728.117 55.6912 735.247 Q55.6912 742.353 57.4967 745.918 Q59.3254 749.46 62.9365 749.46 Q66.5707 749.46 68.3763 745.918 Q70.205 742.353 70.205 735.247 Q70.205 728.117 68.3763 724.575 Q66.5707 721.011 62.9365 721.011 M62.9365 717.307 Q68.7467 717.307 71.8022 721.913 Q74.8809 726.497 74.8809 735.247 Q74.8809 743.973 71.8022 748.58 Q68.7467 753.163 62.9365 753.163 Q57.1264 753.163 54.0477 748.58 Q50.9921 743.973 50.9921 735.247 Q50.9921 726.497 54.0477 721.913 Q57.1264 717.307 62.9365 717.307 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M83.0984 746.612 L87.9827 746.612 L87.9827 752.492 L83.0984 752.492 L83.0984 746.612 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M98.978 748.557 L106.617 748.557 L106.617 722.191 L98.3067 723.858 L98.3067 719.599 L106.571 717.932 L111.246 717.932 L111.246 748.557 L118.885 748.557 L118.885 752.492 L98.978 752.492 L98.978 748.557 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M138.33 721.011 Q134.719 721.011 132.89 724.575 Q131.084 728.117 131.084 735.247 Q131.084 742.353 132.89 745.918 Q134.719 749.46 138.33 749.46 Q141.964 749.46 143.769 745.918 Q145.598 742.353 145.598 735.247 Q145.598 728.117 143.769 724.575 Q141.964 721.011 138.33 721.011 M138.33 717.307 Q144.14 717.307 147.195 721.913 Q150.274 726.497 150.274 735.247 Q150.274 743.973 147.195 748.58 Q144.14 753.163 138.33 753.163 Q132.519 753.163 129.441 748.58 Q126.385 743.973 126.385 735.247 Q126.385 726.497 129.441 721.913 Q132.519 717.307 138.33 717.307 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M63.9319 377.027 Q60.3208 377.027 58.4921 380.592 Q56.6865 384.133 56.6865 391.263 Q56.6865 398.369 58.4921 401.934 Q60.3208 405.476 63.9319 405.476 Q67.5661 405.476 69.3717 401.934 Q71.2004 398.369 71.2004 391.263 Q71.2004 384.133 69.3717 380.592 Q67.5661 377.027 63.9319 377.027 M63.9319 373.323 Q69.742 373.323 72.7976 377.929 Q75.8763 382.513 75.8763 391.263 Q75.8763 399.99 72.7976 404.596 Q69.742 409.179 63.9319 409.179 Q58.1217 409.179 55.043 404.596 Q51.9875 399.99 51.9875 391.263 Q51.9875 382.513 55.043 377.929 Q58.1217 373.323 63.9319 373.323 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M84.0938 402.628 L88.978 402.628 L88.978 408.508 L84.0938 408.508 L84.0938 402.628 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M99.9733 404.573 L107.612 404.573 L107.612 378.207 L99.3021 379.874 L99.3021 375.615 L107.566 373.948 L112.242 373.948 L112.242 404.573 L119.881 404.573 L119.881 408.508 L99.9733 408.508 L99.9733 404.573 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M129.371 373.948 L147.728 373.948 L147.728 377.883 L133.654 377.883 L133.654 386.355 Q134.672 386.008 135.691 385.846 Q136.709 385.661 137.728 385.661 Q143.515 385.661 146.894 388.832 Q150.274 392.003 150.274 397.42 Q150.274 402.999 146.802 406.101 Q143.33 409.179 137.01 409.179 Q134.834 409.179 132.566 408.809 Q130.32 408.439 127.913 407.698 L127.913 402.999 Q129.996 404.133 132.219 404.689 Q134.441 405.244 136.918 405.244 Q140.922 405.244 143.26 403.138 Q145.598 401.031 145.598 397.42 Q145.598 393.809 143.26 391.703 Q140.922 389.596 136.918 389.596 Q135.043 389.596 133.168 390.013 Q131.316 390.429 129.371 391.309 L129.371 373.948 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M62.9365 33.0428 Q59.3254 33.0428 57.4967 36.6076 Q55.6912 40.1492 55.6912 47.2788 Q55.6912 54.3853 57.4967 57.9501 Q59.3254 61.4917 62.9365 61.4917 Q66.5707 61.4917 68.3763 57.9501 Q70.205 54.3853 70.205 47.2788 Q70.205 40.1492 68.3763 36.6076 Q66.5707 33.0428 62.9365 33.0428 M62.9365 29.3391 Q68.7467 29.3391 71.8022 33.9456 Q74.8809 38.5289 74.8809 47.2788 Q74.8809 56.0056 71.8022 60.6121 Q68.7467 65.1954 62.9365 65.1954 Q57.1264 65.1954 54.0477 60.6121 Q50.9921 56.0056 50.9921 47.2788 Q50.9921 38.5289 54.0477 33.9456 Q57.1264 29.3391 62.9365 29.3391 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M83.0984 58.6445 L87.9827 58.6445 L87.9827 64.5241 L83.0984 64.5241 L83.0984 58.6445 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M102.196 60.5889 L118.515 60.5889 L118.515 64.5241 L96.5706 64.5241 L96.5706 60.5889 Q99.2326 57.8343 103.816 53.2047 Q108.422 48.552 109.603 47.2094 Q111.848 44.6862 112.728 42.9501 Q113.631 41.1909 113.631 39.5011 Q113.631 36.7465 111.686 35.0104 Q109.765 33.2743 106.663 33.2743 Q104.464 33.2743 102.01 34.0381 Q99.5798 34.802 96.8021 36.3529 L96.8021 31.6308 Q99.6261 30.4965 102.08 29.9178 Q104.534 29.3391 106.571 29.3391 Q111.941 29.3391 115.135 32.0243 Q118.33 34.7094 118.33 39.2002 Q118.33 41.3298 117.52 43.2511 Q116.733 45.1492 114.626 47.7418 Q114.047 48.4131 110.946 51.6306 Q107.844 54.8251 102.196 60.5889 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip880)" d="M138.33 33.0428 Q134.719 33.0428 132.89 36.6076 Q131.084 40.1492 131.084 47.2788 Q131.084 54.3853 132.89 57.9501 Q134.719 61.4917 138.33 61.4917 Q141.964 61.4917 143.769 57.9501 Q145.598 54.3853 145.598 47.2788 Q145.598 40.1492 143.769 36.6076 Q141.964 33.0428 138.33 33.0428 M138.33 29.3391 Q144.14 29.3391 147.195 33.9456 Q150.274 38.5289 150.274 47.2788 Q150.274 56.0056 147.195 60.6121 Q144.14 65.1954 138.33 65.1954 Q132.519 65.1954 129.441 60.6121 Q126.385 56.0056 126.385 47.2788 Q126.385 38.5289 129.441 33.9456 Q132.519 29.3391 138.33 29.3391 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>event times are always stored in <code>pops.trains_history</code></p><pre><code class="language-julia hljs">#</code></pre><h2 id="Plot-the-instantaneous-rate"><a class="docs-heading-anchor" href="#Plot-the-instantaneous-rate">Plot the instantaneous rate</a><a id="Plot-the-instantaneous-rate-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-instantaneous-rate" title="Permalink"></a></h2><p>This is the probability of a spike given the past activity up until that moment. It is usually denoted by <span>$\lambda^*(t)$</span>.</p><pre><code class="language- hljs">function get_insta_rate(t)
  _train = pops.trains_history[1]
  myinput[1] + H.interaction(t,_train,myw[1],pops.pop,false)
end
function plot_instarate(tlims=(2000,2020))
  tplot = range(tlims...;length=100)
  _train = pops.trains_history[1]
  tspk = filter(t-&gt; tlims[1]&lt;=t&lt;=tlims[2],_train) # add the exact spiketimes for cleaner plot
  tplot = sort(vcat(tplot,tspk,tspk .- 1E-4))
  plt=plot(xlabel=&quot;time (s)&quot;,ylabel=&quot;instantaneous rate&quot;)
  plot!(plt,tplot,get_insta_rate.(tplot);linewidth=2,color=:black)
  scatter!(tspk,get_insta_rate.(tspk);leg=false)
  plot!(plt,tplot, fill(avg_rate,length(tplot)), color=:red,linestyle=:dash)
end
plot_instarate()</code></pre><h2 id="Plot-the-total-event-counts"><a class="docs-heading-anchor" href="#Plot-the-total-event-counts">Plot the total event counts</a><a id="Plot-the-total-event-counts-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-total-event-counts" title="Permalink"></a></h2><pre><code class="language- hljs">function plot_counts(tlims=(0.,1000.))
  tplot = range(tlims...;length=100)
  _train = pops.trains_history[1]
  nevents(tnow::Real) = count(t-&gt; t &lt;= tnow,_train)
  plt=plot(xlabel=&quot;time (s)&quot;,ylabel=&quot;number of events&quot;,leg=false)
  plot!(plt,tplot,nevents.(tplot),color=:black,linewidth=2)
  plot!(plt,tplot , tplot .* avg_rate,color=:red,linestyle=:dash)
end
plot_counts()</code></pre><h2 id="Rate"><a class="docs-heading-anchor" href="#Rate">Rate</a><a id="Rate-1"></a><a class="docs-heading-anchor-permalink" href="#Rate" title="Permalink"></a></h2><p>Now I compare the numerical rate with the analytic solution, that used the Fourier transform</p><pre><code class="language-julia hljs">ratenum = H.numerical_rates(pops)[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Inf</code></pre><p>this is the general equation for rate in a self-excting Hawkes process, from Hawkes 1976</p><pre><code class="language-julia hljs">ratefou = let gfou0 = myw[1,1] * H.interaction_kernel_fourier(0,pop)
  myinput[1]/(1-real(gfou0))
end;

@info &quot;Total duration $(round(Tmax;digits=1)) s&quot;
@info &quot;Mean rate -  numerical $(round(ratenum;digits=2)), analytic  $(round(ratefou;digits=2))&quot;

#</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Error: Exception while generating log record in module Main at exp_1and2D.md:185
│   exception =
│    UndefVarError: Tmax not defined
│    Stacktrace:
│      [1] top-level scope
│        @ logging.jl:340
│      [2] eval
│        @ ./boot.jl:360 [inlined]
│      [3] #16
│        @ ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:583 [inlined]
│      [4] cd(f::Documenter.Expanders.var&quot;#16#18&quot;{Module, Expr}, dir::String)
│        @ Base.Filesystem ./file.jl:106
│      [5] (::Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr})()
│        @ Documenter.Expanders ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:582
│      [6] (::IOCapture.var&quot;#3#5&quot;{DataType, Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr}, Task, IOContext{Base.PipeEndpoint}, IOContext{Base.PipeEndpoint}, Base.PipeEndpoint, Base.PipeEndpoint})()
│        @ IOCapture ~/.julia/packages/IOCapture/sXY71/src/IOCapture.jl:118
│      [7] with_logstate(f::Function, logstate::Any)
│        @ Base.CoreLogging ./logging.jl:491
│      [8] with_logger
│        @ ./logging.jl:603 [inlined]
│      [9] capture(f::Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr}; rethrow::Type, color::Bool)
│        @ IOCapture ~/.julia/packages/IOCapture/sXY71/src/IOCapture.jl:116
│     [10] runner(#unused#::Type{Documenter.Expanders.ExampleBlocks}, x::Markdown.Code, page::Documenter.Documents.Page, doc::Documenter.Documents.Document)
│        @ Documenter.Expanders ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:581
│     [11] dispatch(::Type{Documenter.Expanders.ExpanderPipeline}, ::Markdown.Code, ::Vararg{Any, N} where N)
│        @ Documenter.Utilities.Selectors ~/.julia/packages/Documenter/ruzxx/src/Utilities/Selectors.jl:170
│     [12] expand(doc::Documenter.Documents.Document)
│        @ Documenter.Expanders ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:42
│     [13] runner(#unused#::Type{Documenter.Builder.ExpandTemplates}, doc::Documenter.Documents.Document)
│        @ Documenter.Builder ~/.julia/packages/Documenter/ruzxx/src/Builder.jl:227
│     [14] dispatch(#unused#::Type{Documenter.Builder.DocumentPipeline}, x::Documenter.Documents.Document)
│        @ Documenter.Utilities.Selectors ~/.julia/packages/Documenter/ruzxx/src/Utilities/Selectors.jl:170
│     [15] #2
│        @ ~/.julia/packages/Documenter/ruzxx/src/Documenter.jl:257 [inlined]
│     [16] cd(f::Documenter.var&quot;#2#3&quot;{Documenter.Documents.Document}, dir::String)
│        @ Base.Filesystem ./file.jl:106
│     [17] #makedocs#1
│        @ ~/.julia/packages/Documenter/ruzxx/src/Documenter.jl:256 [inlined]
│     [18] top-level scope
│        @ ~/work/HawkesSimulator.jl/HawkesSimulator.jl/docs/make.jl:9
│     [19] include(mod::Module, _path::String)
│        @ Base ./Base.jl:386
│     [20] exec_options(opts::Base.JLOptions)
│        @ Base ./client.jl:285
│     [21] _start()
│        @ Base ./client.jl:485
└ @ Main exp_1and2D.md:185
[ Info: Mean rate -  numerical Inf, analytic  4.67</code></pre><h2 id="Covariance-density"><a class="docs-heading-anchor" href="#Covariance-density">Covariance density</a><a id="Covariance-density-1"></a><a class="docs-heading-anchor-permalink" href="#Covariance-density" title="Permalink"></a></h2><p>TODO : write definition</p><p>I compute the covariance density it numerically. The time inteval <code>mydt</code> should not be too small.</p><pre><code class="language- hljs">mytrain = pops.trains_history[1]
mydt = 0.1
myτmax = 25.0
mytaus = H.get_times(mydt,myτmax)
ntaus = length(mytaus)
cov_num = H.covariance_self_numerical(mytrain,mydt,myτmax);

#</code></pre><p>Now I compute the covariance density analytically, at higher resolution, and I compare the two.</p><pre><code class="language- hljs">function four_high_res(dt::Real,Tmax::Real) # higher time resolution, longer time
  k1,k2 = 2 , 0.01
  myτmax = Tmax * k1
  dt *= k2
  mytaus = H.get_times(dt,myτmax)
  nkeep = div(length(mytaus),k1)
  myfreq = H.get_frequencies_centerzero(dt,myτmax)
  gfou = myw[1,1] .* H.interaction_kernel_fourier.(myfreq,Ref(pop)) |&gt; ifftshift
  ffou = let r=ratefou
    covf(g) = r/((1-g)*(1-g&#39;))
    map(covf,gfou)
  end
  retf = real.(ifft(ffou)) ./ dt
  retf[1] *= dt  # first element is rate
  return mytaus[1:nkeep],retf[1:nkeep]
end

(taush,covfou)=four_high_res(mydt,myτmax)

function doplot()
  plt = plot(xlabel=&quot;time delay (s)&quot;,ylabel=&quot;Covariance density&quot;)
  plot!(plt,mytaus[2:end], cov_num[2:end] ; linewidth=3, label=&quot;simulation&quot; )
  plot!(plt,taush[2:end],covfou[2:end]; label=&quot;analytic&quot;,linewidth=3,linestyle=:dash)
  return plt
end
doplot()</code></pre><p>1D system completed !</p><pre><code class="language-julia hljs">#</code></pre><h2 id="Same-results,-but-in-a-2D-system"><a class="docs-heading-anchor" href="#Same-results,-but-in-a-2D-system">Same results, but in a 2D system</a><a id="Same-results,-but-in-a-2D-system-1"></a><a class="docs-heading-anchor-permalink" href="#Same-results,-but-in-a-2D-system" title="Permalink"></a></h2><pre><code class="language-julia hljs">myτ = 1/2.33
mywmat = [ 0.31   0.3
           0.9  0.15 ]
myin = [1.0,0.1]
p1 = H.PopulationExp(myτ)
ps1 = H.PopulationState(p1,myin)
ntw = H.InputNetwork(ps1,[ps1,],[mywmat,]);</code></pre><h2 id="Start-the-simulation"><a class="docs-heading-anchor" href="#Start-the-simulation">Start the simulation</a><a id="Start-the-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Start-the-simulation" title="Permalink"></a></h2><p>the function <code>run_simulation!(...)</code> has been defined above Note that <code>n_spikes</code> is the total number of spikes among <strong>all</strong> units in the system.</p><pre><code class="language- hljs">n_spikes = 500_000

Tmax = run_simulation!(ntw,n_spikes);
nothing #hide</code></pre><h2 id="Check-the-rates"><a class="docs-heading-anchor" href="#Check-the-rates">Check the rates</a><a id="Check-the-rates-1"></a><a class="docs-heading-anchor-permalink" href="#Check-the-rates" title="Permalink"></a></h2><p>The analytic rate is from  Eq between 6 and  7 in Hawkes 1971</p><pre><code class="language-julia hljs">num_rates = H.numerical_rates(ps1)
myspikes_both = ps1.trains_history

ratefou = let G0 =  mywmat .* H.interaction_kernel_fourier(0,p1)
  inv(I-G0)*myin |&gt; real
end

@info &quot;Total duration $(round(Tmax;digits=1)) s&quot;
@info &quot;Rates are $(round.(num_rates;digits=2))&quot;
@info &quot;Analytic rates are $(round.(ratefou;digits=2)) Hz&quot;

#</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Error: Exception while generating log record in module Main at exp_1and2D.md:283
│   exception =
│    UndefVarError: Tmax not defined
│    Stacktrace:
│      [1] top-level scope
│        @ logging.jl:340
│      [2] eval
│        @ ./boot.jl:360 [inlined]
│      [3] #16
│        @ ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:583 [inlined]
│      [4] cd(f::Documenter.Expanders.var&quot;#16#18&quot;{Module, Expr}, dir::String)
│        @ Base.Filesystem ./file.jl:106
│      [5] (::Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr})()
│        @ Documenter.Expanders ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:582
│      [6] (::IOCapture.var&quot;#3#5&quot;{DataType, Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr}, Task, IOContext{Base.PipeEndpoint}, IOContext{Base.PipeEndpoint}, Base.PipeEndpoint, Base.PipeEndpoint})()
│        @ IOCapture ~/.julia/packages/IOCapture/sXY71/src/IOCapture.jl:118
│      [7] with_logstate(f::Function, logstate::Any)
│        @ Base.CoreLogging ./logging.jl:491
│      [8] with_logger
│        @ ./logging.jl:603 [inlined]
│      [9] capture(f::Documenter.Expanders.var&quot;#15#17&quot;{Documenter.Documents.Page, Module, Expr}; rethrow::Type, color::Bool)
│        @ IOCapture ~/.julia/packages/IOCapture/sXY71/src/IOCapture.jl:116
│     [10] runner(#unused#::Type{Documenter.Expanders.ExampleBlocks}, x::Markdown.Code, page::Documenter.Documents.Page, doc::Documenter.Documents.Document)
│        @ Documenter.Expanders ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:581
│     [11] dispatch(::Type{Documenter.Expanders.ExpanderPipeline}, ::Markdown.Code, ::Vararg{Any, N} where N)
│        @ Documenter.Utilities.Selectors ~/.julia/packages/Documenter/ruzxx/src/Utilities/Selectors.jl:170
│     [12] expand(doc::Documenter.Documents.Document)
│        @ Documenter.Expanders ~/.julia/packages/Documenter/ruzxx/src/Expanders.jl:42
│     [13] runner(#unused#::Type{Documenter.Builder.ExpandTemplates}, doc::Documenter.Documents.Document)
│        @ Documenter.Builder ~/.julia/packages/Documenter/ruzxx/src/Builder.jl:227
│     [14] dispatch(#unused#::Type{Documenter.Builder.DocumentPipeline}, x::Documenter.Documents.Document)
│        @ Documenter.Utilities.Selectors ~/.julia/packages/Documenter/ruzxx/src/Utilities/Selectors.jl:170
│     [15] #2
│        @ ~/.julia/packages/Documenter/ruzxx/src/Documenter.jl:257 [inlined]
│     [16] cd(f::Documenter.var&quot;#2#3&quot;{Documenter.Documents.Document}, dir::String)
│        @ Base.Filesystem ./file.jl:106
│     [17] #makedocs#1
│        @ ~/.julia/packages/Documenter/ruzxx/src/Documenter.jl:256 [inlined]
│     [18] top-level scope
│        @ ~/work/HawkesSimulator.jl/HawkesSimulator.jl/docs/make.jl:9
│     [19] include(mod::Module, _path::String)
│        @ Base ./Base.jl:386
│     [20] exec_options(opts::Base.JLOptions)
│        @ Base ./client.jl:285
│     [21] _start()
│        @ Base ./client.jl:485
└ @ Main exp_1and2D.md:283
[ Info: Rates are [Inf, Inf]
[ Info: Analytic rates are [2.78, 3.06] Hz</code></pre><h2 id="Covariance-density-2"><a class="docs-heading-anchor" href="#Covariance-density-2">Covariance density</a><a class="docs-heading-anchor-permalink" href="#Covariance-density-2" title="Permalink"></a></h2><p>there are 4 combinations, therefore I will compare 4 lines.</p><pre><code class="language- hljs">mydt = 0.1
myτmax = 15.0
mytaus = H.get_times(mydt,myτmax)
ntaus = length(mytaus)
cov_num = H.covariance_density_numerical(myspikes_both,mydt,myτmax)


function doplot()
  plt=plot(xlabel=&quot;time delay (s)&quot;,ylabel=&quot;Covariance density&quot;)
  for i in 1:2, j in 1:2
    plot!(plt,mytaus[2:end-1],cov_num[i,j,2:end-1], linewidth = 3, label=&quot;cov $i-$j&quot;)
  end
  return plt
end

doplot()</code></pre><p>The analytic solution is eq 12 from Hawkes 1971</p><pre><code class="language-julia hljs">function four_high_res(dt::Real,Tmax::Real)
  k1 = 2
  k2 = 0.005
  myτmax,mydt = Tmax * k1, dt*k2
  mytaus = H.get_times(mydt,myτmax)
  nkeep = div(length(mytaus),k1)
  myfreq = H.get_frequencies_centerzero(mydt,myτmax)
  G_omega = map(mywmat) do w
    ifftshift( w .* H.interaction_kernel_fourier.(myfreq,Ref(p1)))
  end
  D = Diagonal(ratefou)
  M = Array{ComplexF64}(undef,2,2,length(myfreq))
  Mt = similar(M,Float64)
  for i in eachindex(myfreq)
    G = getindex.(G_omega,i)
    M[:,:,i] = (I-G)\D/(I-G&#39;)
  end
  for i in 1:2,j in 1:2
    Mt[i,j,:] = real.(ifft(M[i,j,:]))
    Mt[i,j,2:end] ./= mydt # diagonal of t=0 contains the rate
  end
  return mytaus[1:nkeep],Mt[:,:,1:nkeep]
end

taush,Cfou=four_high_res(mydt,myτmax)

function oneplot(i,j)
  plt=plot(xlabel=&quot;time delay (s)&quot;,ylabel=&quot;Covariance density&quot;,title=&quot;cov $i - $j&quot;)
  plot!(plt,mytaus[2:end],cov_num[i,j,2:end] ; linewidth = 3, label=&quot;simulation&quot;)
  plot!(plt,taush[2:end],Cfou[i,j,2:end]; linestyle=:dash, linewidth=3, label=&quot;analytic&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">oneplot (generic function with 1 method)</code></pre><p>1</p><pre><code class="language- hljs">oneplot(1,1)</code></pre><p>2</p><pre><code class="language- hljs">oneplot(1,2)</code></pre><p>3</p><pre><code class="language- hljs">oneplot(2,1)</code></pre><p>4</p><pre><code class="language- hljs">oneplot(2,2)</code></pre><p><strong>THE END</strong></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.6 on <span class="colophon-date" title="Wednesday 15 September 2021 14:00">Wednesday 15 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
